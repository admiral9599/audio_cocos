"use strict";(self.webpackChunkinvenio_assets=self.webpackChunkinvenio_assets||[]).push([[8092],{8306:(e,t,n)=>{n.d(t,{TV:()=>M,D0:()=>d,qB:()=>P,MQ:()=>k,yv:()=>y,vE:()=>R});var r=n(58156),i=n.n(r),a=(n(2404),n(23029)),o=n(92901),l=n(63560),c=n.n(l),s=n(88055),u=n.n(s),d=function(){return(0,o.A)((function e(t){var n=t.fieldpath,r=t.deserializedDefault,i=void 0===r?null:r,o=t.serializedDefault,l=void 0===o?null:o,c=t.allowEmpty,s=void 0!==c&&c;(0,a.A)(this,e),this.fieldpath=n,this.deserializedDefault=i,this.serializedDefault=l,this.allowEmpty=s}),[{key:"deserialize",value:function(e){var t=i()(e,this.fieldpath,this.deserializedDefault);return null!==t?c()(u()(e),this.fieldpath,t):e}},{key:"serialize",value:function(e){var t=i()(e,this.fieldpath,this.serializedDefault);return null!==t?c()(u()(e),this.fieldpath,t):e}}])}();var p=n(56822),f=n(53954),m=n(85501),h=n(44383),v=n.n(h);function b(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(b=function(){return!!e})()}var y=function(e){function t(e){var n,r,i,o,l=e.fieldpath,c=e.schema,s=e.deserializedDefault,u=void 0===s?[]:s,d=e.serializedDefault,m=void 0===d?[]:d;return(0,a.A)(this,t),r=this,i=t,o=[{fieldpath:l,deserializedDefault:u,serializedDefault:m}],i=(0,f.A)(i),(n=(0,p.A)(r,b()?Reflect.construct(i,o||[],(0,f.A)(r).constructor):i.apply(r,o))).schema=c,n.schemaKeys=Object.keys(n.schema),n}return(0,m.A)(t,e),(0,o.A)(t,[{key:"deserialize",value:function(e,t){var n=this,r=i()(e,this.fieldpath,this.deserializedDefault).map((function(e,r){var i=v()(e,n.schemaKeys);return n.schemaKeys.forEach((function(e){i=n.schema[e].deserialize(i,t)})),i.__key=r,i}));return c()(u()(e),this.fieldpath,r)}},{key:"serialize",value:function(e,t){var n=this,r=i()(e,this.fieldpath,this.serializedDefault),a=null===r||void 0===r?void 0:r.map((function(e){var r=v()(e,n.schemaKeys);return n.schemaKeys.forEach((function(e){r=n.schema[e].serialize(r,t)})),r}));return null!==a?c()(u()(e),this.fieldpath,a):a}}])}(d),g=n(64467);function A(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function E(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?A(Object(n),!0).forEach((function(t){(0,g.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):A(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function w(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(w=function(){return!!e})()}var R=function(e){function t(e){var n,r,i,o,l=e.fieldpath,c=e.deserializedDefault,s=void 0===c?null:c,u=e.serializedDefault,d=void 0===u?null:u,m=e.labelField,h=void 0===m?"name":m;return(0,a.A)(this,t),r=this,i=t,o=[{fieldpath:l,deserializedDefault:s,serializedDefault:d}],i=(0,f.A)(i),(n=(0,p.A)(r,w()?Reflect.construct(i,o||[],(0,f.A)(r).constructor):i.apply(r,o))).labelField=h,n}return(0,m.A)(t,e),(0,o.A)(t,[{key:"deserialize",value:function(e){var t=function(e){if(null!==e&&void 0!==e&&e.id)return e.id},n=i()(e,this.fieldpath,this.deserializedDefault),r=null;return null!==n&&(r=Array.isArray(n)?n.map(t):t(n)),c()(u()(e),this.fieldpath,r||n)}},{key:"serialize",value:function(e){var t=this,n=function(e){return"string"===typeof e?{id:e}:E(E({},e.id?{id:e.id}:{}),e[t.labelField]&&(0,g.A)({},t.labelField,e[t.labelField]))},r=i()(e,this.fieldpath,this.serializedDefault),a=null;return null!==r&&(a=Array.isArray(r)?r.map(n):n(r)),c()(u()(e),this.fieldpath,a||r)}}])}(d);function C(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(C=function(){return!!e})()}var P=function(e){function t(e){var n,r,i,o=e.fieldpath,l=e.deserializedDefault,c=void 0===l?null:l,s=e.serializedDefault,u=void 0===s?null:s;return(0,a.A)(this,t),n=this,r=t,i=[{fieldpath:o,deserializedDefault:c,serializedDefault:u}],r=(0,f.A)(r),(0,p.A)(n,C()?Reflect.construct(r,i||[],(0,f.A)(n).constructor):r.apply(n,i))}return(0,m.A)(t,e),(0,o.A)(t,[{key:"deserialize",value:function(e,t){var n=function(e){var n=u()(e);if(null!==e&&void 0!==e&&e.title&&(n.title=e.title[t]),e.identifiers){["url"].forEach((function(t){var r=null;e.identifiers.forEach((function(e){e.scheme===t&&(r=e.identifier)})),r&&(n[t]=r)})),delete n.identifiers}return n},r=i()(e,this.fieldpath,this.deserializedDefault),a=null;return null!==r&&(a=Array.isArray(r)?r.map(n):n(r)),c()(u()(e),this.fieldpath,a||r)}},{key:"serialize",value:function(e,t){var n=function(e){if(e.id)return{id:e.id};var n=u()(e);return e.title&&(n.title=(0,g.A)({},t,e.title)),e.url&&(n.identifiers=[{identifier:e.url,scheme:"url"}],delete n.url),n},r=i()(e,this.fieldpath,this.serializedDefault),a=null;return null!==r&&(a=Array.isArray(r)?r.map(n):n(r)),c()(u()(e),this.fieldpath,a||r)}}])}(d);function S(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(S=function(){return!!e})()}var k=function(e){function t(e){var n,r,i,o,l=e.fieldpath,c=e.deserializedDefault,s=void 0===c?null:c,u=e.serializedDefault,d=void 0===u?null:u,m=e.localeFields,h=void 0===m?[]:m;return(0,a.A)(this,t),r=this,i=t,o=[{fieldpath:l,deserializedDefault:s,serializedDefault:d}],i=(0,f.A)(i),(n=(0,p.A)(r,S()?Reflect.construct(i,o||[],(0,f.A)(r).constructor):i.apply(r,o))).localeFields=h,n}return(0,m.A)(t,e),(0,o.A)(t,[{key:"deserialize",value:function(e,t){var n=this,r=i()(e,this.fieldpath,this.deserializedDefault),a=function(e){if("id"in e)return"string"===typeof e.title?e:{id:e.id};var r=u()(e);return n.localeFields.forEach((function(n){e[n]&&(r[n]=e[n][t])})),r},o=null;return null!==r&&(o=Array.isArray(r)?r.map(a):a(r)),c()(u()(e),this.fieldpath,o||r)}},{key:"serialize",value:function(e,t){var n=this,r=i()(e,this.fieldpath,this.serializedDefault),a=null,o=function(e){var r=u()(e);return"id"in e&&null!=e.id?{id:e.id}:(n.localeFields.forEach((function(n){n in e&&(r[n]=(0,g.A)({},t,e[n]))})),r)};return null!==r&&(a=Array.isArray(r)?r.map(o):o(r)),c()(u()(e),this.fieldpath,a||r)}}])}(R);function O(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function D(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?O(Object(n),!0).forEach((function(t){(0,g.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):O(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function I(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(I=function(){return!!e})()}var M=function(e){function t(){return(0,a.A)(this,t),e=this,n=t,r=arguments,n=(0,f.A)(n),(0,p.A)(e,I()?Reflect.construct(n,r||[],(0,f.A)(e).constructor):n.apply(e,r));var e,n,r}return(0,m.A)(t,e),(0,o.A)(t,[{key:"deserialize",value:function(e){var t=this,n=i()(e,this.fieldpath,this.deserializedDefault),r=function(e){return D(D({},e.id?{id:e.id}:{}),{},(0,g.A)({},t.labelField,e[t.labelField]))},a=null;return null!==n&&(a=Array.isArray(n)?n.map(r):r(n)),c()(u()(e),this.fieldpath,a||n)}}])}(R)},28092:(e,t,n)=>{n.d(t,{Re:()=>K,D:()=>Lo,qE:()=>Hi,En:()=>Ui,Y4:()=>He,Kp:()=>rt,et:()=>xi,k6:()=>xo,KI:()=>_o,q1:()=>le,l0:()=>Cn,yY:()=>ba,l4:()=>kn,Km:()=>te,g7:()=>Yr,z4:()=>sn,EM:()=>vr,PI:()=>ji,Hq:()=>Gr,IZ:()=>aa,nH:()=>Kr,bT:()=>Jr,CP:()=>oi,n:()=>ii,fB:()=>ua,GC:()=>si,Kd:()=>$i,y5:()=>mi,Je:()=>vi,n2:()=>No});var r=n(58168),i=n(23029),a=n(92901),o=n(56822),l=n(53954),c=n(85501),s=n(96540),u=n(61225),d=n(5556),p=n.n(d),f=n(17684),m=n(81057),h=n(83794),v=n(80501),b=n(36713),y=n(27041),g=n(97007),A=n(64467),E=n(93682),w=n(76217),R=n(3487);function C(e,t,n){return t=(0,l.A)(t),(0,o.A)(e,P()?Reflect.construct(t,n||[],(0,l.A)(e).constructor):t.apply(e,n))}function P(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(P=function(){return!!e})()}var S=function(e){function t(){var e;(0,i.A)(this,t);for(var n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return e=C(this,t,[].concat(r)),(0,A.A)(e,"handlePublicButtonClick",(function(){var t=e.props,n=t.formik,r=t.fieldPath;n.form.setFieldValue(r,"public"),n.form.setFieldValue("access.embargo",{active:!1})})),(0,A.A)(e,"handleRestrictionButtonClick",(function(){var t=e.props,n=t.formik,r=t.fieldPath;n.form.setFieldValue(r,"restricted")})),e}return(0,c.A)(t,e),(0,a.A)(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.formik,n=e.disabled,r=e.fieldPath;n&&t.form.setFieldValue(r,"restricted")}},{key:"render",value:function(){var e=this.props,t=e.active,n=e.disabled,r=e.canRestrictRecord,i=t?"positive":"",a=t?"":"negative";return s.createElement(s.Fragment,null,!r&&s.createElement(E.A,{trigger:s.createElement(w.A,{className:"right-floated",name:"question circle outline"}),content:g.M.t("Record visibility can not be changed to restricted anymore. Please contact support if you still need to make these changes.")}),s.createElement(R.A.Group,{widths:"2"},s.createElement(R.A,{className:i,"data-testid":"protection-buttons-component-public",disabled:n,onClick:this.handlePublicButtonClick,active:t},g.M.t("Public")),s.createElement(R.A,{disabled:!r,className:a,"data-testid":"protection-buttons-component-restricted",active:!t,onClick:this.handleRestrictionButtonClick},g.M.t("Restricted"))))}}])}(s.Component);S.propTypes={canRestrictRecord:p().bool,fieldPath:p().string.isRequired,formik:p().object.isRequired,active:p().bool,disabled:p().bool},S.defaultProps={active:!0,disabled:!1,canRestrictRecord:!0};var k=function(e){function t(){return(0,i.A)(this,t),C(this,t,arguments)}return(0,c.A)(t,e),(0,a.A)(t,[{key:"render",value:function(){var e=this,t=this.props.fieldPath;return s.createElement(f.FastField,{name:t,component:function(t){return s.createElement(S,(0,r.A)({formik:t},e.props))}})}}])}(s.Component);k.defaultProps={canRestrictRecord:!0},k.propTypes={canRestrictRecord:p().bool,fieldPath:p().string.isRequired};var O=n(53196),D=n(91272),I=function(e){var t=e.recordAccess,n=e.communityAccess,i=e.record,a=e.recordRestrictionGracePeriod,o=e.allowRecordRestriction,l="public"===t,c="public"===n;return s.createElement(O.default,(0,r.A)({id:"ReactInvenioDeposit.MetadataAccess.layout"},e),s.createElement(s.Fragment,null,g.M.t("Full record"),s.createElement(k,{canRestrictRecord:function(){var e;return!(!o&&null!==i&&void 0!==i&&i.created&&"restricted"!==(null===i||void 0===i||null===(e=i.access)||void 0===e?void 0:e.record)&&i.is_published)||!(D.DateTime.fromISO(i.created).plus({days:a})<D.DateTime.now())}(),record:i,active:l&&c,disabled:!c,fieldPath:"access.record"})))};I.propTypes={recordAccess:p().string.isRequired,communityAccess:p().string.isRequired,record:p().object.isRequired,recordRestrictionGracePeriod:p().number.isRequired,allowRecordRestriction:p().bool.isRequired};var M=function(e){var t=e.access,n=e.accessCommunity,r=e.metadataOnly,i="public"===t.files,a="public"===t.record,o="public"===n,l=!o||!a,c=o&&!i&&a,u=!r&&o&&a;return r?s.createElement(h.A.Meta,{"data-testid":"access-files"},s.createElement("em",null,g.M.t("The record has no files."))):s.createElement("div",{"data-testid":"access-files"},u&&s.createElement(s.Fragment,null,g.M.t("Files only"),s.createElement(k,{active:i,disable:!o,fieldPath:"access.files"})),l&&s.createElement(h.A.Description,null,s.createElement("em",null,g.M.t("The full record is restricted."))),c&&s.createElement(h.A.Description,null,s.createElement("em",null,g.M.t("The files of this record are restricted."))))};M.propTypes={access:p().object.isRequired,metadataOnly:p().bool,accessCommunity:p().string.isRequired},M.defaultProps={metadataOnly:!1};var F=n(62193),x=n.n(F),T=n(27859),q=n(50363);function _(e,t,n){return t=(0,l.A)(t),(0,o.A)(e,j()?Reflect.construct(t,n||[],(0,l.A)(e).constructor):t.apply(e,n))}function j(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(j=function(){return!!e})()}var z=function(e){function t(){return(0,i.A)(this,t),_(this,t,arguments)}return(0,c.A)(t,e),(0,a.A)(t,[{key:"render",value:function(){var e=this.props,t=e.fieldPath,n=e.formik,r=e.checked,i=e.disabled;return s.createElement(q.A,{id:t,"data-testid":"embargo-checkbox-component",disabled:i,checked:r,onChange:function(){n.field.value?n.form.setFieldValue("access.embargo",{active:!1}):n.form.setFieldValue(t,!0)}})}}])}(s.Component);z.propTypes={fieldPath:p().string.isRequired,formik:p().object.isRequired,checked:p().bool,disabled:p().bool},z.defaultProps={checked:!1,disabled:!0};var L=function(e){function t(){return(0,i.A)(this,t),_(this,t,arguments)}return(0,c.A)(t,e),(0,a.A)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.disabled,i=t.fieldPath,a=n?{change:!0}:{};return s.createElement(f.FastField,(0,r.A)({name:i,component:function(t){return s.createElement(z,(0,r.A)({formik:t},e.props))}},a))}}])}(s.Component);function N(e){var t=e.fieldPath,n=e.label,r=e.labelIcon,i=e.placeholder,a=e.required,o=e.helpText;return s.createElement(m.TextField,{fieldPath:t,label:s.createElement(m.FieldLabel,{htmlFor:t,icon:r,label:n}),placeholder:i,required:a,helpText:o})}L.propTypes={disabled:p().bool,fieldPath:p().string.isRequired},L.defaultProps={disabled:!1},N.propTypes={fieldPath:p().string.isRequired,label:p().string,labelIcon:p().string,placeholder:p().string,required:p().bool,helpText:p().string},N.defaultProps={required:!1,labelIcon:"calendar",placeholder:g.M.t("YYYY-MM-DD"),label:g.M.t("Embargo until"),helpText:"".concat(g.M.t("Format"),": ").concat(g.M.t("YYYY-MM-DD"))};var B=n(52822),U=function(e){var t,n,r,i=e.access,a=e.accessCommunity,o=e.metadataOnly,l="public"===i.record,c="public"===i.files,u="public"===a,d=!o&&!c,p=(null===(t=i.embargo)||void 0===t?void 0:t.active)||!1,f=null===(n=i.embargo)||void 0===n?void 0:n.until,h=null===(r=i.embargo)||void 0===r?void 0:r.reason,v=!p&&!x()(f),y=u&&(!l||d),A=f?D.DateTime.fromISO(f).toLocaleString(D.DateTime.DATE_FULL):"???";return s.createElement(T.A,null,s.createElement(T.A.Item,{disabled:!y,"data-testid":"option-list-embargo"},s.createElement(T.A.Icon,{"aria-hidden":"false"},s.createElement(L,{fieldPath:"access.embargo.active",checked:p,disabled:!y})),s.createElement(T.A.Content,null,s.createElement(T.A.Header,{as:"label",htmlFor:"access.embargo.active"},g.M.t("Apply an embargo")," ",s.createElement(w.A,{name:"clock outline"})),s.createElement(T.A.Description,null,s.createElement(B.x,null,"Record or files protection must be ",s.createElement("b",null,"restricted")," to apply an embargo.")),p&&s.createElement(s.Fragment,null,s.createElement(b.A,{hidden:!0,className:"rel-mb-1"}),s.createElement(N,{fieldPath:"access.embargo.until",required:!0}),s.createElement(m.TextAreaField,{label:g.M.t("Embargo reason"),fieldPath:"access.embargo.reason",placeholder:g.M.t("Optionally, describe the reason for the embargo."),optimized:"true"})),v&&s.createElement(s.Fragment,null,s.createElement(b.A,{hidden:!0}),s.createElement("p",null,g.M.t("Embargo was lifted on {{fmtDate}}.",{fmtDate:A})),h&&s.createElement("p",null,s.createElement("b",null,g.M.t("Reason")),": ",h,".")))))};U.propTypes={access:p().object.isRequired,metadataOnly:p().bool,accessCommunity:p().string.isRequired},U.defaultProps={metadataOnly:!1};var V=n(87395),H=function(e){var t,n,r=e.access,i=e.metadataOnly,a=e.accessCommunity,o="public"===r.record,l="public"===r.files,c="public"===a,u=(null===(t=r.embargo)||void 0===t?void 0:t.active)||!1,d=!c||!o&&!u,p=c&&o&&(i||l),f=u&&!l&&o,m=!u&&!l&&o,h=!o&&u,v=null!==(n=r.embargo)&&void 0!==n&&n.until?D.DateTime.fromISO(r.embargo.until).toLocaleString(D.DateTime.DATE_FULL):"???";return p?s.createElement(V.A,{icon:!0,positive:!0,visible:!0,"data-testid":"access-message"},s.createElement(w.A,{name:"lock open"}),s.createElement(V.A.Content,null,s.createElement(V.A.Header,null,g.M.t("Public")),i?g.M.t("The record is publicly accessible."):g.M.t("The record and files are publicly accessible."))):h?s.createElement(V.A,{icon:!0,warning:!0,visible:!0,"data-testid":"access-message"},s.createElement(w.A,{name:"lock"}),s.createElement(V.A.Content,null,s.createElement(V.A.Header,null,g.M.t("Embargoed (full record)")),s.createElement(B.x,{i18nKey:"access-message"},"On ",s.createElement("b",null,v)," the record will automatically be made publicly accessible. Until then, the record can ",s.createElement("b",null,"only")," be accessed by"," ",s.createElement("b",null,"users specified"),' in the permissions."'))):d?s.createElement(V.A,{icon:!0,negative:!0,visible:!0,"data-testid":"access-message"},s.createElement(w.A,{name:"lock"}),s.createElement(V.A.Content,null,s.createElement(V.A.Header,null,g.M.t("Restricted")),s.createElement(B.x,null,"The record can ",s.createElement("b",null,"only")," be accessed by ",s.createElement("b",null,"users specified")," in the permissions."))):m?s.createElement(V.A,{icon:!0,warning:!0,visible:!0,"data-testid":"access-message"},s.createElement(w.A,{name:"lock"}),s.createElement(V.A.Content,null,s.createElement(V.A.Header,null,g.M.t("Public with restricted files")),s.createElement(B.x,null,"The record is publicly accessible. The files can ",s.createElement("b",null,"only")," be accessed by"," ",s.createElement("b",null,"users specified")," in the permissions."))):f?s.createElement(V.A,{icon:!0,warning:!0,visible:!0,"data-testid":"access-message"},s.createElement(w.A,{name:"lock"}),s.createElement(V.A.Content,null,s.createElement(V.A.Header,null,g.M.t("Embargoed (files-only)")),s.createElement(B.x,{defaults:"The record is publicly accessible. On <bold>{{ date }}</bold> the files will automatically be made publicly accessible. Until then, the files can <bold>only</bold> be accessed by <bold>users specified</bold> in the permissions.",values:{date:v},components:{bold:s.createElement("b",null)}}))):void 0};function Y(e,t,n){return t=(0,l.A)(t),(0,o.A)(e,W()?Reflect.construct(t,n||[],(0,l.A)(e).constructor):t.apply(e,n))}function W(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(W=function(){return!!e})()}H.propTypes={access:p().object.isRequired,metadataOnly:p().bool,accessCommunity:p().string.isRequired},H.defaultProps={metadataOnly:!1};var G=function(e){function t(){return(0,i.A)(this,t),Y(this,t,arguments)}return(0,c.A)(t,e),(0,a.A)(t,[{key:"render",value:function(){var e=this.props,t=e.id,n=e.fieldPath,r=e.formik,i=e.label,a=e.labelIcon,o=e.showMetadataAccess,l=e.community,c=e.record,u=e.recordRestrictionGracePeriod,d=e.allowRecordRestriction,p=!0===(null===l||void 0===l?void 0:l.is_ghost),f=l&&!p&&l.access.visibility||"public",A=!r.form.values.files.enabled;return s.createElement(h.A,{label:i,id:t,className:"access-right"},s.createElement(v.A.Field,{required:!0},s.createElement(h.A.Content,null,s.createElement(h.A.Header,null,s.createElement(m.FieldLabel,{htmlFor:n,icon:a,label:i}))),s.createElement(h.A.Content,null,o&&s.createElement(s.Fragment,null,s.createElement(I,{recordAccess:r.field.value.record,communityAccess:f,record:c,recordRestrictionGracePeriod:u,allowRecordRestriction:d}),s.createElement(b.A,{hidden:!0})),s.createElement(M,{access:r.field.value,accessCommunity:f,metadataOnly:A}),s.createElement(b.A,{hidden:!0}),s.createElement(H,{access:r.field.value,accessCommunity:f,metadataOnly:A}),s.createElement(b.A,{hidden:!0})),s.createElement(h.A.Content,null,s.createElement(h.A.Header,{as:y.A,size:"tiny"},g.M.t("Options"))),s.createElement(h.A.Content,{extra:!0},s.createElement(U,{access:r.field.value,accessCommunity:f,metadataOnly:A}))))}}])}(s.Component);G.propTypes={id:p().string,fieldPath:p().string.isRequired,formik:p().object.isRequired,label:p().string.isRequired,labelIcon:p().string.isRequired,showMetadataAccess:p().bool,community:p().object,record:p().object.isRequired,recordRestrictionGracePeriod:p().number.isRequired,allowRecordRestriction:p().bool.isRequired},G.defaultProps={showMetadataAccess:!0,community:void 0};var Q=(0,u.connect)((function(e){return{community:e.deposit.editorState.selectedCommunity}}),null)(G),K=function(e){function t(){return(0,i.A)(this,t),Y(this,t,arguments)}return(0,c.A)(t,e),(0,a.A)(t,[{key:"render",value:function(){var e=this,t=this.props.fieldPath;return s.createElement(f.Field,{name:t},(function(t){return s.createElement(Q,(0,r.A)({formik:t},e.props))}))}}])}(s.Component);K.propTypes={fieldPath:p().string.isRequired,label:p().string.isRequired,labelIcon:p().string,isMetadataOnly:p().bool,record:p().object.isRequired,recordRestrictionGracePeriod:p().number.isRequired,allowRecordRestriction:p().bool.isRequired},K.defaultProps={labelIcon:void 0,isMetadataOnly:void 0};var X=n(1489),$={lang:"",description:"",type:""},J=n(80045),Z=["fieldPath","label","labelIcon","required","multiple","placeholder","clearable","initialOptions","serializeSuggestions"];function ee(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(ee=function(){return!!e})()}var te=function(e){function t(){return(0,i.A)(this,t),e=this,n=t,r=arguments,n=(0,l.A)(n),(0,o.A)(e,ee()?Reflect.construct(n,r||[],(0,l.A)(e).constructor):n.apply(e,r));var e,n,r}return(0,c.A)(t,e),(0,a.A)(t,[{key:"render",value:function(){var e=this.props,t=e.fieldPath,n=e.label,i=e.labelIcon,a=e.required,o=e.multiple,l=e.placeholder,c=e.clearable,u=e.initialOptions,d=e.serializeSuggestions,p=(0,J.A)(e,Z),f=d||null;return s.createElement(m.RemoteSelectField,(0,r.A)({fieldPath:t,suggestionAPIUrl:"/api/vocabularies/languages",suggestionAPIHeaders:{Accept:"application/vnd.inveniordm.v1+json"},placeholder:l,required:a,clearable:c,multiple:o,initialSuggestions:u,label:s.createElement(m.FieldLabel,{htmlFor:t,icon:i,label:n}),noQueryMessage:g.M.t("Search for languages...")},f&&{serializeSuggestions:f},p))}}])}(s.Component);function ne(e){return e.sort((function(e,t){return e.text.localeCompare(t.text)}))}function re(){window.scrollTo({top:0,left:0,behavior:"smooth"})}function ie(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(ie=function(){return!!e})()}te.propTypes={fieldPath:p().string.isRequired,label:p().string,labelIcon:p().string,required:p().bool,multiple:p().bool,clearable:p().bool,placeholder:p().string,initialOptions:p().arrayOf(p().shape({key:p().string,value:p().string,text:p().string})),serializeSuggestions:p().func},te.defaultProps={label:g.M.t("Languages"),labelIcon:"globe",multiple:!0,clearable:!0,placeholder:g.M.t('Search for a language by name (e.g "eng", "fr" or "Polish")'),required:!1,initialOptions:void 0,serializeSuggestions:void 0};var ae=function(e){function t(){return(0,i.A)(this,t),e=this,n=t,r=arguments,n=(0,l.A)(n),(0,o.A)(e,ie()?Reflect.construct(n,r||[],(0,l.A)(e).constructor):n.apply(e,r));var e,n,r}return(0,c.A)(t,e),(0,a.A)(t,[{key:"render",value:function(){var e=this.props,t=e.fieldPath,n=e.options,r=e.recordUI,i=e.editorConfig;return s.createElement(m.ArrayField,{addButtonLabel:g.M.t("Add description"),defaultNewValue:$,fieldPath:t,className:"additional-descriptions"},(function(e){var a,o=e.arrayHelpers,l=e.indexPath,c="".concat(t,".").concat(l);return s.createElement(X.A,{className:"description"},s.createElement(X.A.Row,null,s.createElement(X.A.Column,{mobile:16,tablet:10,computer:12},s.createElement(m.RichInputField,{fieldPath:"".concat(c,".description"),label:g.M.t("Additional Description"),editorConfig:i,optimized:!0,required:!0})),s.createElement(X.A.Column,{mobile:16,tablet:6,computer:4},s.createElement(v.A.Field,null,s.createElement(R.A,{"aria-label":g.M.t("Remove field"),className:"close-btn",floated:"right",icon:!0,onClick:function(){return o.remove(l)}},s.createElement(w.A,{name:"close"}))),s.createElement(m.SelectField,{fieldPath:"".concat(c,".type"),label:g.M.t("Type"),options:ne(n.type),required:!0,optimized:!0}),s.createElement(te,{serializeSuggestions:function(e){return e.map((function(e){return{text:e.title_l10n,value:e.id,fieldPathPrefix:e.id}}))},initialOptions:null!==r&&void 0!==r&&r.additional_descriptions&&null!==(a=r.additional_descriptions[l])&&void 0!==a&&a.lang?[r.additional_descriptions[l].lang]:[],fieldPath:"".concat(c,".lang"),label:g.M.t("Language"),multiple:!1,placeholder:g.M.t("Select language"),labelIcon:"",clearable:!0,selectOnBlur:!1}))))}))}}])}(s.Component);function oe(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(oe=function(){return!!e})()}ae.propTypes={fieldPath:p().string.isRequired,options:p().shape({type:p().arrayOf(p().shape({icon:p().string,text:p().string,value:p().string})),lang:p().arrayOf(p().shape({text:p().string,value:p().string}))}).isRequired,recordUI:p().object,editorConfig:p().object},ae.defaultProps={recordUI:{},editorConfig:void 0};var le=function(e){function t(){return(0,i.A)(this,t),e=this,n=t,r=arguments,n=(0,l.A)(n),(0,o.A)(e,oe()?Reflect.construct(n,r||[],(0,l.A)(e).constructor):n.apply(e,r));var e,n,r}return(0,c.A)(t,e),(0,a.A)(t,[{key:"render",value:function(){var e=this.props,t=e.fieldPath,n=e.label,r=e.labelIcon,i=e.options,a=e.editorConfig,o=e.recordUI;return s.createElement(s.Fragment,null,s.createElement(m.RichInputField,{className:"description-field rel-mb-1 rel-mt-2",fieldPath:t,editorConfig:a,label:s.createElement(m.FieldLabel,{htmlFor:t,icon:r,label:n}),optimized:!0}),s.createElement(ae,{recordUI:o,options:i,editorConfig:a,fieldPath:"metadata.additional_descriptions"}))}}])}(s.Component);le.propTypes={fieldPath:p().string.isRequired,label:p().string,labelIcon:p().string,editorConfig:p().object,recordUI:p().object,options:p().object.isRequired},le.defaultProps={label:g.M.t("Description"),labelIcon:"pencil",editorConfig:void 0,recordUI:void 0};var ce=n(82284),se=n(58156),ue=n.n(se),de=n(8909),pe=n(79551),fe=n(80296),me=n(7309),he=n.n(me),ve=n(55378),be=n.n(ve),ye=n(48423),ge=n(15941);function Ae(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Ae=function(){return!!e})()}var Ee=function(e){function t(){return(0,i.A)(this,t),e=this,n=t,r=arguments,n=(0,l.A)(n),(0,o.A)(e,Ae()?Reflect.construct(n,r||[],(0,l.A)(e).constructor):n.apply(e,r));var e,n,r}return(0,c.A)(t,e),(0,a.A)(t,[{key:"render",value:function(){var e=this.props,t=e.fieldPath,n=e.selectRef;return s.createElement(f.Field,{name:t},(function(e){var r=e.form.values;return s.createElement(m.RemoteSelectField,{fieldPath:t,suggestionAPIUrl:"/api/affiliations",suggestionAPIHeaders:{Accept:"application/vnd.inveniordm.v1+json"},initialSuggestions:(0,f.getIn)(r,t,[]),serializeSuggestions:function(e){return(0,m.AffiliationsSuggestions)(e,!0)},placeholder:g.M.t("Search or create affiliation"),label:s.createElement(m.FieldLabel,{htmlFor:"".concat(t,".name"),label:g.M.t("Affiliations")}),noQueryMessage:g.M.t("Search for affiliations.."),allowAdditions:!0,clearable:!0,multiple:!0,onValueChange:function(e,n){e.formikProps.form.setFieldValue(t,n)},value:(0,f.getIn)(r,t,[]).map((function(e){var t,n=e.id,r=e.name,i=e.text;return null!==(t=null!==n&&void 0!==n?n:r)&&void 0!==t?t:i})),ref:n,search:function(e){return e}})}))}}])}(s.Component);Ee.propTypes={fieldPath:p().string.isRequired,selectRef:p().object},Ee.defaultProps={selectRef:void 0};var we=n(45458),Re=n(99786),Ce=n.n(Re);function Pe(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Pe=function(){return!!e})()}var Se=function(e){function t(e){var n,r,a,c;return(0,i.A)(this,t),r=this,a=t,c=[e],a=(0,l.A)(a),n=(0,o.A)(r,Pe()?Reflect.construct(a,c||[],(0,l.A)(r).constructor):a.apply(r,c)),(0,A.A)(n,"handleIdentifierAddition",(function(e,t){var r=t.value;n.setState((function(e){return{selectedOptions:Ce()([{text:r,value:r,key:r}].concat((0,we.A)(e.selectedOptions)),"value")}}))})),(0,A.A)(n,"valuesToOptions",(function(e){return e.map((function(e){return{text:e,value:e,key:e}}))})),(0,A.A)(n,"handleChange",(function(e){var t=e.data,r=e.formikProps,i=n.props.fieldPath;n.setState({selectedOptions:n.valuesToOptions(t.value)}),r.form.setFieldValue(i,t.value)})),n.state={selectedOptions:e.initialOptions},n}return(0,c.A)(t,e),(0,a.A)(t,[{key:"render",value:function(){var e=this.props,t=e.fieldPath,n=e.label,r=e.placeholder,i=this.state.selectedOptions;return s.createElement(m.SelectField,{fieldPath:t,label:n,options:i,placeholder:r,noResultsMessage:g.M.t("Type the value of an identifier..."),search:!0,multiple:!0,selection:!0,allowAdditions:!0,onChange:this.handleChange,icon:null,onAddItem:this.handleIdentifierAddition,optimized:!0})}}])}(s.Component);Se.propTypes={initialOptions:p().arrayOf(p().shape({key:p().string.isRequired,text:p().string.isRequired,value:p().string.isRequired})).isRequired,fieldPath:p().string.isRequired,label:p().string,placeholder:p().string},Se.defaultProps={label:g.M.t("Identifiers"),placeholder:g.M.t("e.g. ORCID, ISNI or GND.")};var ke="personal",Oe="organizational";function De(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ie(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?De(Object(n),!0).forEach((function(t){(0,A.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):De(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Me(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Me=function(){return!!e})()}var Fe="add",xe="search_only",Te="off",qe=function(e){function t(e){var n,r,a,c;return(0,i.A)(this,t),r=this,a=t,c=[e],a=(0,l.A)(a),n=(0,o.A)(r,Me()?Reflect.construct(a,c||[],(0,l.A)(r).constructor):a.apply(r,c)),(0,A.A)(n,"CreatorSchema",ge.Ik({person_or_org:ge.Ik({type:ge.Yj(),family_name:ge.Yj().when("type",(function(e,t){if(e===ke&&n.isCreator())return t.required(g.M.t("Family name is a required field."))})),name:ge.Yj().when("type",(function(e,t){if(e===Oe&&n.isCreator())return t.required(g.M.t("Name is a required field."))}))}),role:ge.Yj().when("_",(function(e,t){if(!n.isCreator())return t.required(g.M.t("Role is a required field."))}))})),(0,A.A)(n,"openModal",(function(){n.setState({open:!0,action:null},(function(){var e=n.props.initialCreatibutor;x()(e)||(n.state.isOrganization?(e.person_or_org.family_name="",e.person_or_org.given_name=""):e.person_or_org.name="",n.initStatesFromInitialCreatibutor(e))}))})),(0,A.A)(n,"closeModal",(function(){n.setState({personAffiliations:[],personIdentifiers:[],organizationAffiliations:[],organizationIdentifiers:[],open:!1,action:null})})),(0,A.A)(n,"changeContent",(function(){n.setState({saveAndContinueLabel:g.M.t("Added")}),setTimeout((function(){n.setState({saveAndContinueLabel:g.M.t("Save and add another")})}),2e3)})),(0,A.A)(n,"displayActionLabel",(function(){var e=n.props,t=e.action,r=e.addLabel,i=e.editLabel;return t===Fe?r:i})),(0,A.A)(n,"serializeCreatibutor",(function(e){var t=n.props.initialCreatibutor,r="person_or_org.identifiers",i=ue()(t,r,[]),a=ue()(e,r,[]).map((function(e){return t=i,n="identifier",r=e,he()(t,(0,A.A)({},n,r))||(0,A.A)({},n,r);var t,n,r})),o=ue()(e,"affiliations",[]);return Ie(Ie({},e),{},{person_or_org:Ie(Ie({},e.person_or_org),{},{identifiers:a}),affiliations:o})})),(0,A.A)(n,"deserializeCreatibutor",(function(e){return{person_or_org:Ie(Ie({type:ke},e.person_or_org),{},{identifiers:be()(ue()(e,"person_or_org.identifiers",[]),"identifier")}),affiliations:ue()(e,"affiliations",[]),role:ue()(e,"role","")}})),(0,A.A)(n,"isCreator",(function(){return"creators"===n.props.schema})),(0,A.A)(n,"onSubmit",(function(e,t){var r=n.props.onCreatibutorChange,i=n.state.action;switch(r(n.serializeCreatibutor(e)),t.setSubmitting(!1),t.resetForm(),i){case"saveAndContinue":n.closeModal(),n.openModal(),n.changeContent();break;case"saveAndClose":n.closeModal()}})),(0,A.A)(n,"serializeSuggestions",(function(e){var t=n.state.isOrganization;return(0,m.AffiliationsSuggestions)(e,t)})),(0,A.A)(n,"onOrganizationSearchChange",(function(e,t){var r=e.formikProps,i=t[0].extra;n.setState({organizationIdentifiers:i.identifiers.filter((function(e){return"grid"!==e.scheme})).map((function(e){return e.identifier})),organizationAffiliations:[]},(function(){var e=n.state,t=e.organizationIdentifiers,a=e.organizationAffiliations;r.form.setFieldValue("person_or_org.name",i.name),n.updateIdentifiersAndAffiliations(r,t,a,n.identifiersRef,n.affiliationsRef)}))})),(0,A.A)(n,"onPersonSearchChange",(function(e,t){var r=e.formikProps;if("manual-entry"===t[0].key)return n.namesAutocompleteRef.current.setState({suggestions:[],selectedSuggestions:[]}),void n.setState({showPersonForm:!0});var i=t[0].extra;n.setState({showPersonForm:!0,personIdentifiers:i.identifiers.map((function(e){return e.identifier})),personAffiliations:i.affiliations.map((function(e){return e}))},(function(){var e=n.state,t=e.personIdentifiers,a=e.personAffiliations,o="person_or_org",l="".concat(o,".family_name"),c="".concat(o,".given_name"),s=(0,A.A)((0,A.A)({},c,i.given_name),l,i.family_name);Object.entries(s).forEach((function(e){var t=(0,fe.A)(e,2),n=t[0],i=t[1];r.form.setFieldValue(n,i)})),n.updateIdentifiersAndAffiliations(r,t,a,n.identifiersRef,n.affiliationsRef)}))})),n.state={open:!1,saveAndContinueLabel:g.M.t("Save and add another"),action:null,showPersonForm:e.autocompleteNames!==xe||!x()(e.initialCreatibutor),isOrganization:!x()(e.initialCreatibutor)&&e.initialCreatibutor.person_or_org.type===Oe,personIdentifiers:[],personAffiliations:[],organizationIdentifiers:[],organizationAffiliations:[]},n.inputRef=(0,s.createRef)(),n.identifiersRef=(0,s.createRef)(),n.affiliationsRef=(0,s.createRef)(),n.namesAutocompleteRef=(0,s.createRef)(),n}return(0,c.A)(t,e),(0,a.A)(t,[{key:"initStatesFromInitialCreatibutor",value:function(e){var t,n=e.affiliations,r=void 0===n?[]:n,i=this.state.isOrganization,a=null===(t=e.person_or_org.identifiers)||void 0===t?void 0:t.map((function(e){return e.identifier}));this.setState({personIdentifiers:i?[]:a,personAffiliations:i?[]:r,organizationIdentifiers:i?a:[],organizationAffiliations:i?r:[]})}},{key:"updateIdentifiersAndAffiliations",value:function(e,t,n,r,i){var a="".concat("person_or_org",".identifiers"),o=(0,A.A)((0,A.A)({},a,t),"affiliations",n);Object.entries(o).forEach((function(t){var n=(0,fe.A)(t,2),r=n[0],i=n[1];e.form.setFieldValue(r,i)})),r.current.setState({selectedOptions:r.current.valuesToOptions(t)});var l=n.map((function(e){var t=e.id,n=e.name;return{text:n,value:null!==t&&void 0!==t?t:n,key:null!==t&&void 0!==t?t:n,name:n}}));i.current.setState({suggestions:l,selectedSuggestions:l,searchQuery:null,error:!1,open:!1})}},{key:"render",value:function(){var e=this,t=this.props,n=t.initialCreatibutor,i=t.autocompleteNames,a=t.roleOptions,o=t.trigger,l=t.action,c=this.state,u=c.open,d=c.showPersonForm,p=c.personIdentifiers,h=c.personAffiliations,b=c.organizationIdentifiers,y=c.organizationAffiliations,A=c.saveAndContinueLabel,E=this.displayActionLabel();return s.createElement(f.Formik,{initialValues:this.deserializeCreatibutor(n),onSubmit:this.onSubmit,enableReinitialize:!0,validationSchema:this.CreatorSchema,validateOnChange:!1,validateOnBlur:!1},(function(t){var c=t.values,f=t.resetForm,w=t.handleSubmit,C="person_or_org",P="".concat(C,".type"),S="".concat(C,".family_name"),k="".concat(C,".given_name"),O="".concat(C,".name"),D="".concat(C,".identifiers"),I="affiliations";return s.createElement(ye.A,{centered:!1,onOpen:function(){return e.openModal()},open:u,trigger:o,onClose:function(){e.closeModal(),f()},closeIcon:!0,closeOnDimmerClick:!1},s.createElement(ye.A.Header,{as:"h2",className:"pt-10 pb-10"},E),s.createElement(ye.A.Content,null,s.createElement(v.A,null,s.createElement(v.A.Group,null,s.createElement(m.RadioField,{fieldPath:P,label:g.M.t("Person"),checked:ue()(c,P)===ke,value:ke,onChange:function(t){var n=t.formikProps;e.setState({isOrganization:!1}),n.form.setFieldValue(P,ke),n.form.setFieldValue(D,p),n.form.setFieldValue(I,h)},autoFocus:!0,optimized:!0}),s.createElement(m.RadioField,{fieldPath:P,label:g.M.t("Organization"),checked:ue()(c,P)===Oe,value:Oe,onChange:function(t){var n=t.formikProps;e.setState({isOrganization:!0}),n.form.setFieldValue(P,Oe),n.form.setFieldValue(I,y),n.form.setFieldValue(D,b)},optimized:!0})),ue()(c,P,"")===ke?s.createElement(s.Fragment,null,i!==Te&&s.createElement(m.RemoteSelectField,{selectOnBlur:!1,selectOnNavigation:!1,searchInput:{autoFocus:x()(n)},fieldPath:"creators",clearable:!0,multiple:!1,allowAdditions:!1,placeholder:g.M.t("Search for persons by name, identifier, or affiliation..."),noQueryMessage:g.M.t("Search for persons by name, identifier, or affiliation..."),required:!1,search:function(e){return e},suggestionAPIUrl:"/api/names",serializeSuggestions:e.serializeSuggestions,onValueChange:e.onPersonSearchChange,ref:e.namesAutocompleteRef}),d&&s.createElement(s.Fragment,null,s.createElement(v.A.Group,{widths:"equal"},s.createElement(m.TextField,{label:g.M.t("Family name"),placeholder:g.M.t("Family name"),fieldPath:S,required:e.isCreator()}),s.createElement(m.TextField,{label:g.M.t("Given names"),placeholder:g.M.t("Given names"),fieldPath:k})),s.createElement(Se,{initialOptions:be()(ue()(c,D,[]),(function(e){return{text:e,value:e,key:e}})),fieldPath:D,ref:e.identifiersRef}),s.createElement(Ee,{fieldPath:I,selectRef:e.affiliationsRef}))):s.createElement(s.Fragment,null,i!==Te&&s.createElement(m.RemoteSelectField,{selectOnBlur:!1,selectOnNavigation:!1,searchInput:{autoFocus:x()(n)},fieldPath:"creators",clearable:!0,multiple:!1,allowAdditions:!1,placeholder:g.M.t("Search for an organization by name, identifier, or affiliation..."),noQueryMessage:g.M.t("Search for organization by name, identifier, or affiliation..."),required:!1,search:function(e){return e},suggestionAPIUrl:"/api/affiliations",serializeSuggestions:e.serializeSuggestions,onValueChange:e.onOrganizationSearchChange}),s.createElement(m.TextField,{label:g.M.t("Name"),placeholder:g.M.t("Organization name"),fieldPath:O,required:e.isCreator(),input:{ref:e.inputRef}}),s.createElement(Se,{initialOptions:be()(ue()(c,D,[]),(function(e){return{text:e,value:e,key:e}})),fieldPath:D,ref:e.identifiersRef,placeholder:g.M.t("e.g. ROR, ISNI or GND.")}),s.createElement(Ee,{fieldPath:I,selectRef:e.affiliationsRef})),(ue()(c,P)===Oe||d&&ue()(c,P)===ke)&&s.createElement(m.SelectField,(0,r.A)({fieldPath:"role",label:g.M.t("Role"),options:a,placeholder:g.M.t("Select role")},e.isCreator()&&{clearable:!0},{required:!e.isCreator(),optimized:!0,scrolling:!0})))),s.createElement(ye.A.Actions,null,s.createElement(R.A,{name:"cancel",onClick:function(){f(),e.closeModal()},icon:"remove",content:g.M.t("Cancel"),floated:"left"}),l===Fe&&s.createElement(R.A,{name:"submit",onClick:function(){e.setState({action:"saveAndContinue",showPersonForm:i!==xe},(function(){w()}))},primary:!0,icon:"checkmark",content:A}),s.createElement(R.A,{name:"submit",onClick:function(){e.setState({action:"saveAndClose",showPersonForm:i!==xe},(function(){return w()}))},primary:!0,icon:"checkmark",content:g.M.t("Save")})))}))}}])}(s.Component);qe.propTypes={schema:p().oneOf(["creators","contributors"]).isRequired,action:p().oneOf(["add","edit"]).isRequired,addLabel:p().string.isRequired,autocompleteNames:p().oneOf(["search","search_only","off"]),editLabel:p().string.isRequired,initialCreatibutor:p().shape({id:p().string,person_or_org:p().shape({family_name:p().string,given_name:p().string,name:p().string,type:p().string,identifiers:p().arrayOf(p().shape({scheme:p().string,identifier:p().string}))}),affiliations:p().array,role:p().string}),trigger:p().object.isRequired,onCreatibutorChange:p().func.isRequired,roleOptions:p().array},qe.defaultProps={roleOptions:[],initialCreatibutor:{},autocompleteNames:"search"};var _e=n(97177),je=n(65522),ze=n(28085),Le=n(16147),Ne=function(e){var t=e.compKey,n=e.creatibutorError,r=e.index,i=e.replaceCreatibutor,a=e.removeCreatibutor,o=e.moveCreatibutor,l=e.addLabel,c=e.editLabel,u=e.initialCreatibutor,d=e.displayName,p=e.roleOptions,f=e.schema,h=e.autocompleteNames,v=s.useRef(null),b=(0,_e.i)({item:{index:r,type:"creatibutor"}}),y=(0,fe.A)(b,3),A=(y[0],y[1]),E=y[2],w=(0,je.H)({accept:"creatibutor",hover:function(e,t){if(v.current){var n=e.index,i=r;n!==i&&t.isOver({shallow:!0})&&(o(n,i),e.index=i)}},collect:function(e){return{hidden:e.isOver({shallow:!0})}}}),C=(0,fe.A)(w,2),P=C[0].hidden;return(0,C[1])(v),s.createElement(Le.o,{innerRef:v,key:t},s.createElement(T.A.Item,{key:t,className:P?"deposit-drag-listitem hidden":"deposit-drag-listitem"},s.createElement(T.A.Content,{floated:"right"},s.createElement(qe,{addLabel:l,editLabel:c,onCreatibutorChange:function(e){i(r,e)},initialCreatibutor:u,roleOptions:p,schema:f,autocompleteNames:h,action:"edit",trigger:s.createElement(R.A,{size:"mini",primary:!0,type:"button"},g.M.t("Edit"))}),s.createElement(R.A,{size:"mini",type:"button",onClick:function(){return a(r)}},g.M.t("Remove"))),s.createElement(Le.o,{innerRef:A},s.createElement(T.A.Icon,{name:"bars",className:"drag-anchor"})),s.createElement(Le.o,{innerRef:E},s.createElement(T.A.Content,null,s.createElement(T.A.Description,null,s.createElement("span",{className:"creatibutor"},ue()(u,"person_or_org.identifiers",[]).some((function(e){return"orcid"===e.scheme}))&&s.createElement("img",{alt:g.M.t("ORCID logo"),className:"inline-id-icon mr-5",src:"/static/images/orcid.svg",width:"16",height:"16"}),ue()(u,"person_or_org.identifiers",[]).some((function(e){return"ror"===e.scheme}))&&s.createElement("img",{alt:g.M.t("ROR logo"),className:"inline-id-icon mr-5",src:"/static/images/ror-icon.svg",width:"16",height:"16"}),ue()(u,"person_or_org.identifiers",[]).some((function(e){return"gnd"===e.scheme}))&&s.createElement("img",{alt:g.M.t("GND logo"),className:"inline-id-icon mr-5",src:"/static/images/gnd-icon.svg",width:"16",height:"16"}),d," ",function(e,t){if(e){var n,r,i=null!==(n=null===(r=t.find((function(t){return t.value===e})))||void 0===r?void 0:r.text)&&void 0!==n?n:e;return s.createElement(ze.A,{size:"tiny"},i)}}(null===u||void 0===u?void 0:u.role,p))),n&&s.createElement(m.FeedbackLabel,{errorMessage:n})))))};function Be(e,t,n){return t=(0,l.A)(t),(0,o.A)(e,Ue()?Reflect.construct(t,n||[],(0,l.A)(e).constructor):t.apply(e,n))}function Ue(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Ue=function(){return!!e})()}Ne.propTypes={compKey:p().string.isRequired,creatibutorError:p().array,index:p().number.isRequired,replaceCreatibutor:p().func.isRequired,removeCreatibutor:p().func.isRequired,moveCreatibutor:p().func.isRequired,addLabel:p().node,editLabel:p().node,initialCreatibutor:p().object.isRequired,displayName:p().string,roleOptions:p().array.isRequired,schema:p().string.isRequired,autocompleteNames:p().oneOfType([p().bool,p().string])},Ne.defaultProps={creatibutorError:void 0,addLabel:void 0,editLabel:void 0,displayName:void 0,autocompleteNames:void 0};var Ve=function(e){function t(){var e;(0,i.A)(this,t);for(var n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return e=Be(this,t,[].concat(r)),(0,A.A)(e,"handleOnContributorChange",(function(t){(0,e.props.push)(t)})),e}return(0,c.A)(t,e),(0,a.A)(t,[{key:"render",value:function(){var e,t=this.props,n=t.form,r=n.values,i=n.errors,a=n.initialErrors,o=n.initialValues,l=t.remove,c=t.replace,u=t.move,d=t.name,p=t.label,h=t.labelIcon,b=t.roleOptions,y=t.schema,g=t.modal,A=t.autocompleteNames,E=t.addButtonLabel,C=(0,f.getIn)(r,d,[]),P=(0,f.getIn)(o,d,[]),S=(0,f.getIn)(i,d,null),k=(0,f.getIn)(a,d,null),O=S||C===P&&k,D="";return O&&(D="string"!==typeof O?O.severity:"error"),"string"===typeof O?e=O:"object"===(0,ce.A)(O)&&null!==O&&(e={message:null===O||void 0===O?void 0:O.message,severity:null===O||void 0===O?void 0:O.severity,description:null===O||void 0===O?void 0:O.description}),s.createElement(pe.Q,{backend:de.t2},s.createElement(v.A.Field,{required:"creators"===y,className:D},s.createElement(m.FieldLabel,{htmlFor:d,icon:h,label:p}),s.createElement(T.A,null,C.map((function(e,t){var n="".concat(d,".").concat(t),r=function(e){var t=ue()(e,"person_or_org.type",ke)===ke,n=ue()(e,"person_or_org.family_name",""),r=ue()(e,"person_or_org.given_name",""),i=null===e||void 0===e?void 0:e.affiliations.map((function(e){return e.text||e.name})),a=ue()(e,"person_or_org.name"),o=i.length?" (".concat(i.join(", "),")"):"";if(t){var l=r?", ".concat(r):"";return"".concat(n).concat(l).concat(o)}return"".concat(a).concat(o)}(e);return s.createElement(Ne,{key:n,creatibutorError:O&&"string"!==typeof O&&O[t],displayName:r,index:t,roleOptions:b,schema:y,compKey:n,initialCreatibutor:e,removeCreatibutor:l,replaceCreatibutor:c,moveCreatibutor:u,addLabel:g.addLabel,editLabel:g.editLabel,autocompleteNames:A})}))),s.createElement(qe,{onCreatibutorChange:this.handleOnContributorChange,action:"add",addLabel:g.addLabel,editLabel:g.editLabel,roleOptions:ne(b),schema:y,autocompleteNames:A,trigger:s.createElement(R.A,{type:"button",icon:!0,labelPosition:"left",className:D},s.createElement(w.A,{name:"add"}),E)}),e&&s.createElement(m.FeedbackLabel,{errorMessage:e})))}}])}(s.Component),He=function(e){function t(){return(0,i.A)(this,t),Be(this,t,arguments)}return(0,c.A)(t,e),(0,a.A)(t,[{key:"render",value:function(){var e=this,t=this.props.fieldPath;return s.createElement(f.FieldArray,{name:t,component:function(t){return s.createElement(Ve,(0,r.A)({},t,e.props))}})}}])}(s.Component);Ve.propTypes={fieldPath:p().string.isRequired,addButtonLabel:p().string,modal:p().shape({addLabel:p().string.isRequired,editLabel:p().string.isRequired}),schema:p().oneOf(["creators","contributors"]).isRequired,autocompleteNames:p().oneOf(["search","search_only","off"]),label:p().string,labelIcon:p().string,roleOptions:p().array.isRequired,form:p().object.isRequired,remove:p().func.isRequired,replace:p().func.isRequired,move:p().func.isRequired,push:p().func.isRequired,name:p().string.isRequired},Ve.defaultProps={autocompleteNames:"search",label:g.M.t("Creators"),labelIcon:"user",modal:{addLabel:g.M.t("Add creator"),editLabel:g.M.t("Edit creator")},addButtonLabel:g.M.t("Add creator")},He.propTypes={fieldPath:p().string.isRequired,addButtonLabel:p().string,modal:p().shape({addLabel:p().string.isRequired,editLabel:p().string.isRequired}),schema:p().oneOf(["creators","contributors"]).isRequired,autocompleteNames:p().oneOf(["search","search_only","off"]),label:p().string,labelIcon:p().string,roleOptions:p().array},He.defaultProps={autocompleteNames:"search",label:void 0,labelIcon:void 0,roleOptions:void 0,modal:{addLabel:g.M.t("Add creator"),editLabel:g.M.t("Edit creator")},addButtonLabel:g.M.t("Add creator")};var Ye=n(61505),We=n.n(Ye),Ge=n(87612),Qe=n.n(Ge),Ke=n(2404),Xe=n.n(Ke),$e=n(61448),Je=n.n($e),Ze={date:"",description:"",type:""};function et(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return tt(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?tt(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){l=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(l)throw a}}}}function tt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function nt(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(nt=function(){return!!e})()}var rt=function(e){function t(){var e,n,r,a;(0,i.A)(this,t);for(var c=arguments.length,s=new Array(c),u=0;u<c;u++)s[u]=arguments[u];return n=this,r=t,a=[].concat(s),r=(0,l.A)(r),e=(0,o.A)(n,nt()?Reflect.construct(r,a||[],(0,l.A)(n).constructor):r.apply(n,a)),(0,A.A)(e,"getRequiredOption",(function(t,n){var r,i=et(e.props.requiredOptions);try{for(i.s();!(r=i.n()).done;){var a=r.value,o=Qe()(n,We()(a))[0];if(Xe()(o,t))return a}}catch(l){i.e(l)}finally{i.f()}return null})),e}return(0,c.A)(t,e),(0,a.A)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.fieldPath,r=t.options,i=t.label,a=t.labelIcon,o=t.placeholderDate,l=t.required,c=t.requiredOptions,u=t.showEmptyValue;return s.createElement(O.default,{id:"InvenioRdmRecords.DatesField.AddDateArrayField.Container",fieldPath:n},s.createElement(m.ArrayField,{addButtonLabel:g.M.t("Add date"),defaultNewValue:Ze,fieldPath:n,helpText:g.M.t("Format: DATE or DATE/DATE where DATE is YYYY or YYYY-MM or YYYY-MM-DD."),label:i,labelIcon:a,required:l,requiredOptions:c,showEmptyValue:u},(function(t){var i=t.array,a=t.arrayHelpers,l=t.indexPath,c=t.value,u="".concat(n,".").concat(l),d=e.getRequiredOption(c,i),p=Je()(d,"date"),f=Je()(d,"type"),h=Je()(d,"description");return s.createElement(m.GroupField,{fieldPath:n,optimized:!0},s.createElement(O.default,{id:"InvenioRdmRecords.DatesField.DateTextField.Container",fieldPath:"".concat(u,".date")},s.createElement(m.TextField,{fieldPath:"".concat(u,".date"),label:g.M.t("Date"),placeholder:o,disabled:p,required:!0,width:5})),s.createElement(O.default,{id:"InvenioRdmRecords.DatesField.TypeSelectField.Container",fieldPath:"".concat(u,".type")},s.createElement(m.SelectField,{fieldPath:"".concat(u,".type"),label:g.M.t("Type"),"aria-label":g.M.t("Type"),options:ne(r.type),disabled:f,required:!0,width:5,optimized:!0})),s.createElement(O.default,{id:"InvenioRdmRecords.DatesField.DescriptionTextField.Container",fieldPath:"".concat(u,".description")},s.createElement(m.TextField,{fieldPath:"".concat(u,".description"),label:g.M.t("Description"),disabled:h,width:5})),s.createElement(O.default,{id:"InvenioRdmRecords.DatesField.RemoveFormField.Container"},s.createElement(v.A.Field,null,s.createElement(R.A,{"aria-label":g.M.t("Remove field"),className:"close-btn",disabled:!x()(d),icon:!0,onClick:function(){return a.remove(l)},type:"button"},s.createElement(w.A,{name:"close"})))))})))}}])}(s.Component);rt.propTypes={fieldPath:p().string.isRequired,label:p().string,labelIcon:p().string,options:p().shape({type:p().arrayOf(p().shape({text:p().string,value:p().string}))}).isRequired,required:p().bool,placeholderDate:p().string,requiredOptions:p().array,showEmptyValue:p().bool},rt.defaultProps={label:g.M.t("Dates"),labelIcon:"calendar",placeholderDate:g.M.t("YYYY-MM-DD or YYYY-MM-DD/YYYY-MM-DD"),required:!1,requiredOptions:[],showEmptyValue:!1};var it=n(10467),at=n(54756),ot=n.n(at),lt=n(2543),ct=n.n(lt),st="DRAFT_FETCHED",ut="DRAFT_HAS_VALIDATION_ERRORS",dt="DRAFT_SAVE_STARTED",pt="DRAFT_SAVE_SUCCEEDED",ft="DRAFT_SAVE_FAILED",mt="DRAFT_PUBLISH_STARTED",ht="DRAFT_PUBLISH_FAILED",vt="DRAFT_PUBLISH_FAILED_WITH_VALIDATION_ERRORS",bt="DRAFT_PREVIEW_STARTED",yt="DRAFT_PREVIEW_FAILED",gt="DRAFT_DELETE_STARTED",At="DRAFT_DELETE_FAILED",Et="DRAFT_SUBMIT_REVIEW_STARTED",wt="DRAFT_SUBMIT_REVIEW_FAILED",Rt="DRAFT_SUBMIT_REVIEW_FAILED_WITH_VALIDATION_ERRORS",Ct="RESERVE_PID_STARTED",Pt="RESERVE_PID_SUCCEEDED",St="RESERVE_PID_FAILED",kt="DISCARD_PID_STARTED",Ot="DISCARD_PID_SUCCEEDED",Dt="DISCARD_PID_FAILED",It="SET_DOI_NEEDED",Mt="FILE_UPLOAD_ADDED",Ft="FILE_UPLOAD_IN_PROGRESS",xt="FILE_UPLOAD_FINISHED",Tt="FILE_UPLOAD_FAILED",qt="FILE_UPLOAD_SAVE_DRAFT_FAILED",_t="FILE_IMPORT_STARTED",jt="FILE_IMPORT_SUCCESS",zt="FILE_IMPORT_FAILED",Lt="FILE_DELETED_SUCCESS",Nt="FILE_DELETE_FAILED",Bt="FILE_UPLOAD_SET_CANCEL_FUNCTION",Ut="FILE_UPLOAD_CANCELLED",Vt="SET_COMMUNITY";function Ht(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Yt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ht(Object(n),!0).forEach((function(t){(0,A.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ht(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Wt(e){return Gt.apply(this,arguments)}function Gt(){return(Gt=(0,it.A)(ot().mark((function e(t){return ot().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:window.history.replaceState(void 0,"",t);case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Qt=function(){var e=(0,it.A)(ot().mark((function e(t,n){var r,i,a;return ot().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=!!t.id,e.next=3,n.save(t);case 3:return i=e.sent,!x()(i.errors)&&(a={metadata:t.metadata,custom_fields:t.custom_fields},i.data=ct().merge(i.data,a)),r||Wt(i.data.links.self_html),e.abrupt("return",i);case 8:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();function Kt(e){if("object"!==(0,ce.A)(e))return!0;if(Object.hasOwn(e,"message")&&Object.hasOwn(e,"severity")&&Object.hasOwn(e,"description")&&"error"===e.severity)return!0;for(var t=0,n=Object.keys(e);t<n.length;t++){var r=n[t];if("message"!==r&&"severity"!==r&&"description"!==r)return Kt(e[r])}}function Xt(e,t,n){return $t.apply(this,arguments)}function $t(){return($t=(0,it.A)(ot().mark((function e(t,n,r){var i,a,o,l,c,s,u,d,p,f,m,h,v,b,y;return ot().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=r.depositState,a=r.dispatchFn,o=r.failType,l=r.partialValidationActionType,c=r.showOnlyValidationErrorsWithSeverityError,e.prev=1,e.next=4,Qt(t,n,o);case 4:s=e.sent,e.next=12;break;case 7:throw e.prev=7,e.t0=e.catch(1),console.error("Error saving draft",e.t0,t),a({type:o,payload:{errors:e.t0.errors}}),e.t0;case 12:if(u=c?Kt(s.errors):!x()(s.errors),d=u?s:{},p=i.editorState,f=p.actions,m=f.communityStateMustBeChecked,h=f.shouldDeleteReview,v=f.shouldUpdateReview,b=p.selectedCommunity,!m){e.next=28;break}if(y=s.data,!h){e.next=20;break}return e.next=20,n.deleteReview(y.links);case 20:if(!v){e.next=23;break}return e.next=23,n.createOrUpdateReview(y.links,b.id);case 23:return e.next=25,n.read(y.links);case 25:s=e.sent,a({type:st,payload:{data:s.data}}),d.data=Yt(Yt({},d.data),s.data);case 28:if(!u){e.next=31;break}throw a({type:l,payload:{data:d.data,errors:d.errors}}),d;case 31:return e.abrupt("return",s);case 32:case"end":return e.stop()}}),e,null,[[1,7]])})))).apply(this,arguments)}var Jt=function(e){return function(){var t=(0,it.A)(ot().mark((function t(n){return ot().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n({type:Vt,payload:{community:e}});case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()};function Zt(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return en(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?en(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){l=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(l)throw a}}}}function en(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function tn(e){var t=function(e,t){if("object"!=(0,ce.A)(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=(0,ce.A)(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==(0,ce.A)(t)?t:t+""}function nn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function rn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?nn(Object(n),!0).forEach((function(t){(0,A.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):nn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var an={uploading:"uploading",error:"error",finished:"finished",pending:"pending"},on={};const ln=function(){var e,t,n,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:on,i=arguments.length>1?arguments[1]:void 0,a=null!==(e=null===(t=i.payload)||void 0===t||null===(t=t.filename)||void 0===t?void 0:t.normalize())&&void 0!==e?e:"";switch(i.type){case Mt:return rn(rn({},r),{},{entries:rn(rn({},r.entries),{},(0,A.A)({},a,{progressPercentage:0,name:a,size:0,status:an.pending,checksum:null,links:null,cancelUploadFn:null})),actionState:i.type});case Ft:return rn(rn({},r),{},{entries:rn(rn({},r.entries),{},(0,A.A)({},a,rn(rn({},r.entries[a]),{},{progressPercentage:i.payload.percent,status:an.uploading}))),isFileUploadInProgress:!0,actionState:i.type});case xt:return n=rn(rn({},r),{},{entries:rn(rn({},r.entries),{},(0,A.A)({},a,rn(rn({},r.entries[a]),{},{status:an.finished,size:i.payload.size,progressPercentage:100,checksum:i.payload.checksum,links:i.payload.links,cancelUploadFn:null})))}),rn(rn({},n),{},{isFileUploadInProgress:Object.values(n.entries).some((function(e){return e.status===an.uploading})),actionState:i.type});case qt:return rn(rn({},r),{},{errors:rn({},i.payload.errors),actionState:i.type});case Tt:return n=rn(rn({},r),{},{entries:rn(rn({},r.entries),{},(0,A.A)({},a,rn(rn({},r.entries[a]),{},{status:an.error,cancelUploadFn:null})))}),rn(rn({},n),{},{isFileUploadInProgress:Object.values(n.entries).some((function(e){return e.status===an.uploading})),actionState:i.type});case Bt:return rn(rn({},r),{},{entries:rn(rn({},r.entries),{},(0,A.A)({},a,rn(rn({},r.entries[a]),{},{cancelUploadFn:i.payload.cancelUploadFn}))),actionState:i.type});case Ut:var o=r.entries,l=(o[a],(0,J.A)(o,[a].map(tn)));return rn(rn({},r),{},{entries:rn({},l),isFileUploadInProgress:Object.values(l).some((function(e){return e.status===an.uploading})),actionState:i.type});case Lt:var c=r.entries,s=(c[a],(0,J.A)(c,[a].map(tn)));return rn(rn({},r),{},{entries:rn({},s),isFileUploadInProgress:Object.values(s).some((function(e){return e.status===an.uploading})),actionState:i.type});case Nt:return rn(rn({},r),{},{actionState:i.type});case _t:return rn(rn({},r),{},{isFileImportInProgress:!0,actionState:i.type});case jt:return rn(rn({},r),{},{entries:rn({},i.payload.files),isFileImportInProgress:!1,actionState:i.type});case zt:return rn(rn({},r),{},{isFileImportInProgress:!1,actionState:i.type});default:return r}};var cn=["onError","record","disabled"],sn=function(e){var t=e.onError,n=e.record,i=e.disabled,a=(0,J.A)(e,cn),o=(0,s.useState)(!1),l=(0,fe.A)(o,2),c=l[0],u=l[1],d=function(){var e=(0,it.A)(ot().mark((function e(){var r;return ot().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u(!0),e.prev=1,e.next=4,m.http.post(n.links.versions);case 4:r=e.sent,window.location=r.data.links.self_html,e.next=13;break;case 8:e.prev=8,e.t0=e.catch(1),console.error(e.t0),u(!1),t(e.t0.response.data.message);case 13:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(){return e.apply(this,arguments)}}();return s.createElement(E.A,{content:g.M.t("You don't have permissions to create a new version."),position:"top center",disabled:!i,trigger:s.createElement("span",null,s.createElement(R.A,(0,r.A)({type:"button",positive:!0,size:"mini",onClick:d,loading:c,icon:!0,labelPosition:"left",disabled:i},a),s.createElement(w.A,{name:"tag"}),g.M.t("New version")))})};sn.propTypes={onError:p().func.isRequired,record:p().object.isRequired,disabled:p().bool},sn.defaultProps={disabled:!1};var un=n(75497),dn=n(53959),pn=n(42755),fn=n(2685);function mn(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(mn=function(){return!!e})()}var hn=function(e){var t=e.filesLocked;return s.createElement(dn.A.Header,null,s.createElement(dn.A.Row,null,s.createElement(dn.A.HeaderCell,null,g.M.t("Preview")," ",s.createElement(E.A,{content:g.M.t("Set the default preview"),trigger:s.createElement(w.A,{fitted:!0,name:"help circle",size:"small"})})),s.createElement(dn.A.HeaderCell,null,g.M.t("Filename")),s.createElement(dn.A.HeaderCell,null,g.M.t("Size")),!t&&s.createElement(dn.A.HeaderCell,{textAlign:"center"},g.M.t("Progress")),!t&&s.createElement(dn.A.HeaderCell,null)))};hn.propTypes={filesLocked:p().bool},hn.defaultProps={filesLocked:!1};var vn=function(e){var t,n,r,i,a,o,l=e.filesLocked,c=e.file,u=e.deleteFile,d=e.defaultPreview,p=e.setDefaultPreview,f=e.decimalSizeDisplay,h=e.fileError,v=(0,s.useState)(!1),b=(0,fe.A)(v,2),y=b[0],A=b[1],C=(0,s.useState)(!1),P=(0,fe.A)(C,2),S=P[0],k=P[1],O=d===c.name,D=function(){var e=(0,it.A)(ot().mark((function e(t){return ot().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return k(!0),e.prev=1,e.next=4,u(t);case 4:O&&p(""),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(1),k(!1),console.error(e.t0);case 11:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(t){return e.apply(this,arguments)}}();return s.createElement(dn.A.Row,{key:c.name},s.createElement(dn.A.Cell,{"data-label":g.M.t("Default preview"),width:2},s.createElement(q.A,{checked:O,onChange:function(){return p(O?"":c.name)}})),s.createElement(dn.A.Cell,{"data-label":g.M.t("Filename"),width:10},s.createElement("div",null,h&&s.createElement(s.Fragment,null,s.createElement(m.FeedbackLabel,{errorMessage:h,pointing:"below"}),s.createElement("br",null)),c.uploadState.isPending?s.createElement("div",null,c.name):s.createElement("a",{href:ue()(c,"links.content",""),target:"_blank",rel:"noopener noreferrer",className:"mr-5 text-break"},c.name),s.createElement("br",null),c.checksum&&s.createElement("div",{className:"ui text-muted"},s.createElement("span",{style:{fontSize:"10px"}},c.checksum)," ",s.createElement(E.A,{content:g.M.t("This is the file fingerprint (MD5 checksum), which can be used to verify the file integrity."),trigger:s.createElement(w.A,{fitted:!0,name:"help circle",size:"small"}),position:"top center"})))),s.createElement(dn.A.Cell,{"data-label":g.M.t("Size"),width:2},c.size?(0,m.humanReadableBytes)(c.size,f):""),!l&&s.createElement(dn.A.Cell,{className:"file-upload-pending","data-label":g.M.t("Progress"),width:2},!(null!==(t=c.uploadState)&&void 0!==t&&t.isPending)&&s.createElement(pn.A,{className:"file-upload-progress primary",percent:c.progressPercentage,error:c.uploadState.isFailed,size:"medium",progress:!0,autoSuccess:!0,active:!0}),(null===(n=c.uploadState)||void 0===n?void 0:n.isPending)&&s.createElement("span",null,g.M.t("Pending"))),!l&&s.createElement(dn.A.Cell,{textAlign:"right",width:2},((null===(r=c.uploadState)||void 0===r?void 0:r.isFinished)||(null===(i=c.uploadState)||void 0===i?void 0:i.isFailed)||(null===(a=c.uploadState)||void 0===a?void 0:a.isPending))&&(S?s.createElement(w.A,{loading:!0,name:"spinner"}):s.createElement(w.A,{link:!0,className:"action primary",name:"trash alternate outline",disabled:S,onClick:function(){return D(c)},"aria-label":g.M.t("Delete file"),title:g.M.t("Delete file")})),(null===(o=c.uploadState)||void 0===o?void 0:o.isUploading)&&s.createElement(R.A,{compact:!0,type:"button",negative:!0,size:"tiny",disabled:y,onClick:function(){return function(e){A(!0),e.cancelUploadFn()}(c)}},y?s.createElement(w.A,{loading:!0,name:"spinner"}):g.M.t("Cancel"))))};vn.propTypes={filesLocked:p().bool,file:p().object,deleteFile:p().func.isRequired,defaultPreview:p().string,setDefaultPreview:p().func.isRequired,decimalSizeDisplay:p().bool,fileError:p().object},vn.defaultProps={filesLocked:!1,file:void 0,defaultPreview:void 0,decimalSizeDisplay:!1,fileError:void 0};var bn=function(e){var t=e.filesLocked,n=e.filesList,r=e.dragText,i=e.hasError,a=e.uploadButtonIcon,o=e.uploadButtonText,l=e.openFileDialog;return!t&&s.createElement(fn.A,{basic:!0,padded:"very",className:n.length?"file-upload-area":"file-upload-area no-files"},s.createElement(X.A,{columns:3,textAlign:"center"},s.createElement(X.A.Row,{verticalAlign:"middle"},s.createElement(X.A.Column,{mobile:16,tablet:7,computer:7},s.createElement(y.A,{size:"small"},r)),s.createElement(X.A.Column,{className:"mt-10 mb-10",mobile:16,tablet:2,computer:2},"- ",g.M.t("or")," -"),s.createElement(X.A.Column,{mobile:16,tablet:7,computer:7},s.createElement(R.A,{type:"button",className:i?"error":"primary",labelPosition:"left",icon:a,content:o,onClick:function(){return l()},disabled:null===l})))))};bn.propTypes={filesLocked:p().bool.isRequired,filesList:p().array,hasError:p().bool,dragText:p().string,uploadButtonIcon:p().node,uploadButtonText:p().string,openFileDialog:p().func},bn.defaultProps={filesList:void 0,dragText:void 0,uploadButtonIcon:void 0,uploadButtonText:void 0,openFileDialog:null,hasError:!1};var yn=function(e){var t=e.filesLocked,n=e.filesList,r=e.deleteFile,i=e.decimalSizeDisplay,a=(0,f.useFormikContext)(),o=a.errors,l=a.setFieldValue,c=a.values,u=ue()(c,"files.default_preview","");return s.createElement(dn.A,null,s.createElement(hn,{filesLocked:t}),s.createElement(dn.A.Body,null,n.map((function(e){return s.createElement(vn,{key:e.name,filesLocked:t,file:e,deleteFile:r,defaultPreview:u,setDefaultPreview:function(e){return l("files.default_preview",e)},decimalSizeDisplay:i,fileError:(0,f.getIn)(o,"files.entries."+e.name,void 0)})}))))};yn.propTypes={filesLocked:p().bool,filesList:p().array,deleteFile:p().func,decimalSizeDisplay:p().bool},yn.defaultProps={filesLocked:void 0,filesList:void 0,deleteFile:void 0,decimalSizeDisplay:void 0};var gn=function(e){function t(){return(0,i.A)(this,t),e=this,n=t,r=arguments,n=(0,l.A)(n),(0,o.A)(e,mn()?Reflect.construct(n,r||[],(0,l.A)(e).constructor):n.apply(e,r));var e,n,r}return(0,c.A)(t,e),(0,a.A)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.filesEnabled,i=t.dropzoneParams,a=t.filesList;return n?s.createElement(un.Ay,i,(function(t){var n=t.getRootProps,i=t.getInputProps,o=t.open;return s.createElement(X.A.Column,{width:16},s.createElement("span",n(),s.createElement("input",i()),0!==a.length&&s.createElement(X.A.Column,{verticalAlign:"middle"},s.createElement(yn,e.props)),s.createElement(bn,(0,r.A)({},e.props,{openFileDialog:o}))))})):s.createElement(X.A.Column,{width:16},s.createElement(fn.A,{basic:!0,padded:"very",className:"file-upload-area no-files"},s.createElement(X.A,{textAlign:"center"},s.createElement(X.A.Row,{verticalAlign:"middle"},s.createElement(X.A.Column,null,s.createElement(y.A,{size:"medium"},g.M.t("This is a Metadata-only record.")))))))}}])}(s.Component);gn.propTypes={deleteFile:p().func,dragText:p().string,dropzoneParams:p().object,filesEnabled:p().bool.isRequired,filesList:p().array,filesLocked:p().bool,links:p().object,setDefaultPreviewFile:p().func,uploadButtonIcon:p().string,uploadButtonText:p().string,decimalSizeDisplay:p().bool},gn.defaultProps={deleteFile:void 0,dragText:void 0,dropzoneParams:void 0,filesList:void 0,filesLocked:!1,links:void 0,setDefaultPreviewFile:void 0,uploadButtonIcon:void 0,uploadButtonText:void 0,decimalSizeDisplay:void 0};var An=function(e){var t=e.filesList,n=e.filesSize,r=e.filesEnabled,i=e.showMetadataOnlyToggle,a=e.quota,o=e.decimalSizeDisplay,l=(0,f.useFormikContext)().setFieldValue,c=function(){l("files.enabled",!r),l("access.files","public")};return s.createElement(O.default,{id:"ReactInvenioDeposit.FileUploaderToolbar.layout",filesList:t,filesSize:n,filesEnabled:r,showMetadataOnlyToggle:i,quota:a,decimalSizeDisplay:o,handleOnChangeMetadataOnly:c},s.createElement(s.Fragment,null,s.createElement(X.A.Column,{verticalAlign:"middle",floated:"left",mobile:16,tablet:6,computer:6},s.createElement(O.default,{id:"ReactInvenioDeposit.FileUploaderToolbar.MetadataOnlyToggle.container",filesList:t,filesEnabled:r,showMetadataOnlyToggle:i,handleOnChangeMetadataOnly:c},i&&s.createElement(T.A,{horizontal:!0},s.createElement(T.A.Item,null,s.createElement(q.A,{label:g.M.t("Metadata-only record"),onChange:c,disabled:t.length>0,checked:!r})),s.createElement(T.A.Item,null,s.createElement(E.A,{trigger:s.createElement(w.A,{name:"question circle outline",className:"neutral"}),content:g.M.t("Disable files for this record"),position:"top center"}))))),s.createElement(O.default,{id:"ReactInvenioDeposit.FileUploaderToolbar.FileList.container",filesList:t,filesSize:n,filesEnabled:r,quota:a,decimalSizeDisplay:o},r&&s.createElement(X.A.Column,{mobile:16,tablet:10,computer:10,className:"storage-col"},s.createElement(y.A,{size:"tiny",className:"mr-10"},g.M.t("Storage available")),s.createElement(T.A,{horizontal:!0,floated:"right"},s.createElement(T.A.Item,null,s.createElement(ze.A,t.length===a.maxFiles?{color:"blue"}:{},g.M.t("{{length}} out of {{maxfiles}} files",{length:t.length,maxfiles:a.maxFiles}))),s.createElement(T.A.Item,null,s.createElement(ze.A,(0,m.humanReadableBytes)(n,o)===(0,m.humanReadableBytes)(a.maxStorage,o)?{color:"blue"}:{},(0,m.humanReadableBytes)(n,o)," ",g.M.t("out of")," ",(0,m.humanReadableBytes)(a.maxStorage,o))))))))};An.propTypes={filesList:p().array,filesSize:p().oneOfType([p().number,p().string]),filesEnabled:p().bool.isRequired,quota:p().object,decimalSizeDisplay:p().bool,showMetadataOnlyToggle:p().bool},An.defaultProps={filesList:void 0,filesSize:void 0,quota:void 0,decimalSizeDisplay:!1,showMetadataOnlyToggle:!0};var En=["config","files","isDraftRecord","hasParentRecord","quota","permissions","record","uploadFiles","deleteFile","importParentFiles","importButtonIcon","importButtonText","isFileImportInProgress","decimalSizeDisplay","filesLocked","allowEmptyFiles"],wn=function(e){var t,n,i=e.config,a=e.files,o=e.isDraftRecord,l=e.hasParentRecord,c=e.quota,u=e.permissions,d=e.record,p=e.uploadFiles,h=e.deleteFile,v=e.importParentFiles,b=e.importButtonIcon,y=e.importButtonText,A=e.isFileImportInProgress,E=e.decimalSizeDisplay,C=e.filesLocked,P=e.allowEmptyFiles,S=(0,J.A)(e,En),k=(0,f.useFormikContext)(),D=k.values,I=k.errors,M=k.initialErrors,F=(I.files||(null===M||void 0===M?void 0:M.files))&&a,T=((null===(t=I.files)||void 0===t?void 0:t.enabled)||(null===M||void 0===M||null===(n=M.files)||void 0===n?void 0:n.enabled))&&a,q=ue()(D,"files.enabled",!1),_=(0,s.useState)(),j=(0,fe.A)(_,2),z=j[0],L=j[1],N=!o&&C,B=Object.values(a).map((function(e){return{name:e.name,size:e.size,checksum:e.checksum,links:e.links,uploadState:{isFailed:e.status===an.error,isUploading:e.status===an.uploading,isFinished:e.status===an.finished,isPending:e.status===an.pending},progressPercentage:e.progressPercentage,cancelUploadFn:e.cancelUploadFn}})),U=B.reduce((function(e,t){return e+t.size}),0),H={preventDropOnDocument:!0,onDropAccepted:function(e){var t=B.length+e.length>c.maxFiles,n=e.reduce((function(e,t){return e+t.size}),0),r=U+n>c.maxStorage,i=be()(B,"name"),a=new Set(i),o=e.reduce((function(e,t){return a.has(t.name)?e.duplicateFiles.push(t):0===t.size?e.emptyFiles.push(t):e.nonEmptyFiles.push(t),e}),{duplicateFiles:[],emptyFiles:[],nonEmptyFiles:[]}),l=o.duplicateFiles,u=o.emptyFiles,d=o.nonEmptyFiles,f=!x()(u),h=!x()(l);if(t)L(s.createElement("div",{className:"content"},s.createElement(V.A,{warning:!0,icon:"warning circle",header:g.M.t("Could not upload files."),content:g.M.t("Uploading the selected files would result in ".concat(B.length+e.length," files (max.").concat(c.maxFiles,")"))})));else if(r)L(s.createElement("div",{className:"content"},s.createElement(V.A,{warning:!0,icon:"warning circle",header:g.M.t("Could not upload files."),content:s.createElement(s.Fragment,null,g.M.t("Uploading the selected files would result in")," ",(0,m.humanReadableBytes)(U+n,E),g.M.t("but the limit is"),(0,m.humanReadableBytes)(c.maxStorage,E),".")})));else{var v=[];h&&v.push(s.createElement(V.A,{warning:!0,icon:"warning circle",header:g.M.t("The following files already exist"),list:be()(l,"name")})),!P&&f&&v.push(s.createElement(V.A,{warning:!0,icon:"warning circle",header:g.M.t("Could not upload all files."),content:g.M.t("Empty files were skipped."),list:be()(u,"name")})),x()(v)||L(s.createElement("div",{className:"content"},v));var b=P?[].concat((0,we.A)(d),(0,we.A)(u)):d;x()(b)||p(D,b)}},multiple:!0,noClick:!0,noKeyboard:!0,disabled:!1};B.length<c.maxFiles||(H.disabled=!0);var Y=q&&o&&l&&!B.length;return s.createElement(O.default,(0,r.A)({id:"ReactInvenioDeposit.FileUploader.layout",config:i,files:a,isDraftRecord:o,hasParentRecord:l,quota:c,permissions:u,record:d,uploadFiles:p,deleteFile:h,importParentFiles:v,importButtonIcon:b,importButtonText:y,isFileImportInProgress:A,decimalSizeDisplay:E,filesEnabled:q,filesList:B,displayImportBtn:Y,filesSize:U,dropzoneParams:H,warningMsg:z,setWarningMsg:L,filesLocked:N,hasError:F},S),s.createElement(s.Fragment,null,s.createElement(X.A,{className:"file-uploader"},s.createElement(X.A.Row,{className:"pt-10 pb-5"},!N&&s.createElement(An,(0,r.A)({},S,{config:i,filesEnabled:q,filesList:B,filesSize:U,quota:c,decimalSizeDisplay:E}))),s.createElement(O.default,(0,r.A)({id:"ReactInvenioDeposit.FileUploader.ImportButton.container",importButtonIcon:b,importButtonText:y,importParentFiles:v,isFileImportInProgress:A,displayImportBtn:Y},S),Y&&s.createElement(X.A.Row,{className:"pb-5 pt-5"},s.createElement(X.A.Column,{width:16},s.createElement(V.A,{visible:!0,info:!0},s.createElement("div",{className:"right-floated display-inline-block"},s.createElement(R.A,{type:"button",size:"mini",primary:!0,icon:b,content:y,onClick:function(){return v()},disabled:A,loading:A})),s.createElement("p",{className:"display-inline-block mt-5"},s.createElement(w.A,{name:"info circle"}),g.M.t("You can import files from the previous version.")))))),s.createElement(O.default,(0,r.A)({id:"ReactInvenioDeposit.FileUploader.FileUploaderArea.container",filesList:B,dropzoneParams:H,filesLocked:N,hasError:T,filesEnabled:q,deleteFile:h,decimalSizeDisplay:E},S),q&&s.createElement(X.A.Row,{className:"pt-0 pb-0"},s.createElement(gn,(0,r.A)({},S,{filesList:B,dropzoneParams:H,filesLocked:N,hasError:T,filesEnabled:q,deleteFile:h,decimalSizeDisplay:E})))),s.createElement(O.default,(0,r.A)({id:"ReactInvenioDeposit.FileUploader.NewVersionButton.container",isDraftRecord:o,draft:D,filesLocked:N,permissions:u,record:d},S),o?s.createElement(X.A.Row,{className:"file-upload-note pt-5"},s.createElement(X.A.Column,{width:16},s.createElement(V.A,{visible:!0,warning:!0},s.createElement("p",null,s.createElement(w.A,{name:"warning sign"}),g.M.t("File addition, removal or modification are not allowed after you have published your upload."))))):C&&s.createElement(X.A.Row,{className:"file-upload-note pt-5"},s.createElement(X.A.Column,{width:16},s.createElement(V.A,{info:!0},s.createElement(sn,{record:d,onError:function(){},className:"right-floated",disabled:!u.can_new_version}),s.createElement("p",{className:"mt-5 display-inline-block"},s.createElement(w.A,{name:"info circle",size:"large"}),g.M.t("You must create a new version to add, modify or delete files."))))))),s.createElement(O.default,(0,r.A)({id:"ReactInvenioDeposit.FileUploader.Modal.container",warningMsg:z,setWarningMsg:L},S),s.createElement(ye.A,{open:!!z,header:"Warning!",content:z,onClose:function(){return L()},closeIcon:!0}))))},Rn=p().objectOf(p().shape({name:p().string,size:p().number,progressPercentage:p().number,checksum:p().string,links:p().object,cancelUploadFn:p().func,state:p().oneOf(Object.values(an)),enabled:p().bool}));wn.propTypes={config:p().object,dragText:p().string,files:Rn,isDraftRecord:p().bool,hasParentRecord:p().bool,quota:p().shape({maxStorage:p().number,maxFiles:p().number}),record:p().object,uploadButtonIcon:p().string,uploadButtonText:p().string,importButtonIcon:p().string,importButtonText:p().string,isFileImportInProgress:p().bool,importParentFiles:p().func.isRequired,uploadFiles:p().func.isRequired,deleteFile:p().func.isRequired,decimalSizeDisplay:p().bool,filesLocked:p().bool,permissions:p().object,allowEmptyFiles:p().bool},wn.defaultProps={permissions:void 0,config:void 0,files:void 0,record:void 0,isFileImportInProgress:!1,dragText:g.M.t("Drag and drop files"),isDraftRecord:!0,hasParentRecord:!1,quota:{maxFiles:5,maxStorage:Math.pow(10,10)},uploadButtonIcon:"upload",uploadButtonText:g.M.t("Upload files"),importButtonIcon:"sync",importButtonText:g.M.t("Import files"),decimalSizeDisplay:!0,filesLocked:!1,allowEmptyFiles:!0};var Cn=(0,u.connect)((function(e){var t,n,r=e.files,i=r.links;return{files:r.entries,links:i,record:e.deposit.record,config:e.deposit.config,permissions:e.deposit.permissions,isFileImportInProgress:e.files.isFileImportInProgress,hasParentRecord:Boolean((null===(t=e.deposit.record)||void 0===t||null===(t=t.versions)||void 0===t?void 0:t.index)&&(null===(n=e.deposit.record)||void 0===n||null===(n=n.versions)||void 0===n?void 0:n.index)>1)}}),(function(e){return{uploadFiles:function(t,n){return e(function(e,t){return function(){var n=(0,it.A)(ot().mark((function n(r,i,a){var o,l,c,s,u;return ot().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,Qt(e,a.service.drafts);case 3:o=n.sent,r({type:st,payload:{data:o.data}}),l=o.data.links.files,c=Zt(t);try{for(c.s();!(s=c.n()).done;)u=s.value,a.service.files.upload(l,u)}catch(i){c.e(i)}finally{c.f()}n.next=15;break;case 10:throw n.prev=10,n.t0=n.catch(0),console.error("Error uploading files",n.t0,e,t),r({type:qt,payload:{errors:n.t0.errors}}),n.t0;case 15:case"end":return n.stop()}}),n,null,[[0,10]])})));return function(e,t,r){return n.apply(this,arguments)}}()}(t,n))},importParentFiles:function(){return e(function(){var e=(0,it.A)(ot().mark((function e(t,n,r){var i,a,o;return ot().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((i=n().deposit.record).id){e.next=3;break}return e.abrupt("return");case 3:return t({type:_t}),e.prev=4,a=i.links,e.next=8,r.service.files.importParentRecordFiles(a);case 8:o=e.sent,t({type:jt,payload:{files:o}}),e.next=17;break;case 12:throw e.prev=12,e.t0=e.catch(4),console.error("Error importing parent record files",e.t0),t({type:zt}),e.t0;case 17:case"end":return e.stop()}}),e,null,[[4,12]])})));return function(t,n,r){return e.apply(this,arguments)}}())},deleteFile:function(t){return e(function(e){return function(){var t=(0,it.A)(ot().mark((function t(n,r,i){var a,o;return ot().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,a=e.links,t.next=4,i.service.files.delete(a);case 4:n({type:Lt,payload:{filename:e.name}}),t.next=16;break;case 7:if(t.prev=7,t.t0=t.catch(0),404!==t.t0.response.status||null===(o=e.uploadState)||void 0===o||!o.isPending){t.next=13;break}n({type:Lt,payload:{filename:e.name}}),t.next=16;break;case 13:throw console.error("Error deleting file",t.t0,e),n({type:Nt}),t.t0;case 16:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e,n,r){return t.apply(this,arguments)}}()}(t))}}}))(wn),Pn={scheme:"",identifier:""};function Sn(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Sn=function(){return!!e})()}var kn=function(e){function t(){return(0,i.A)(this,t),e=this,n=t,r=arguments,n=(0,l.A)(n),(0,o.A)(e,Sn()?Reflect.construct(n,r||[],(0,l.A)(e).constructor):n.apply(e,r));var e,n,r}return(0,c.A)(t,e),(0,a.A)(t,[{key:"render",value:function(){var e=this.props,t=e.fieldPath,n=e.label,r=e.labelIcon,i=e.required,a=e.schemeOptions,o=e.showEmptyValue;return s.createElement(m.ArrayField,{addButtonLabel:g.M.t("Add identifier"),defaultNewValue:Pn,fieldPath:t,label:s.createElement(m.FieldLabel,{htmlFor:t,icon:r,label:n}),required:i,showEmptyValue:o},(function(e){var n=e.arrayHelpers,r=e.indexPath,i="".concat(t,".").concat(r);return s.createElement(m.GroupField,null,s.createElement(m.TextField,{fieldPath:"".concat(i,".identifier"),label:g.M.t("Identifier"),required:!0,width:11}),a&&s.createElement(m.SelectField,{fieldPath:"".concat(i,".scheme"),label:g.M.t("Scheme"),"aria-label":g.M.t("Scheme"),options:a,optimized:!0,required:!0,width:5}),!a&&s.createElement(m.TextField,{fieldPath:"".concat(i,".scheme"),label:g.M.t("Scheme"),"aria-label":g.M.t("Scheme"),required:!0,width:5}),s.createElement(v.A.Field,null,s.createElement(R.A,{"aria-label":g.M.t("Remove field"),className:"close-btn",icon:"close",onClick:function(){return n.remove(r)}})))}))}}])}(s.Component);kn.propTypes={fieldPath:p().string.isRequired,label:p().string,labelIcon:p().string,required:p().bool,schemeOptions:p().arrayOf(p().shape({text:p().string,value:p().string})),showEmptyValue:p().bool},kn.defaultProps={label:g.M.t("Identifiers"),labelIcon:"barcode",required:!1,schemeOptions:void 0,showEmptyValue:!1};var On=n(38221),Dn=n.n(On);function In(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(In=function(){return!!e})()}var Mn=function(e){function t(){return(0,i.A)(this,t),e=this,n=t,r=arguments,n=(0,l.A)(n),(0,o.A)(e,In()?Reflect.construct(n,r||[],(0,l.A)(e).constructor):n.apply(e,r));var e,n,r}return(0,c.A)(t,e),(0,a.A)(t,[{key:"render",value:function(){var e=this.props,t=e.disabled,n=e.handleReservePID,r=e.label,i=e.loading,a=e.fieldError;return s.createElement(f.Field,null,(function(e){var o=e.form;return s.createElement(v.A.Button,{className:"positive",size:"mini",loading:i,disabled:t||i,onClick:function(e){return n(e,o)},content:r,error:a})}))}}])}(s.Component);function Fn(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Fn=function(){return!!e})()}Mn.propTypes={disabled:p().bool,handleReservePID:p().func.isRequired,fieldError:p().object,label:p().string.isRequired,loading:p().bool},Mn.defaultProps={disabled:!1,loading:!1,fieldError:null};var xn=function(e){function t(){return(0,i.A)(this,t),e=this,n=t,r=arguments,n=(0,l.A)(n),(0,o.A)(e,Fn()?Reflect.construct(n,r||[],(0,l.A)(e).constructor):n.apply(e,r));var e,n,r}return(0,c.A)(t,e),(0,a.A)(t,[{key:"render",value:function(){var e=this.props,t=e.disabled,n=e.handleDiscardPID,r=e.label,i=e.loading;return s.createElement(E.A,{content:r,trigger:s.createElement(f.Field,null,(function(e){var r=e.form;return s.createElement(v.A.Button,{disabled:t||i,loading:i,icon:"close",onClick:function(e){return n(e,r)},size:"mini"})}))})}}])}(s.Component);xn.propTypes={disabled:p().bool,handleDiscardPID:p().func.isRequired,label:p().string.isRequired,loading:p().bool},xn.defaultProps={disabled:!1,loading:!1};var Tn=n(73591);function qn(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(qn=function(){return!!e})()}var _n=function(e){function t(){var e,n,r,a;(0,i.A)(this,t);for(var c=arguments.length,s=new Array(c),u=0;u<c;u++)s[u]=arguments[u];return n=this,r=t,a=[].concat(s),r=(0,l.A)(r),e=(0,o.A)(n,qn()?Reflect.construct(r,a||[],(0,l.A)(n).constructor):r.apply(n,a)),(0,A.A)(e,"handleChange",(function(t,n){var r=n.value;(0,e.props.onManagedUnmanagedChange)("managed"===r)})),e}return(0,c.A)(t,e),(0,a.A)(t,[{key:"render",value:function(){var e=this.props,t=e.disabled,n=e.isManagedSelected,r=e.pidLabel;return s.createElement(v.A.Group,{inline:!0},s.createElement(v.A.Field,null,g.M.t("Do you already have a {{pidLabel}} for this upload?",{pidLabel:r})),s.createElement(v.A.Field,{width:4},s.createElement(Tn.A,{label:g.M.t("Yes, I already have one"),"aria-label":g.M.t("Yes, I already have one"),name:"radioGroup",value:"unmanaged",disabled:t,checked:!n,onChange:this.handleChange})),s.createElement(v.A.Field,{width:3},s.createElement(Tn.A,{label:g.M.t("No, I need one"),"aria-label":g.M.t("No, I need one"),name:"radioGroup",value:"managed",disabled:t,checked:n,onChange:this.handleChange})))}}])}(s.Component);_n.propTypes={disabled:p().bool,isManagedSelected:p().bool.isRequired,onManagedUnmanagedChange:p().func.isRequired,pidLabel:p().string},_n.defaultProps={disabled:!1,pidLabel:void 0};var jn="SAVE",zn="PUBLISH",Ln="PUBLISH_WITHOUT_COMMUNITY",Nn="PREVIEW",Bn="DELETE",Un="RESERVE_PID",Vn="DISCARD_PID",Hn="SUBMIT_REVIEW",Yn=s.createContext({setSubmitContext:void 0}),Wn=function(e,t){return(0,f.getIn)(e.errors,t,null)||(0,f.getIn)(e.initialErrors,t,null)};function Gn(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Gn=function(){return!!e})()}var Qn=function(e){function t(){var e,n,r,a;(0,i.A)(this,t);for(var c=arguments.length,s=new Array(c),u=0;u<c;u++)s[u]=arguments[u];return n=this,r=t,a=[].concat(s),r=(0,l.A)(r),e=(0,o.A)(n,Gn()?Reflect.construct(r,a||[],(0,l.A)(n).constructor):r.apply(n,a)),(0,A.A)(e,"handleReservePID",(function(t,n){var r=e.props.pidType;(0,e.context.setSubmitContext)(Un,{pidType:r}),n.handleSubmit(t)})),(0,A.A)(e,"handleDiscardPID",(function(t,n){var r=e.props.pidType;(0,e.context.setSubmitContext)(Vn,{pidType:r}),n.handleSubmit(t)})),e}return(0,c.A)(t,e),(0,a.A)(t,[{key:"render",value:function(){var e=this.props,t=e.actionState,n=e.actionStateExtra,r=e.btnLabelDiscardPID,i=e.btnLabelGetPID,a=e.disabled,o=e.helpText,l=e.identifier,c=e.pidPlaceholder,u=e.pidType,d=e.form,p=e.fieldPath,f=""!==l,m=s.createElement(Mn,{disabled:a||f,label:i,loading:t===Ct&&n.pidType===u,handleReservePID:this.handleReservePID,fieldError:Wn(d,p)}),h=s.createElement(xn,{disabled:a,label:r,handleDiscardPID:this.handleDiscardPID,loading:t===kt&&n.pidType===u,pidType:u});return s.createElement(s.Fragment,null,s.createElement(v.A.Group,{inline:!0},f?s.createElement(v.A.Field,null,s.createElement("label",null,l)):s.createElement(v.A.Field,{width:4},s.createElement(v.A.Input,{disabled:!0,value:"",placeholder:c,width:16})),s.createElement(v.A.Field,null,l?h:m)),o&&s.createElement("label",{className:"helptext"},o))}}])}(s.Component);(0,A.A)(Qn,"contextType",Yn),Qn.propTypes={btnLabelGetPID:p().string.isRequired,disabled:p().bool,helpText:p().string,identifier:p().string.isRequired,btnLabelDiscardPID:p().string.isRequired,pidPlaceholder:p().string.isRequired,pidType:p().string.isRequired,form:p().object.isRequired,fieldPath:p().string.isRequired,actionState:p().string,actionStateExtra:p().object},Qn.defaultProps={disabled:!1,helpText:null,actionState:"",actionStateExtra:{}};var Kn=(0,u.connect)((function(e){return{actionState:e.deposit.actionState,actionStateExtra:e.deposit.actionStateExtra}}),null)(Qn);function Xn(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Xn=function(){return!!e})()}var $n,Jn=function(e){function t(e){var n,r,a,c;(0,i.A)(this,t),r=this,a=t,c=[e],a=(0,l.A)(a),n=(0,o.A)(r,Xn()?Reflect.construct(a,c||[],(0,l.A)(r).constructor):a.apply(r,c)),(0,A.A)(n,"handleIdentifierUpdate",(function(e){n.setState({localIdentifier:e})})),(0,A.A)(n,"onChange",(function(e){var t=n.props.onIdentifierChanged;n.setState({localIdentifier:e},(function(){return t(e)}))}));var s=e.identifier;return n.state={localIdentifier:s},n}return(0,c.A)(t,e),(0,a.A)(t,[{key:"componentDidUpdate",value:function(e){var t=this.props.identifier;t!==e.identifier&&this.handleIdentifierUpdate(t)}},{key:"render",value:function(){var e=this,t=this.state.localIdentifier,n=this.props,r=n.form,i=n.fieldPath,a=n.helpText,o=n.pidPlaceholder,l=n.disabled,c=Wn(r,i);return s.createElement(s.Fragment,null,s.createElement(v.A.Field,{width:8,error:c},s.createElement(v.A.Input,{onChange:function(t,n){var r=n.value;return e.onChange(r)},value:t,placeholder:o,width:16,error:c,disabled:l})),a&&s.createElement("label",{className:"helptext"},a))}}])}(s.Component);function Zn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function er(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Zn(Object(n),!0).forEach((function(t){(0,A.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Zn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}Jn.propTypes={form:p().object.isRequired,fieldPath:p().string.isRequired,helpText:p().string,identifier:p().string.isRequired,onIdentifierChanged:p().func.isRequired,pidPlaceholder:p().string.isRequired,disabled:p().bool},Jn.defaultProps={helpText:null,disabled:!1};var tr=(0,a.A)((function e(){(0,i.A)(this,e)}));function nr(e){return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:[]).includes(e.status)}function rr(e){var t,n,r,i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,o=nr(e,tr.allowsReviewDeletionStates),l=nr(e,tr.allowsReviewUpdateStates),c=nr(e,tr.disallowsSubmitForReviewStates),s=function(e,t){switch(t){case void 0:var n,r,i=null===(n=e.parent)||void 0===n||null===(n=n.review)||void 0===n||null===(n=n.receiver)||void 0===n?void 0:n.community,a=null===(r=e.parent)||void 0===r||null===(r=r.communities)||void 0===r?void 0:r.default;if(!i&&!a)return;return nr(e,[tr.PUBLISHED,tr.NEW_VERSION_DRAFT])?e.expanded.parent.communities.default:e.expanded.parent.review.receiver;case null:return null;default:return t}}(e,a),u=!x()(s),d=null===e||void 0===e||null===(t=e.parent)||void 0===t?void 0:t.review,p=nr(e,[tr.DRAFT_WITH_REVIEW])&&(null===d||void 0===d||null===(n=d.receiver)||void 0===n?void 0:n.community)===(null===s||void 0===s?void 0:s.id),f=nr(e,[tr.DECLINED,tr.EXPIRED])&&(null===d||void 0===d||null===(r=d.receiver)||void 0===r?void 0:r.community)===(null===s||void 0===s?void 0:s.id),m=!0===(null===s||void 0===s?void 0:s.is_ghost),h=u&&!m,v=nr(e,[tr.PUBLISHED,tr.NEW_VERSION_DRAFT])&&(x()(null===(i=e.parent)||void 0===i?void 0:i.communities)||!h),b=u&&!nr(e,[tr.PUBLISHED,tr.NEW_VERSION_DRAFT])&&s.ui.permissions.can_include_directly,y=u&&!f&&!nr(e,[tr.PUBLISHED,tr.NEW_VERSION_DRAFT]),g=!nr(e,[tr.PUBLISHED,tr.NEW_VERSION_DRAFT]),A=u&&l&&!p&&!f,E=!u&&o;return{selectedCommunity:s,ui:{showSubmitForReviewButton:y,showDirectPublishButton:b,disableSubmitForReviewButton:y&&c,showChangeCommunityButton:f,showCommunitySelectionButton:g,showCommunityHeader:!v,disableCommunitySelectionButton:g&&(f||c&&!v)},actions:{shouldUpdateReview:A,shouldDeleteReview:E,communityStateMustBeChecked:A||E}}}$n=tr,(0,A.A)(tr,"DRAFT","draft"),(0,A.A)(tr,"NEW_VERSION_DRAFT","new_version_draft"),(0,A.A)(tr,"DRAFT_WITH_REVIEW","draft_with_review"),(0,A.A)(tr,"IN_REVIEW","in_review"),(0,A.A)(tr,"DECLINED","declined"),(0,A.A)(tr,"EXPIRED","expired"),(0,A.A)(tr,"PUBLISHED","published"),(0,A.A)(tr,"allowsReviewDeletionStates",[$n.DRAFT_WITH_REVIEW,$n.DECLINED,$n.EXPIRED]),(0,A.A)(tr,"allowsReviewUpdateStates",[$n.DRAFT_WITH_REVIEW,$n.DECLINED,$n.EXPIRED,$n.DRAFT]),(0,A.A)(tr,"disallowsSubmitForReviewStates",[$n.PUBLISHED,$n.IN_REVIEW,$n.NEW_VERSION_DRAFT]);const ir=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case dt:case mt:case gt:case bt:return er(er({},e),{},{actionState:t.type});case Et:return er(er({},e),{},{actionState:t.type,actionStateExtra:{reviewComment:t.payload.reviewComment,directPublish:t.payload.directPublish}});case Ct:case kt:return er(er({},e),{},{actionState:t.type,actionStateExtra:{pidType:t.payload.pidType}});case Pt:case Ot:return er(er({},e),{},{record:er(er({},e.record),t.payload.data),editorState:rr(t.payload.data,e.editorState.selectedCommunity),errors:{},actionState:t.type,actionStateExtra:{}});case st:case pt:return er(er({},e),{},{record:er({},t.payload.data),editorState:rr(t.payload.data,e.editorState.selectedCommunity),errors:{},actionState:t.type,actionStateExtra:{}});case ut:case vt:case Rt:return er(er({},e),{},{record:er(er({},e.record),t.payload.data),editorState:rr(t.payload.data,e.editorState.selectedCommunity),errors:er({},t.payload.errors),actionState:t.type});case ft:case ht:case At:case yt:case St:case Dt:case wt:return er(er({},e),{},{errors:er({},t.payload.errors),actionState:t.type,actionStateExtra:{}});case Vt:var n,r=er({},e.record),i="restricted"===(null===(n=t.payload)||void 0===n||null===(n=n.community)||void 0===n||null===(n=n.access)||void 0===n?void 0:n.visibility);return"public"===r.access.record&&i&&(r=er(er({},e.record),{},{access:{files:"restricted",record:"restricted"}})),er(er({},e),{},{record:r,editorState:rr(r,t.payload.community)});case It:return er(er({},e),{},{noINeedDOI:t.payload.noINeedDOI});default:return e}};function ar(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(ar=function(){return!!e})()}var or=function(e){function t(){var e,n,r,a;(0,i.A)(this,t);for(var c=arguments.length,u=new Array(c),d=0;d<c;d++)u[d]=arguments[d];return n=this,r=t,a=[].concat(u),r=(0,l.A)(r),e=(0,o.A)(n,ar()?Reflect.construct(r,a||[],(0,l.A)(n).constructor):r.apply(n,a)),(0,A.A)(e,"handleChange",(function(t,n){var r=n.value;(0,e.props.onManagedUnmanagedChange)("managed"===r,"notneeded"===r)})),(0,A.A)(e,"_render",(function(e,t,n){return t&&n?s.createElement(E.A,{content:n,trigger:e}):e})),e}return(0,c.A)(t,e),(0,a.A)(t,[{key:"render",value:function(){var e,t,n=this.props,r=n.isManagedSelected,i=n.isNoNeedSelected,a=n.pidLabel,o=n.optionalDOItransitions,l=n.record,c=(null===l||void 0===l||null===(e=l.pids)||void 0===e||null===(e=e.doi)||void 0===e?void 0:e.identifier)||"",u=[tr.PUBLISHED,tr.NEW_VERSION_DRAFT].includes(l.status),d=""!==c,p=u?!o.allowed_providers.includes("external"):d&&r,f=u?!o.allowed_providers.includes("not_needed"):d&&r,m=null===o||void 0===o||null===(t=o.allowed_providers)||void 0===t?void 0:t.some((function(e){return!["external","not_needed"].includes(e)})),h=u?!m:d&&r,b=s.createElement(v.A.Field,{width:4},s.createElement(Tn.A,{label:g.M.t("Yes, I already have one"),"aria-label":g.M.t("Yes, I already have one"),name:"radioGroup",value:"unmanaged",disabled:p,checked:!r&&!i,onChange:this.handleChange})),y=s.createElement(v.A.Field,{width:3},s.createElement(Tn.A,{label:g.M.t("No, I need one"),"aria-label":g.M.t("No, I need one"),name:"radioGroup",value:"managed",disabled:h,checked:r&&!i,onChange:this.handleChange})),A=s.createElement(v.A.Field,{width:4},s.createElement(Tn.A,{label:g.M.t("No, I don't need one"),"aria-label":g.M.t("No, I don't need one"),name:"radioGroup",value:"notneeded",disabled:f,checked:i,onChange:this.handleChange}));return s.createElement(v.A.Group,{inline:!0},s.createElement(v.A.Field,null,g.M.t("Do you already have a {{pidLabel}} for this upload?",{pidLabel:a})),this._render(b,p,null===o||void 0===o?void 0:o.message),this._render(y,h,null===o||void 0===o?void 0:o.message),this._render(A,f,null===o||void 0===o?void 0:o.message))}}])}(s.Component);or.propTypes={isManagedSelected:p().bool.isRequired,isNoNeedSelected:p().bool.isRequired,onManagedUnmanagedChange:p().func.isRequired,pidLabel:p().string,optionalDOItransitions:p().array.isRequired,record:p().object.isRequired},or.defaultProps={pidLabel:void 0};var lr=(0,u.connect)((function(e){return{record:e.deposit.record}}),null)(or);function cr(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(cr=function(){return!!e})()}var sr="external",ur=function(e){function t(e){var n,r,a,c;(0,i.A)(this,t),r=this,a=t,c=[e],a=(0,l.A)(a),n=(0,o.A)(r,cr()?Reflect.construct(a,c||[],(0,l.A)(r).constructor):a.apply(r,c)),(0,A.A)(n,"onExternalIdentifierChanged",(function(e){var t=n.props,r=t.form,i=t.fieldPath,a={identifier:e,provider:sr};n.debounced&&n.debounced.cancel(),n.debounced=Dn()((function(){r.setFieldValue(i,a)}),200),n.debounced()}));var s=n.props,u=s.canBeManaged,d=s.canBeUnmanaged,p=s.record,f=s.field;n.canBeManagedAndUnmanaged=u&&d;var m=null===f||void 0===f?void 0:f.value,h=(null===m||void 0===m?void 0:m.provider)!==sr,v=!0===(null===p||void 0===p?void 0:p.is_draft),b=null===m||void 0===m?void 0:m.identifier,y=!!(v&&b&&h)||void 0;return n.state={isManagedSelected:y},n}return(0,c.A)(t,e),(0,a.A)(t,[{key:"render",value:function(){var e,t,n=this,r=this.state.isManagedSelected,i=this.props,a=i.btnLabelDiscardPID,o=i.btnLabelGetPID,l=i.canBeManaged,c=i.canBeUnmanaged,u=i.form,d=i.fieldPath,p=i.fieldLabel,f=i.isEditingPublishedRecord,h=i.managedHelpText,b=i.pidLabel,y=i.pidIcon,g=i.pidPlaceholder,A=i.required,E=i.unmanagedHelpText,w=i.pidType,R=i.field,C=i.record,P=this.props.doiDefaultSelection,S=R.value||{},k=S.identifier||"",O=S.provider||"",D="",I="";if(""!==k){var M=O===sr;D=M?"":k,I=M?k:""}var F=""!==D,x=""!==((null===C||void 0===C||null===(e=C.pids)||void 0===e||null===(e=e.doi)||void 0===e?void 0:e.identifier)||""),T=""!==((null===(t=C.parent)||void 0===t||null===(t=t.pids)||void 0===t||null===(t=t.doi)||void 0===t?void 0:t.identifier)||""),q=""!==k,_=void 0===r?F||""===k&&"no"===P:r,j=Wn(u,d);return s.createElement(s.Fragment,null,s.createElement(v.A.Field,{required:A||T,error:!!j},s.createElement(m.FieldLabel,{htmlFor:d,icon:y,label:p})),this.canBeManagedAndUnmanaged&&s.createElement(_n,{disabled:(f||F)&&(x||q),isManagedSelected:_,onManagedUnmanagedChange:function(e){e?u.setFieldValue("pids",{}):n.onExternalIdentifierChanged(""),u.setFieldError(d,!1),n.setState({isManagedSelected:e})},pidLabel:b}),l&&_&&s.createElement(Kn,{disabled:x&&f,btnLabelDiscardPID:a,btnLabelGetPID:o,form:u,fieldPath:d,identifier:D,helpText:h,pidPlaceholder:g,pidType:w,pidLabel:b}),c&&!_&&s.createElement(Jn,{identifier:I,onIdentifierChanged:function(e){n.onExternalIdentifierChanged(e)},form:u,fieldPath:d,pidPlaceholder:g,helpText:E}))}}])}(s.Component);function dr(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(dr=function(){return!!e})()}ur.propTypes={field:p().object,form:p().object.isRequired,btnLabelDiscardPID:p().string.isRequired,btnLabelGetPID:p().string.isRequired,canBeManaged:p().bool.isRequired,canBeUnmanaged:p().bool.isRequired,fieldPath:p().string.isRequired,fieldLabel:p().string.isRequired,isEditingPublishedRecord:p().bool.isRequired,managedHelpText:p().string,pidIcon:p().string.isRequired,pidLabel:p().string.isRequired,pidPlaceholder:p().string.isRequired,pidType:p().string.isRequired,required:p().bool.isRequired,unmanagedHelpText:p().string,record:p().object.isRequired,doiDefaultSelection:p().object.isRequired},ur.defaultProps={managedHelpText:null,unmanagedHelpText:null,field:void 0};var pr="external",fr=function(e){function t(e){var n,r,a,c;(0,i.A)(this,t),r=this,a=t,c=[e],a=(0,l.A)(a),n=(0,o.A)(r,dr()?Reflect.construct(a,c||[],(0,l.A)(r).constructor):a.apply(r,c)),(0,A.A)(n,"onExternalIdentifierChanged",(function(e){var t=n.props,r=t.form,i=t.fieldPath,a={identifier:e,provider:pr};n.debounced&&n.debounced.cancel(),n.debounced=Dn()((function(){r.setFieldValue(i,a)}),200),n.debounced()}));var s=n.props,u=s.canBeManaged,d=s.canBeUnmanaged,p=s.record,f=s.field;n.canBeManagedAndUnmanaged=u&&d;var m=null===f||void 0===f?void 0:f.value,h=(null===m||void 0===m?void 0:m.provider)!==pr,v=!0===(null===p||void 0===p?void 0:p.is_draft),b=null===m||void 0===m?void 0:m.identifier,y=!!(v&&b&&h)||void 0;return n.state={isManagedSelected:y,isNoNeedSelected:void 0},n}return(0,c.A)(t,e),(0,a.A)(t,[{key:"render",value:function(){var e,t,n=this,r=this.state,i=r.isManagedSelected,a=r.isNoNeedSelected,o=this.props,l=o.btnLabelDiscardPID,c=o.btnLabelGetPID,u=o.canBeManaged,d=o.canBeUnmanaged,p=o.form,f=o.fieldPath,h=o.fieldLabel,b=o.isEditingPublishedRecord,y=o.managedHelpText,g=o.pidLabel,A=o.pidIcon,E=o.pidPlaceholder,w=o.required,R=o.unmanagedHelpText,C=o.pidType,P=o.field,S=o.record,k=o.optionalDOItransitions,O=o.setNoINeedDOI,D=this.props.doiDefaultSelection,I=P.value||{},M=I.identifier||"",F=I.provider||"",x="",T="";if(""!==M){var q=F===pr;x=q?"":M,T=q?M:""}var _=""!==x,j=""!==T,z=""!==((null===S||void 0===S||null===(e=S.pids)||void 0===e||null===(e=e.doi)||void 0===e?void 0:e.identifier)||""),L=""!==((null===(t=S.parent)||void 0===t||null===(t=t.pids)||void 0===t||null===(t=t.doi)||void 0===t?void 0:t.identifier)||""),N=S.is_draft,B=void 0===i?_||""===M&&"no"===D:i,U=void 0===a?!B&&!(void 0===i?j||""===M&&"yes"===D:!i)||!0!==N&&""===M&&"not_needed"===D:a,V=Wn(p,f);return s.createElement(s.Fragment,null,s.createElement(v.A.Field,{required:w||L,error:!!V},s.createElement(X.A,null,s.createElement(X.A.Column,{width:5},s.createElement(m.FieldLabel,{htmlFor:f,icon:A,label:h})),V&&s.createElement(X.A.Column,{width:11},s.createElement(m.FeedbackLabel,{errorMessage:V})))),this.canBeManagedAndUnmanaged&&s.createElement(lr,{optionalDOItransitions:k,isManagedSelected:B,isNoNeedSelected:U,onManagedUnmanagedChange:function(e,t){e?(p.setFieldValue("pids",{}),w||O(!0)):t?(p.setFieldValue("pids",{}),O(!1)):(n.onExternalIdentifierChanged(""),O(!1)),p.setFieldError(f,!1),n.setState({isManagedSelected:e,isNoNeedSelected:t})},pidLabel:g,required:w}),u&&B&&s.createElement(Kn,{disabled:z&&b,btnLabelDiscardPID:l,btnLabelGetPID:c,form:p,fieldPath:f,identifier:x,helpText:y,pidPlaceholder:E,pidType:C,pidLabel:g}),d&&(!B||U)&&s.createElement(Jn,{identifier:T,onIdentifierChanged:function(e){n.onExternalIdentifierChanged(e)},form:p,fieldPath:f,pidPlaceholder:E,helpText:R,disabled:U}))}}])}(s.Component);fr.propTypes={field:p().object,form:p().object.isRequired,btnLabelDiscardPID:p().string.isRequired,btnLabelGetPID:p().string.isRequired,canBeManaged:p().bool.isRequired,canBeUnmanaged:p().bool.isRequired,fieldPath:p().string.isRequired,fieldLabel:p().string.isRequired,isEditingPublishedRecord:p().bool.isRequired,managedHelpText:p().string,pidIcon:p().string.isRequired,pidLabel:p().string.isRequired,pidPlaceholder:p().string.isRequired,pidType:p().string.isRequired,required:p().bool.isRequired,unmanagedHelpText:p().string,record:p().object.isRequired,doiDefaultSelection:p().object.isRequired,optionalDOItransitions:p().array.isRequired,setNoINeedDOI:p().func.isRequired},fr.defaultProps={managedHelpText:null,unmanagedHelpText:null,field:void 0};var mr=(0,u.connect)(null,(function(e){return{setNoINeedDOI:function(t){return e({type:It,payload:{noINeedDOI:t}})}}}))(fr);function hr(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(hr=function(){return!!e})()}var vr=function(e){function t(e){var n,r,a,c;return(0,i.A)(this,t),r=this,a=t,c=[e],a=(0,l.A)(a),n=(0,o.A)(r,hr()?Reflect.construct(a,c||[],(0,l.A)(r).constructor):a.apply(r,c)),(0,A.A)(n,"validatePropValues",(function(){var e=n.props,t=e.canBeManaged,r=e.canBeUnmanaged,i=e.fieldPath;if(!t&&!r)throw Error("".concat(i," must be managed, unmanaged or both."))})),n.validatePropValues(),n}return(0,c.A)(t,e),(0,a.A)(t,[{key:"render",value:function(){var e=this.props,t=e.fieldPath,n=e.required?ur:mr;return s.createElement(f.FastField,(0,r.A)({name:t,component:n},this.props))}}])}(s.Component);vr.propTypes={btnLabelDiscardPID:p().string,btnLabelGetPID:p().string,canBeManaged:p().bool,canBeUnmanaged:p().bool,fieldPath:p().string.isRequired,fieldLabel:p().string.isRequired,isEditingPublishedRecord:p().bool.isRequired,managedHelpText:p().string,pidIcon:p().string,pidLabel:p().string.isRequired,pidPlaceholder:p().string,pidType:p().string.isRequired,required:p().bool,unmanagedHelpText:p().string,record:p().object.isRequired,doiDefaultSelection:p().object.isRequired,optionalDOItransitions:p().array.isRequired},vr.defaultProps={btnLabelDiscardPID:"Discard",btnLabelGetPID:"Reserve",canBeManaged:!0,canBeUnmanaged:!0,managedHelpText:null,pidIcon:"barcode",pidPlaceholder:"",required:!1,unmanagedHelpText:null};var br=n(98871),yr=n(73083),gr=n(27089),Ar=function(e){var t=e.updateQueryFilters,n=e.userSelectionFilters,r=e.filterValue,i=e.label,a=e.title,o=function(){t(n.concat([r]))},l=function(e){var t=e.filter((function(e){return e[1]===r[1]})).length>0;return t}(n);return l?s.createElement(yr.A.Item,{name:i,active:!0,as:R.A,primary:!0,onClick:o},a):s.createElement(yr.A.Item,{name:i,onClick:o},a)};Ar.propTypes={updateQueryFilters:p().func.isRequired,userSelectionFilters:p().array.isRequired,filterValue:p().array.isRequired,label:p().string.isRequired,title:p().string.isRequired};var Er=n(23848),wr=(0,br.Q2)((function(e){var t=e.currentResultsState,n=e.serializeLicenses,i=n||function(e){return{title:e.title_l10n,description:e.description_l10n,id:e.id}};return s.createElement(f.FastField,{name:"selectedLicense"},(function(e){var n=e.form,a=n.values,o=n.setFieldValue;return s.createElement(Er.A.Group,null,t.data.hits.map((function(e){var t=e.title_l10n,n=e.description_l10n;return s.createElement(Er.A,{key:t,onClick:function(){return o("selectedLicense",i(e))},className:"license-item mb-15"},s.createElement(Tn.A,(0,r.A)({checked:ue()(a,"selectedLicense.title")===t,onChange:function(){return o("selectedLicense",i(e))}},!n&&{className:"mt-0"})),s.createElement(Er.A.Content,{className:"license-item-content"},s.createElement(y.A,{size:"small",className:"mt-0"},t),n&&s.createElement(Er.A.Description,{className:"license-item-description"},n)))})))}))})),Rr=n(92257);function Cr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Pr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Cr(Object(n),!0).forEach((function(t){(0,A.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Cr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Sr(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Sr=function(){return!!e})()}var kr=function(e){var t=e.updateQueryState,n=e.currentQueryState,r=e.autofocus,i=e.actionProps,a=e.placeholder,o=(0,s.useState)(""),l=(0,fe.A)(o,2),c=l[0],u=l[1],d=function(){n.filters[0]=["tags","all"],n.queryString=c,t(n)};return s.createElement(Or,{actionProps:i,autofocus:r,executeSearch:d,onBtnSearchClick:d,onInputChange:function(e){u(e)},onKeyPress:function(e){"Enter"===e.key&&d()},placeholder:a,queryString:c})};kr.propTypes={actionProps:p().object,autofocus:p().bool,currentQueryState:p().object,updateQueryState:p().func,placeholder:p().string},kr.defaultProps={actionProps:null,autofocus:!1,placeholder:"",currentQueryState:null,updateQueryState:null};var Or=function(e){function t(){return(0,i.A)(this,t),e=this,n=t,r=arguments,n=(0,l.A)(n),(0,o.A)(e,Sr()?Reflect.construct(n,r||[],(0,l.A)(e).constructor):n.apply(e,r));var e,n,r}return(0,c.A)(t,e),(0,a.A)(t,[{key:"componentDidMount",value:function(){this.props.autofocus&&this.focusInput&&this.focusInput.focus()}},{key:"render",value:function(){var e=this,t=this.props,n=t.actionProps,r=t.onBtnSearchClick,i=t.onInputChange,a=t.onKeyPress,o=t.placeholder,l=t.queryString;return s.createElement(Rr.A,{action:Pr({content:"Search",onClick:r},n),fluid:!0,placeholder:o||"Type something",onChange:function(e,t){var n=t.value;i(n)},value:l,onKeyPress:a,ref:function(t){e.focusInput=t}})}}])}(s.Component);Or.propTypes={actionProps:p().object,autofocus:p().bool,onBtnSearchClick:p().func,onInputChange:p().func,onKeyPress:p().func,placeholder:p().string,queryString:p().string},Or.defaultProps={actionProps:null,autofocus:!1,onBtnSearchClick:null,onInputChange:null,onKeyPress:null,placeholder:"",queryString:""};var Dr=(0,br.Q2)(kr);function Ir(e){var t=e.switchToCustom;return s.createElement(fn.A,{basic:!0,content:s.createElement("p",null,g.M.t("Did not find your license? "),s.createElement("a",{href:"/",onClick:function(e){e.preventDefault(),t()}},g.M.t("Add a custom license.")))})}function Mr(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Mr=function(){return!!e})()}Ir.propTypes={switchToCustom:p().func.isRequired};var Fr={"SearchFilters.Toggle":Ar},xr="standard",Tr="custom",qr="add",_r=ge.Ik().shape({selectedLicense:ge.Ik().shape({title:ge.Yj().required(g.M.t("Title is a required field.")),link:ge.Yj().url(g.M.t("Link must be a valid URL"))})}),jr=function(e){function t(){var e,n,r,a;(0,i.A)(this,t);for(var c=arguments.length,s=new Array(c),u=0;u<c;u++)s[u]=arguments[u];return n=this,r=t,a=[].concat(s),r=(0,l.A)(r),e=(0,o.A)(n,Mr()?Reflect.construct(r,a||[],(0,l.A)(n).constructor):r.apply(n,a)),(0,A.A)(e,"state",{open:!1,mode:xr}),(0,A.A)(e,"openModal",(function(){e.setState({open:!0})})),(0,A.A)(e,"closeModal",(function(){e.setState({open:!1})})),(0,A.A)(e,"setMode",(function(t){e.setState({mode:t})})),(0,A.A)(e,"onSubmit",(function(t,n){var r=e.props.onLicenseChange;e.closeModal(),e.setMode(e.mode),r(t.selectedLicense),n.resetForm()})),e}return(0,c.A)(t,e),(0,a.A)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.mode,r=t.trigger,i=t.action,a=t.searchConfig,o=t.serializeLicenses,l=t.initialLicense,c=this.state.open,u=this.state.mode,d=l||{title:"",description:"",id:null,link:""},p=new br.HZ(a.searchApi);return s.createElement(f.Formik,{initialValues:{selectedLicense:d},onSubmit:this.onSubmit,validationSchema:_r,validateOnChange:!1,validateOnBlur:!1},(function(t){var l=t.handleSubmit,d=t.resetForm;return s.createElement(ye.A,{role:"dialog",centered:!1,onOpen:function(){e.openModal(),e.setMode(n)},open:c,trigger:s.cloneElement(r,{"aria-expanded":c,"aria-haspopup":"dialog"}),onClose:function(){d(),e.setMode(xr),e.closeModal()},closeIcon:!0,closeOnDimmerClick:!1},s.createElement(ye.A.Header,{as:"h2",className:"pt-10 pb-10"},i===qr?g.M.t("Add {{mode}} license",{mode:u}):g.M.t("Change {{mode}} license",{mode:u})),s.createElement(ye.A.Content,null,u===xr&&s.createElement(O.OverridableContext.Provider,{value:Fr},s.createElement(br.gz,{searchApi:p,appName:"licenses",urlHandlerApi:{enabled:!1},initialQueryState:a.initialQueryState},s.createElement(X.A,null,s.createElement(X.A.Row,null,s.createElement(X.A.Column,{width:8,floated:"left",verticalAlign:"middle"},s.createElement(Dr,{placeholder:g.M.t("Search for licenses"),autofocus:!0,actionProps:{icon:"search",content:null,className:"search"}})),s.createElement(X.A.Column,{width:8,textAlign:"right",floated:"right"},s.createElement(yr.A,{compact:!0},s.createElement(br.lM,{title:g.M.t("Recommended"),label:g.M.t("recommended"),filterValue:["tags","recommended"]}),s.createElement(br.lM,{title:g.M.t("All"),label:g.M.t("all"),filterValue:["tags","all"]}),s.createElement(br.lM,{title:g.M.t("Data"),label:g.M.t("data"),filterValue:["tags","data"]}),s.createElement(br.lM,{title:g.M.t("Software"),label:g.M.t("software"),filterValue:["tags","software"]})))),s.createElement(X.A.Row,{verticalAlign:"middle"},s.createElement(X.A.Column,{width:16,className:"pb-0"},s.createElement(br.oK,null,s.createElement(br.i6,null),s.createElement(br.$D,null),s.createElement(wr,o&&{serializeLicenses:o})),s.createElement(gr.A,{textAlign:"center",className:"rel-mb-1"},s.createElement(br.dK,null))),s.createElement(X.A.Column,{width:16,textAlign:"center",className:"pt-0 pb-0"},s.createElement(Ir,{switchToCustom:function(){d(),e.setMode(Tr)}})))))),u===Tr&&s.createElement(v.A,null,s.createElement(m.TextField,{label:g.M.t("Title"),placeholder:g.M.t("License title"),fieldPath:"selectedLicense.title",required:!0,autoFocus:!0}),s.createElement(m.TextAreaField,{fieldPath:"selectedLicense.description",label:g.M.t("Description")}),s.createElement(m.TextField,{label:g.M.t("Link"),placeholder:g.M.t("License link"),fieldPath:"selectedLicense.link"}))),s.createElement(ye.A.Actions,null,s.createElement(R.A,{name:"cancel",onClick:function(){d(),e.setMode(n),e.closeModal()},icon:"remove",content:g.M.t("Cancel"),floated:"left"}),s.createElement(R.A,{name:"submit",onClick:function(e){return l(e)},primary:!0,icon:"checkmark",content:i===qr?g.M.t("Add license"):g.M.t("Change license")})))}))}}])}(s.Component);jr.propTypes={mode:p().oneOf(["standard","custom"]).isRequired,action:p().oneOf(["add","edit"]).isRequired,initialLicense:p().shape({id:p().string,title:p().string,description:p().string}),trigger:p().object.isRequired,onLicenseChange:p().func.isRequired,searchConfig:p().shape({searchApi:p().shape({axios:p().shape({headers:p().object})}).isRequired,initialQueryState:p().shape({filters:p().arrayOf(p().array)}).isRequired}).isRequired,serializeLicenses:p().func},jr.defaultProps={initialLicense:void 0,serializeLicenses:void 0};var zr=n(92516),Lr=n.n(zr),Nr=function(e){var t=e.license,n=e.moveLicense,r=e.replaceLicense,i=e.removeLicense,a=e.searchConfig,o=e.serializeLicenses,l=s.useRef(null),c=(0,_e.i)({item:{index:t.index,type:"license"}}),u=(0,fe.A)(c,3),d=u[1],p=u[2],f=(0,je.H)({accept:"license",hover:function(e,r){if(l.current){var i=e.index,a=t.index;i!==a&&r.isOver({shallow:!0})&&(n(i,a),e.index=a)}},collect:function(e){return{hidden:e.isOver({shallow:!0})}}}),m=(0,fe.A)(f,2),h=m[0].hidden;return(0,m[1])(l),s.createElement(Le.o,{innerRef:l,key:t.key},s.createElement(T.A.Item,{key:t.key,className:h?"deposit-drag-listitem hidden":"deposit-drag-listitem"},s.createElement(T.A.Content,{floated:"right"},s.createElement(jr,{searchConfig:a,onLicenseChange:function(e){r(t.index,e)},mode:t.type,initialLicense:t.initial,action:"edit",trigger:s.createElement(R.A,{size:"mini",primary:!0,type:"button"},g.M.t("Edit")),serializeLicenses:o}),s.createElement(R.A,{size:"mini",type:"button",onClick:function(){i(t.index)}},g.M.t("Remove"))),s.createElement(Le.o,{innerRef:d},s.createElement(T.A.Icon,{name:"bars",className:"drag-anchor"})),s.createElement(Le.o,{innerRef:p},s.createElement(T.A.Content,null,s.createElement(T.A.Header,null,t.title),t.description&&s.createElement(T.A.Description,null,Lr()(t.description,{length:300})),t.link&&s.createElement("span",null,s.createElement("a",{href:t.link,target:"_blank",rel:"noopener noreferrer"},t.description&&s.createElement("span",null,"\xa0"),g.M.t("Read more")))))))};function Br(e,t,n){return t=(0,l.A)(t),(0,o.A)(e,Ur()?Reflect.construct(t,n||[],(0,l.A)(e).constructor):t.apply(e,n))}function Ur(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Ur=function(){return!!e})()}Nr.propTypes={license:p().object.isRequired,moveLicense:p().func.isRequired,replaceLicense:p().func.isRequired,removeLicense:p().func.isRequired,searchConfig:p().object.isRequired,serializeLicenses:p().func},Nr.defaultProps={serializeLicenses:void 0};var Vr=(0,a.A)((function e(t,n,r){(0,i.A)(this,e),this.index=r,this.type=n.id?"standard":"custom",this.key=n.id||n.title,this.initial="custom"===this.type?n:null;var a=he()(t,n.id?function(e){return e.id===n.id}:function(e){return e.title===n.title})||{};this.description=a.description_l10n||n.description||"",this.title=a.title_l10n||n.title||"",this.link=a.props&&a.props.url||a.link||n.props&&n.props.url||n.link||""})),Hr=function(e){function t(){return(0,i.A)(this,t),Br(this,t,arguments)}return(0,c.A)(t,e),(0,a.A)(t,[{key:"render",value:function(){var e=this.props,t=e.label,n=e.labelIcon,r=e.fieldPath,i=e.uiFieldPath,a=e.form,o=a.values,l=a.errors,c=a.initialErrors,u=a.initialValues,d=e.move,p=e.push,h=e.remove,b=e.replace,y=e.required,A=e.searchConfig,E=e.serializeLicenses,C=(0,f.getIn)(o,i,[]),P=(0,f.getIn)(o,r,[]),S=(0,f.getIn)(u,r,[]),k=(0,f.getIn)(l,r,null),O=(0,f.getIn)(c,r,null),D=k||P===S&&O,I="";return D&&(I="string"!==typeof D?D.severity:"error"),s.createElement(pe.Q,{backend:de.t2},s.createElement(v.A.Field,{required:y,className:I},s.createElement(m.FieldLabel,{htmlFor:r,icon:n,label:t}),s.createElement(T.A,null,(0,f.getIn)(o,r,[]).map((function(e,t){var n=new Vr(C,e,t);return s.createElement(Nr,{key:n.key,license:n,moveLicense:d,replaceLicense:b,removeLicense:h,searchConfig:A,serializeLicenses:E})}))),s.createElement(jr,{searchConfig:A,trigger:s.createElement(R.A,{type:"button",key:"standard",icon:!0,labelPosition:"left",className:I},s.createElement(w.A,{name:"add"}),g.M.t("Add standard")),onLicenseChange:function(e){p(e)},mode:"standard",action:"add",serializeLicenses:E}),s.createElement(jr,{searchConfig:A,trigger:s.createElement(R.A,{type:"button",key:"custom",icon:!0,labelPosition:"left",className:I},s.createElement(w.A,{name:"add"}),g.M.t("Add custom")),onLicenseChange:function(e){p(e)},mode:"custom",action:"add"}),D&&s.createElement(m.FeedbackLabel,{errorMessage:D})))}}])}(s.Component);Hr.propTypes={label:p().node.isRequired,labelIcon:p().node,fieldPath:p().string.isRequired,uiFieldPath:p().string,form:p().object.isRequired,move:p().func.isRequired,push:p().func.isRequired,remove:p().func.isRequired,replace:p().func.isRequired,required:p().bool.isRequired,searchConfig:p().object.isRequired,serializeLicenses:p().func},Hr.defaultProps={labelIcon:void 0,uiFieldPath:void 0,serializeLicenses:void 0};var Yr=function(e){function t(){return(0,i.A)(this,t),Br(this,t,arguments)}return(0,c.A)(t,e),(0,a.A)(t,[{key:"render",value:function(){var e=this,t=this.props.fieldPath;return s.createElement(f.FieldArray,{name:t,component:function(t){return s.createElement(Hr,(0,r.A)({},t,e.props))}})}}])}(s.Component);function Wr(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Wr=function(){return!!e})()}Yr.propTypes={fieldPath:p().string.isRequired,label:p().string,labelIcon:p().string,searchConfig:p().object.isRequired,required:p().bool,serializeLicenses:p().func,uiFieldPath:p().string},Yr.defaultProps={label:g.M.t("Licenses"),uiFieldPath:"ui.rights",labelIcon:"drivers license",required:!1,serializeLicenses:void 0};var Gr=function(e){function t(){return(0,i.A)(this,t),e=this,n=t,r=arguments,n=(0,l.A)(n),(0,o.A)(e,Wr()?Reflect.construct(n,r||[],(0,l.A)(e).constructor):n.apply(e,r));var e,n,r}return(0,c.A)(t,e),(0,a.A)(t,[{key:"render",value:function(){var e=this.props,t=e.fieldPath,n=e.helpText,r=e.label,i=e.labelIcon,a=e.placeholder,o=e.required;return s.createElement(m.TextField,{fieldPath:t,helpText:n,label:s.createElement(m.FieldLabel,{htmlFor:t,icon:i,label:r}),placeholder:a,required:o})}}])}(s.Component);function Qr(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Qr=function(){return!!e})()}Gr.propTypes={fieldPath:p().string.isRequired,helpText:p().string,label:p().string,labelIcon:p().string,placeholder:p().string,required:p().bool},Gr.defaultProps={helpText:g.M.t("In case your upload was already published elsewhere, please use the date of the first publication. Format: YYYY-MM-DD, YYYY-MM, or YYYY. For intervals use DATE/DATE, e.g. 1939/1945."),label:g.M.t("Publication date"),labelIcon:"calendar",required:void 0,placeholder:g.M.t("YYYY-MM-DD or YYYY-MM-DD/YYYY-MM-DD for intervals. MM and DD are optional.")};var Kr=function(e){function t(){return(0,i.A)(this,t),e=this,n=t,r=arguments,n=(0,l.A)(n),(0,o.A)(e,Qr()?Reflect.construct(n,r||[],(0,l.A)(e).constructor):n.apply(e,r));var e,n,r}return(0,c.A)(t,e),(0,a.A)(t,[{key:"render",value:function(){var e=this.props,t=e.fieldPath,n=e.label,r=e.labelIcon,i=e.placeholder;return s.createElement(m.TextField,{fieldPath:t,helpText:g.M.t("The publisher is used to formulate the citation, so consider the prominence of the role."),label:s.createElement(m.FieldLabel,{htmlFor:t,icon:r,label:n}),placeholder:i})}}])}(s.Component);Kr.propTypes={fieldPath:p().string.isRequired,label:p().string,labelIcon:p().string,placeholder:p().string},Kr.defaultProps={label:g.M.t("Publisher"),labelIcon:"building outline",placeholder:g.M.t("Publisher")};var Xr={reference:""};function $r(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return($r=function(){return!!e})()}var Jr=function(e){function t(){return(0,i.A)(this,t),e=this,n=t,r=arguments,n=(0,l.A)(n),(0,o.A)(e,$r()?Reflect.construct(n,r||[],(0,l.A)(e).constructor):n.apply(e,r));var e,n,r}return(0,c.A)(t,e),(0,a.A)(t,[{key:"render",value:function(){var e=this.props,t=e.fieldPath,n=e.label,r=e.labelIcon,i=e.required,a=e.showEmptyValue;return s.createElement(m.ArrayField,{addButtonLabel:g.M.t("Add reference"),defaultNewValue:Xr,fieldPath:t,label:s.createElement(m.FieldLabel,{htmlFor:t,icon:r,label:n}),required:i,showEmptyValue:a},(function(e){var n=e.arrayHelpers,r=e.indexPath,i="".concat(t,".").concat(r);return s.createElement(m.GroupField,{optimized:!0},s.createElement(m.TextField,{fieldPath:"".concat(i,".reference"),label:g.M.t("Reference string"),required:!0,width:16}),s.createElement(v.A.Field,null,s.createElement(R.A,{"aria-label":g.M.t("Remove field"),className:"close-btn",icon:!0,onClick:function(){return n.remove(r)}},s.createElement(w.A,{name:"close"}))))}))}}])}(s.Component);Jr.propTypes={fieldPath:p().string.isRequired,label:p().string,labelIcon:p().string,required:p().bool,showEmptyValue:p().bool},Jr.defaultProps={label:g.M.t("References"),labelIcon:"bookmark",required:!1,showEmptyValue:!1};var Zr={scheme:"",identifier:"",resource_type:"",relation_type:""},ei=["fieldPath","label","labelIcon","options"];function ti(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ni(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ti(Object(n),!0).forEach((function(t){(0,A.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ti(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ri(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(ri=function(){return!!e})()}var ii=function(e){function t(){var e,n,r,a;(0,i.A)(this,t);for(var c=arguments.length,s=new Array(c),u=0;u<c;u++)s[u]=arguments[u];return n=this,r=t,a=[].concat(s),r=(0,l.A)(r),e=(0,o.A)(n,ri()?Reflect.construct(r,a||[],(0,l.A)(n).constructor):r.apply(n,a)),(0,A.A)(e,"groupErrors",(function(e,t){var n=ue()(e,t);return n?{content:n}:null})),(0,A.A)(e,"_label",(function(e){return e.type_name+(e.subtype_name?" / "+e.subtype_name:"")})),(0,A.A)(e,"createOptions",(function(t){return t.map((function(t){return ni(ni({},t),{},{label:e._label(t)})})).sort((function(e,t){return e.label.localeCompare(t.label)})).map((function(e){return{value:e.id,icon:e.icon,text:e.label}}))})),e}return(0,c.A)(t,e),(0,a.A)(t,[{key:"render",value:function(){var e=this.props,t=e.fieldPath,n=e.label,i=e.labelIcon,a=e.options,o=(0,J.A)(e,ei),l=this.createOptions(a);return s.createElement(m.SelectField,(0,r.A)({fieldPath:t,label:s.createElement(m.FieldLabel,{htmlFor:t,icon:i,label:n}),optimized:!0,"aria-label":n,options:l,selectOnBlur:!1},o))}}])}(s.Component);function ai(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(ai=function(){return!!e})()}ii.propTypes={fieldPath:p().string.isRequired,label:p().string,labelIcon:p().string,labelclassname:p().string,options:p().arrayOf(p().shape({icon:p().string,type_name:p().string,subtype_name:p().string,id:p().string})).isRequired,required:p().bool},ii.defaultProps={label:g.M.t("Resource type"),labelIcon:"tag",labelclassname:"field-label-class",required:!1};var oi=function(e){function t(){return(0,i.A)(this,t),e=this,n=t,r=arguments,n=(0,l.A)(n),(0,o.A)(e,ai()?Reflect.construct(n,r||[],(0,l.A)(e).constructor):n.apply(e,r));var e,n,r}return(0,c.A)(t,e),(0,a.A)(t,[{key:"render",value:function(){var e=this.props,t=e.fieldPath,n=e.label,r=e.labelIcon,i=e.required,a=e.options,o=e.showEmptyValue;return s.createElement(s.Fragment,null,s.createElement("label",{className:"helptext",style:{marginBottom:"10px"}},g.M.t("Specify identifiers of related works. Supported identifiers include DOI, Handle, ARK, PURL, ISSN, ISBN, PubMed ID, PubMed Central ID, ADS Bibliographic Code, arXiv, Life Science Identifiers (LSID), EAN-13, ISTC, URNs, and URLs.")),s.createElement(m.ArrayField,{addButtonLabel:g.M.t("Add related work"),defaultNewValue:Zr,fieldPath:t,label:s.createElement(m.FieldLabel,{htmlFor:t,icon:r,label:n}),required:i,showEmptyValue:o},(function(e){var n=e.arrayHelpers,r=e.indexPath,i="".concat(t,".").concat(r);return s.createElement(m.GroupField,{optimized:!0},s.createElement(m.SelectField,{clearable:!0,fieldPath:"".concat(i,".relation_type"),label:g.M.t("Relation"),"aria-label":g.M.t("Relation"),optimized:!0,options:a.relations,placeholder:{role:"option",content:"Select relation..."},required:!0,width:3}),s.createElement(m.TextField,{fieldPath:"".concat(i,".identifier"),label:g.M.t("Identifier"),required:!0,width:4}),s.createElement(m.SelectField,{clearable:!0,fieldPath:"".concat(i,".scheme"),label:g.M.t("Scheme"),"aria-label":g.M.t("Scheme"),optimized:!0,options:a.scheme,required:!0,width:2}),s.createElement(ii,{clearable:!0,fieldPath:"".concat(i,".resource_type"),labelIcon:"",options:a.resource_type,width:7,labelclassname:"small field-label-class"}),s.createElement(v.A.Field,null,s.createElement(R.A,{"aria-label":g.M.t("Remove field"),className:"close-btn",icon:!0,onClick:function(){return n.remove(r)}},s.createElement(w.A,{name:"close"}))))})))}}])}(s.Component);oi.propTypes={fieldPath:p().string.isRequired,label:p().string,labelIcon:p().string,required:p().bool,options:p().object.isRequired,showEmptyValue:p().bool},oi.defaultProps={label:g.M.t("Related works"),labelIcon:"barcode",required:void 0,showEmptyValue:!1};var li=["fieldPath","label","labelIcon","limitToOptions"];function ci(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(ci=function(){return!!e})()}var si=function(e){function t(){var e,n,r,a;(0,i.A)(this,t);for(var c=arguments.length,s=new Array(c),u=0;u<c;u++)s[u]=arguments[u];return n=this,r=t,a=[].concat(s),r=(0,l.A)(r),e=(0,o.A)(n,ci()?Reflect.construct(r,a||[],(0,l.A)(n).constructor):r.apply(n,a)),(0,A.A)(e,"state",{limitTo:"all"}),e}return(0,c.A)(t,e),(0,a.A)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.fieldPath,i=t.label,a=t.labelIcon,o=t.limitToOptions,l=(0,J.A)(t,li),c=this.state.limitTo,u=o.length>2;return s.createElement(m.GroupField,{className:"main-group-field"},u&&s.createElement(v.A.Field,{width:5,className:"subjects-field"},s.createElement(m.FieldLabel,{htmlFor:n,icon:a,label:i}),s.createElement(m.GroupField,null,s.createElement(v.A.Field,{width:8,style:{marginBottom:"auto",marginTop:"auto"},className:"p-0"},g.M.t("Suggest from")),s.createElement(v.A.Dropdown,{className:"p-0",defaultValue:o[0].value,fluid:!0,"aria-label":g.M.t("Suggest from"),onChange:function(t,n){return e.setState({limitTo:n.value})},options:o,selection:!0,width:8}))),s.createElement(m.SubjectAutocompleteDropdown,(0,r.A)({},l,{fieldPath:n,label:!u&&s.createElement(m.FieldLabel,{htmlFor:n,icon:a,label:i}),limitTo:c,width:u?11:16})))}}])}(s.Component);si.propTypes={limitToOptions:p().array.isRequired,fieldPath:p().string.isRequired,label:p().string,labelIcon:p().string,placeholder:p().string},si.defaultProps={label:g.M.t("Keywords and subjects"),labelIcon:"tag",placeholder:g.M.t("Search for a subject by name")};var ui={lang:"",title:"",type:"alternative-title"};function di(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(di=function(){return!!e})()}var pi=function(e){function t(){return(0,i.A)(this,t),e=this,n=t,r=arguments,n=(0,l.A)(n),(0,o.A)(e,di()?Reflect.construct(n,r||[],(0,l.A)(e).constructor):n.apply(e,r));var e,n,r}return(0,c.A)(t,e),(0,a.A)(t,[{key:"render",value:function(){var e=this.props,t=e.fieldPath,n=e.options,r=e.recordUI;return s.createElement(m.ArrayField,{addButtonLabel:g.M.t("Add titles"),defaultNewValue:ui,fieldPath:t,className:"additional-titles"},(function(e){var i,a=e.arrayHelpers,o=e.indexPath,l="".concat(t,".").concat(o);return s.createElement(m.GroupField,{fieldPath:t,optimized:!0},s.createElement(m.TextField,{fieldPath:"".concat(l,".title"),label:g.M.t("Additional title"),required:!0,width:5}),s.createElement(m.SelectField,{fieldPath:"".concat(l,".type"),label:g.M.t("Type"),optimized:!0,options:n.type,required:!0,width:5}),s.createElement(te,{serializeSuggestions:function(e){return e.map((function(e){return{text:e.title_l10n,value:e.id,fieldPathPrefix:e.id}}))},initialOptions:null!==r&&void 0!==r&&r.additional_titles&&null!==(i=r.additional_titles[o])&&void 0!==i&&i.lang?[r.additional_titles[o].lang]:[],fieldPath:"".concat(l,".lang"),label:g.M.t("Language"),multiple:!1,placeholder:g.M.t("Select language"),labelIcon:null,clearable:!0,selectOnBlur:!1,width:5}),s.createElement(v.A.Field,null,s.createElement(R.A,{"aria-label":g.M.t("Remove field"),className:"close-btn",icon:!0,onClick:function(){return a.remove(o)}},s.createElement(w.A,{name:"close"}))))}))}}])}(s.Component);function fi(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(fi=function(){return!!e})()}pi.propTypes={fieldPath:p().string.isRequired,options:p().shape({type:p().arrayOf(p().shape({icon:p().string,text:p().string,value:p().string})),lang:p().arrayOf(p().shape({text:p().string,value:p().string}))}),recordUI:p().object},pi.defaultProps={options:void 0,recordUI:void 0};var mi=function(e){function t(){return(0,i.A)(this,t),e=this,n=t,r=arguments,n=(0,l.A)(n),(0,o.A)(e,fi()?Reflect.construct(n,r||[],(0,l.A)(e).constructor):n.apply(e,r));var e,n,r}return(0,c.A)(t,e),(0,a.A)(t,[{key:"render",value:function(){var e=this.props,t=e.fieldPath,n=e.options,r=e.label,i=e.required,a=e.recordUI;return s.createElement(s.Fragment,null,s.createElement(m.TextField,{fieldPath:t,label:s.createElement(m.FieldLabel,{htmlFor:t,icon:"book",label:r}),required:i,className:"title-field",optimized:!0}),s.createElement(pi,{options:n,recordUI:a,fieldPath:"metadata.additional_titles"}))}}])}(s.Component);function hi(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(hi=function(){return!!e})()}mi.propTypes={fieldPath:p().string.isRequired,label:p().string,options:p().shape({type:p().arrayOf(p().shape({icon:p().string,text:p().string,value:p().string})),lang:p().arrayOf(p().shape({text:p().string,value:p().string}))}).isRequired,required:p().bool,recordUI:p().object},mi.defaultProps={label:g.M.t("Title"),required:!1,recordUI:void 0};var vi=function(e){function t(){return(0,i.A)(this,t),e=this,n=t,r=arguments,n=(0,l.A)(n),(0,o.A)(e,hi()?Reflect.construct(n,r||[],(0,l.A)(e).constructor):n.apply(e,r));var e,n,r}return(0,c.A)(t,e),(0,a.A)(t,[{key:"render",value:function(){var e=this.props,t=e.fieldPath,n=e.label,r=e.labelIcon,i=e.placeholder,a=s.createElement("span",null,s.createElement(B.x,null,"Mostly relevant for software and dataset uploads. A semantic version string is preferred see",s.createElement("a",{href:"https://semver.org/",target:"_blank",rel:"noopener noreferrer"}," ","semver.org"),", but any version string is accepted."));return s.createElement(m.TextField,{fieldPath:t,helpText:a,label:s.createElement(m.FieldLabel,{htmlFor:t,icon:r,label:n}),placeholder:i})}}])}(s.Component);function bi(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(bi=function(){return!!e})()}vi.propTypes={fieldPath:p().string.isRequired,label:p().string,labelIcon:p().string,placeholder:p().string},vi.defaultProps={label:g.M.t("Version"),labelIcon:"code branch",placeholder:""};var yi=function(e){function t(){return(0,i.A)(this,t),e=this,n=t,r=arguments,n=(0,l.A)(n),(0,o.A)(e,bi()?Reflect.construct(n,r||[],(0,l.A)(e).constructor):n.apply(e,r));var e,n,r}return(0,c.A)(t,e),(0,a.A)(t,[{key:"render",value:function(){var e=this.props,t=e.fieldPath,n=e.label,r=e.labelIcon;return s.createElement(v.A.Field,{id:t,name:t},s.createElement(m.FieldLabel,{htmlFor:t,icon:r,label:n}),s.createElement(fn.A,{size:"massive",tertiary:!0,textAlign:"center"},g.M.t("Coming soon")))}}])}(s.Component);yi.propTypes={fieldPath:p().string.isRequired,label:p().string,labelIcon:p().string},yi.defaultProps={label:void 0,labelIcon:void 0};var gi=n(90179),Ai=n.n(gi),Ei=n(92411),wi=n.n(Ei),Ri=["draftExists","isPublished","isVersion","actionState","formik"];function Ci(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Ci=function(){return!!e})()}var Pi=g.M.t("discard changes"),Si=g.M.t("discard version"),ki=g.M.t("delete"),Oi=g.M.t("Are you sure you want to discard the changes to this draft?"),Di=g.M.t("Are you sure you want to delete this new version?"),Ii=g.M.t("Are you sure you want to delete this draft?"),Mi=function(e){var t="";switch(e.actionLbl){case Pi:t=Oi;break;case Si:t=Di;break;case ki:t=Ii}return t},Fi=function(e){function t(){var e,n,r,a;(0,i.A)(this,t);for(var c=arguments.length,s=new Array(c),u=0;u<c;u++)s[u]=arguments[u];return n=this,r=t,a=[].concat(s),r=(0,l.A)(r),e=(0,o.A)(n,Ci()?Reflect.construct(r,a||[],(0,l.A)(n).constructor):r.apply(n,a)),(0,A.A)(e,"state",{modalOpen:!1}),(0,A.A)(e,"openConfirmModal",(function(){return e.setState({modalOpen:!0})})),(0,A.A)(e,"closeConfirmModal",(function(){return e.setState({modalOpen:!1})})),(0,A.A)(e,"handleDelete",function(){var t=(0,it.A)(ot().mark((function t(n){var r,i,a,o,l;return ot().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=e.props,i=r.isPublished,a=r.isVersion,o=r.formik,l=o.handleSubmit,(0,e.context.setSubmitContext)(Bn,{isDiscardingVersion:i||a}),l(n),e.closeConfirmModal();case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),e}return(0,c.A)(t,e),(0,a.A)(t,[{key:"render",value:function(){var e=this.props,t=e.draftExists,n=e.isPublished,i=e.isVersion,a=e.actionState,o=e.formik,l=(0,J.A)(e,Ri),c=this.state.modalOpen,u=o.isSubmitting,d=Ai()(l,["dispatch"]),p="";p=n?Pi:i?Si:ki;var f=n?"warning":"negative",m=wi()(p);return s.createElement(s.Fragment,null,s.createElement(R.A,(0,r.A)({disabled:!t||u,onClick:this.openConfirmModal,className:f,icon:!0,loading:u&&a===gt,labelPosition:"left"},d,{content:m})),s.createElement(ye.A,{open:c,onClose:this.closeConfirmModal,size:"tiny"},s.createElement(ye.A.Content,null,s.createElement(Mi,{actionLbl:p})),s.createElement(ye.A.Actions,null,s.createElement(R.A,{onClick:this.closeConfirmModal,floated:"left"},g.M.t("Cancel")),s.createElement(R.A,{className:f,onClick:this.handleDelete,loading:u&&a===gt,icon:"trash alternate outline",content:m}))))}}])}(s.Component);(0,A.A)(Fi,"contextType",Yn),Fi.propTypes={draftExists:p().bool,isPublished:p().bool,isVersion:p().bool,actionState:p().string,formik:p().object.isRequired},Fi.defaultProps={draftExists:!1,isPublished:!1,isVersion:!1,actionState:void 0};var xi=(0,u.connect)((function(e){var t;return{draftExists:Boolean(e.deposit.record.id),isPublished:e.deposit.record.is_published,isVersion:(null===(t=e.deposit.record.versions)||void 0===t?void 0:t.index)>1,actionState:e.deposit.actionState}}),null)((0,f.connect)(Fi)),Ti=["actionState","formik"];function qi(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(qi=function(){return!!e})()}var _i=function(e){function t(){var e,n,r,a;(0,i.A)(this,t);for(var c=arguments.length,s=new Array(c),u=0;u<c;u++)s[u]=arguments[u];return n=this,r=t,a=[].concat(s),r=(0,l.A)(r),e=(0,o.A)(n,qi()?Reflect.construct(r,a||[],(0,l.A)(n).constructor):r.apply(n,a)),(0,A.A)(e,"handlePreview",(function(t,n){(0,e.context.setSubmitContext)(Nn),n(t)})),e}return(0,c.A)(t,e),(0,a.A)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.actionState,i=t.formik,a=(0,J.A)(t,Ti),o=i.handleSubmit,l=i.isSubmitting,c=Ai()(a,["dispatch"]);return s.createElement(R.A,(0,r.A)({name:"preview",disabled:l,onClick:function(t){return e.handlePreview(t,o)},loading:l&&n===bt,icon:"eye",labelPosition:"left",content:g.M.t("Preview")},c))}}])}(s.Component);(0,A.A)(_i,"contextType",Yn),_i.propTypes={actionState:p().string,formik:p().object.isRequired},_i.defaultProps={actionState:void 0};var ji=(0,u.connect)((function(e){return{actionState:e.deposit.actionState,record:e.deposit.record}}),null)((0,f.connect)(_i)),zi=s.createContext({}),Li=n(78585),Ni=function(e){var t,n=e.result,r=e.record,i=e.isInitialSubmission,a=(0,s.useContext)(zi),o=a.setLocalCommunity,l=a.getChosenCommunity,c=a.userCommunitiesMemberships,u=a.displaySelected,d=n.metadata,p=(null===(t=l())||void 0===t?void 0:t.id)===n.id,f=c[n.id],h="public"===r.access.record&&"restricted"===n.access.visibility,v=n.ui.permissions.can_submit_record,b=(0,lt.get)(n,"theme.enabled"),y=i&&b,A=h||y||!v,E=s.createElement(s.Fragment,null,h&&s.createElement(m.InvenioPopup,{popupId:"community-inclusion-info-popup",size:"small",trigger:s.createElement(w.A,{className:"mb-5",color:"grey",name:"question circle outline"}),ariaLabel:g.M.t("Community inclusion information"),content:g.M.t("Submission to this community is only allowed if the record is restricted.")}),!v&&s.createElement(m.InvenioPopup,{popupId:"community-inclusion-info-popup",size:"small",trigger:s.createElement(w.A,{className:"mb-5",color:"grey",name:"question circle outline"}),ariaLabel:g.M.t("Submission to this community is only allowed to community members."),content:g.M.t("Submission to this community is only allowed to community members.")}),y&&s.createElement(s.Fragment,null,s.createElement(m.InvenioPopup,{popupId:"community-inclusion-info-popup",size:"small",trigger:s.createElement(w.A,{className:"mb-5",color:"grey",name:"question circle outline"}),ariaLabel:g.M.t("Community submission conditions information"),content:g.M.t("Submission to this community is only allowed by dedicated upload form. Use the button to jump to the form.")}),s.createElement(R.A,{size:"tiny",as:"a",href:"/communities/".concat(n.slug)},g.M.t("Go to the community"))),!y&&s.createElement(R.A,{content:u&&p?g.M.t("Selected"):g.M.t("Select"),size:"tiny",positive:u&&p,onClick:function(){return o(n)},disabled:A,"aria-label":g.M.t("Select {{title}}",{title:d.title})})),C=s.createElement(s.Fragment,null,f&&s.createElement(ze.A,{size:"small",horizontal:!0,color:"teal"},s.createElement(w.A,{name:"key"}),wi()(f)),b&&s.createElement(ze.A,{color:"green",horizontal:!0,size:"small"},s.createElement(w.A,{name:"check circle"}),g.M.t("Verified")));return s.createElement(Li.mG,{result:n,actions:E,extraLabels:C,showPermissionLabel:!0})};function Bi(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Bi=function(){return!!e})()}Ni.propTypes={result:p().object.isRequired,record:p().object.isRequired,isInitialSubmission:p().bool},Ni.defaultProps={isInitialSubmission:!0};var Ui=function(e){function t(e){var n,r,a,c;(0,i.A)(this,t),r=this,a=t,c=[e],a=(0,l.A)(a);var s=(n=(0,o.A)(r,Bi()?Reflect.construct(a,c||[],(0,l.A)(r).constructor):a.apply(r,c))).props.apiConfigs.allCommunities;return n.state={selectedConfig:s},n}return(0,c.A)(t,e),(0,a.A)(t,[{key:"render",value:function(){var e=this,t=this.state.selectedConfig,n=t.searchApi,r=t.appId,i=t.initialQueryState,a=t.toggleText,o=this.props,l=o.apiConfigs,c=l.allCommunities,u=l.myCommunities,d=o.record,p=o.isInitialSubmission,f=o.CommunityListItem,m=o.pagination,h=o.myCommunitiesEnabled,v=o.autofocus,b=new br.HZ(n),y=(0,A.A)({},"".concat(r,".ResultsList.item"),(0,O.parametrize)(f,{record:d,isInitialSubmission:p}));return s.createElement(O.OverridableContext.Provider,{value:y},s.createElement(br.gz,{appName:r,urlHandlerApi:{enabled:!1},searchApi:b,key:r,initialQueryState:i,defaultSortingOnEmptyQueryString:{sortBy:"bestmatch"}},s.createElement(s.Fragment,null,s.createElement(ye.A.Content,{as:X.A,className:"m-0 pb-0 centered"},h&&s.createElement(X.A.Column,{mobile:16,tablet:8,computer:8,textAlign:"left",floated:"left",className:"pt-0 pl-0"},s.createElement(yr.A,{role:"tablist",className:"theme-primary-menu",compact:!0},s.createElement(yr.A.Item,{as:"button",role:"tab",id:"all-communities-tab","aria-selected":r===c.appId,"aria-controls":c.appId,name:"All",active:r===c.appId,onClick:function(){return e.setState({selectedConfig:c})}},g.M.t("All")),s.createElement(yr.A.Item,{as:"button",role:"tab",id:"my-communities-tab","aria-selected":r===u.appId,"aria-controls":u.appId,name:"My communities",active:r===u.appId,onClick:function(){return e.setState({selectedConfig:u})}},g.M.t("My communities")))),s.createElement(X.A.Column,{mobile:16,tablet:8,computer:8,floated:h?"right":"null",verticalAlign:"middle",className:"pt-0 pr-0 pl-0"},s.createElement(br.IW,{placeholder:a,autofocus:v,actionProps:{icon:"search",content:null,className:"search","aria-label":g.M.t("Search")}}))),s.createElement(ye.A.Content,{role:"tabpanel",id:r,scrolling:!0,className:"community-list-results"},s.createElement(br.oK,null,s.createElement(br.i6,null),s.createElement(br.$D,null),s.createElement(br.dy,null))),m&&s.createElement(ye.A.Content,{className:"text-align-center"},s.createElement(br.dK,null)))))}}])}(s.Component);function Vi(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Vi=function(){return!!e})()}Ui.propTypes={apiConfigs:p().shape({allCommunities:p().shape({appId:p().string.isRequired,initialQueryState:p().object.isRequired,searchApi:p().object.isRequired}),myCommunities:p().shape({appId:p().string.isRequired,initialQueryState:p().object.isRequired,searchApi:p().object.isRequired})}),record:p().object.isRequired,isInitialSubmission:p().bool,CommunityListItem:p().elementType,pagination:p().bool,myCommunitiesEnabled:p().bool,autofocus:p().bool},Ui.defaultProps={isInitialSubmission:!0,pagination:!0,myCommunitiesEnabled:!0,autofocus:!0,CommunityListItem:Ni,apiConfigs:{allCommunities:{initialQueryState:{size:5,page:1,sortBy:"bestmatch"},searchApi:{axios:{url:"/api/communities",headers:{Accept:"application/vnd.inveniordm.v1+json"}}},appId:"ReactInvenioDeposit.CommunitySelectionSearch.AllCommunities",toggleText:"Search in all communities"},myCommunities:{initialQueryState:{size:5,page:1,sortBy:"bestmatch"},searchApi:{axios:{url:"/api/user/communities",headers:{Accept:"application/vnd.inveniordm.v1+json"}}},appId:"ReactInvenioDeposit.CommunitySelectionSearch.MyCommunities",toggleText:"Search in my communities"}}};var Hi=function(e){function t(e){var n,r,a,c;(0,i.A)(this,t),r=this,a=t,c=[e],a=(0,l.A)(a),n=(0,o.A)(r,Vi()?Reflect.construct(a,c||[],(0,l.A)(r).constructor):a.apply(r,c)),(0,A.A)(n,"getChosenCommunity",(function(){return n.state.localChosenCommunity})),(0,A.A)(n,"setCommunity",(function(e){(0,n.props.onCommunityChange)(e),n.setState({localChosenCommunity:e})})),(0,A.A)(n,"modalTrigger",(function(){var e=n.props,t=e.trigger,r=e.modalOpen;if(!x()(t))return s.cloneElement(t,{"aria-haspopup":"dialog","aria-expanded":r})})),(0,A.A)(n,"handleModalOpen",(function(){var e=n.props,t=e.chosenCommunity,r=e.onModalChange;n.setState({localChosenCommunity:t}),r&&r(!0)}));var u=e.chosenCommunity,d=e.userCommunitiesMemberships,p=e.displaySelected;return n.state={localChosenCommunity:u},n.contextValue={setLocalCommunity:n.setCommunity,getChosenCommunity:n.getChosenCommunity,userCommunitiesMemberships:d,displaySelected:p},n}return(0,c.A)(t,e),(0,a.A)(t,[{key:"render",value:function(){var e=this.props,t=e.extraContentComponents,n=e.modalHeader,r=e.onModalChange,i=e.modalOpen,a=e.apiConfigs,o=e.handleClose,l=e.record,c=e.isInitialSubmission;return s.createElement(zi.Provider,{value:this.contextValue},s.createElement(ye.A,{role:"dialog","aria-labelledby":"community-modal-header",id:"community-selection-modal",className:"m-0",closeIcon:!0,closeOnDimmerClick:!1,open:i,onClose:function(){r&&r(!1)},onOpen:this.handleModalOpen,trigger:this.modalTrigger()},s.createElement(ye.A.Header,null,s.createElement(y.A,{as:"h2",size:"small",id:"community-modal-header",className:"mt-5"},n)),s.createElement(Ui,{apiConfigs:a,record:l,isInitialSubmission:c}),t&&s.createElement(ye.A.Content,null,t),s.createElement(ye.A.Actions,null,s.createElement(R.A,{onClick:o},g.M.t("Close")))))}}])}(s.Component);Hi.propTypes={chosenCommunity:p().object,onCommunityChange:p().func.isRequired,trigger:p().object,userCommunitiesMemberships:p().object.isRequired,extraContentComponents:p().node,modalHeader:p().string,onModalChange:p().func,displaySelected:p().bool,modalOpen:p().bool,apiConfigs:p().object,handleClose:p().func.isRequired,record:p().object.isRequired,isInitialSubmission:p().bool},Hi.defaultProps={chosenCommunity:void 0,extraContentComponents:void 0,modalHeader:g.M.t("Select a community"),onModalChange:void 0,displaySelected:!1,modalOpen:!1,trigger:void 0,apiConfigs:void 0,isInitialSubmission:!0};var Yi=(0,u.connect)((function(e){return{userCommunitiesMemberships:e.deposit.config.user_communities_memberships}}),null)(Hi),Wi=["actionState","filesState","buttonLabel","publishWithoutCommunity","formik","publishModalExtraContent","raiseDOINeededButNotReserved","noINeedDOI","isDOIRequired"];function Gi(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Gi=function(){return!!e})()}var Qi=function(e){function t(){var e,n,r,a;(0,i.A)(this,t);for(var c=arguments.length,s=new Array(c),u=0;u<c;u++)s[u]=arguments[u];return n=this,r=t,a=[].concat(s),r=(0,l.A)(r),e=(0,o.A)(n,Gi()?Reflect.construct(r,a||[],(0,l.A)(n).constructor):r.apply(n,a)),(0,A.A)(e,"state",{isConfirmModalOpen:!1}),(0,A.A)(e,"openConfirmModal",(function(){return e.setState({isConfirmModalOpen:!0})})),(0,A.A)(e,"closeConfirmModal",(function(){return e.setState({isConfirmModalOpen:!1})})),(0,A.A)(e,"handlePublish",(function(t,n,r){var i,a=e.context.setSubmitContext,o=e.props,l=o.formik,c=o.raiseDOINeededButNotReserved,s=o.isDOIRequired,u=o.noINeedDOI;if(void 0!==s&&!s&&u&&0===Object.keys(null===l||void 0===l||null===(i=l.values)||void 0===i?void 0:i.pids).length){var d={pids:{doi:g.M.t("DOI is needed. You need to reserve a DOI before publishing.")}};l.setErrors(d),c(null===l||void 0===l?void 0:l.values,d),e.closeConfirmModal()}else a(r?Ln:zn),n(t),e.closeConfirmModal();re()})),(0,A.A)(e,"isDisabled",(function(e,t,n){var r;if(t)return!0;var i=ue()(e,"files.enabled",!1),a=Object.values(null!==(r=n.entries)&&void 0!==r?r:{});return!(!i||0!==a.length)||!a.every((function(e){return"finished"===e.status}))})),e}return(0,c.A)(t,e),(0,a.A)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.actionState,i=t.filesState,a=t.buttonLabel,o=t.publishWithoutCommunity,l=t.formik,c=t.publishModalExtraContent,u=(t.raiseDOINeededButNotReserved,t.noINeedDOI,t.isDOIRequired,(0,J.A)(t,Wi)),d=this.state.isConfirmModalOpen,p=l.values,f=l.isSubmitting,m=l.handleSubmit,h=Ai()(u,["dispatch"]);return s.createElement(s.Fragment,null,s.createElement(R.A,(0,r.A)({disabled:this.isDisabled(p,f,i),name:"publish",onClick:this.openConfirmModal,positive:!0,icon:"upload",loading:f&&n===mt,labelPosition:"left",content:a},h,{type:"button"})),d&&s.createElement(ye.A,{open:d,onClose:this.closeConfirmModal,size:"small",closeIcon:!0,closeOnDimmerClick:!1},s.createElement(ye.A.Header,null,g.M.t("Are you sure you want to publish this record?")),s.createElement(ye.A.Content,null,s.createElement(V.A,{visible:!0,warning:!0},s.createElement("p",null,s.createElement(w.A,{name:"warning sign"})," ",g.M.t("Once the record is published you will no longer be able to change the files in the upload! However, you will still be able to update the record's metadata later."))),c&&s.createElement("div",{dangerouslySetInnerHTML:{__html:c}})),s.createElement(ye.A.Actions,null,s.createElement(R.A,{onClick:this.closeConfirmModal,floated:"left"},g.M.t("Cancel")),s.createElement(R.A,{onClick:function(t){return e.handlePublish(t,m,o)},positive:!0,content:a}))))}}])}(s.Component);(0,A.A)(Qi,"contextType",Yn),Qi.propTypes={buttonLabel:p().string,publishWithoutCommunity:p().bool,actionState:p().string,formik:p().object.isRequired,publishModalExtraContent:p().string,filesState:p().object,raiseDOINeededButNotReserved:p().func.isRequired,isDOIRequired:p().bool,noINeedDOI:p().bool},Qi.defaultProps={buttonLabel:g.M.t("Publish"),publishWithoutCommunity:!1,actionState:void 0,publishModalExtraContent:void 0,filesState:void 0,isDOIRequired:void 0,noINeedDOI:void 0};var Ki=(0,u.connect)((function(e){return{actionState:e.deposit.actionState,publishModalExtraContent:e.deposit.config.publish_modal_extra,filesState:e.files,isDOIRequired:e.deposit.config.is_doi_required,noINeedDOI:e.deposit.noINeedDOI}}),(function(e){return{raiseDOINeededButNotReserved:function(t,n){return e({type:vt,payload:{data:t,errors:n}})}}}))((0,f.connect)(Qi));function Xi(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Xi=function(){return!!e})()}var $i=function(e){function t(){var e,n,r,a;(0,i.A)(this,t);for(var c=arguments.length,s=new Array(c),u=0;u<c;u++)s[u]=arguments[u];return n=this,r=t,a=[].concat(s),r=(0,l.A)(r),e=(0,o.A)(n,Xi()?Reflect.construct(r,a||[],(0,l.A)(n).constructor):r.apply(n,a)),(0,A.A)(e,"ConfirmSubmitReviewSchema",ge.Ik({acceptAccessToRecord:ge.lc().oneOf([!0],g.M.t("You must accept this.")),reviewComment:ge.Yj()})),e}return(0,c.A)(t,e),(0,a.A)(t,[{key:"componentDidMount",value:function(){var e=document.getElementById("accept-access-checkbox").querySelector("input");null===e||void 0===e||e.focus()}},{key:"render",value:function(){var e,t,n,r,i=this,a=this.props,o=a.initialReviewComment,l=a.isConfirmModalOpen,c=a.community,u=a.onClose,d=a.onSubmit,p=a.publishModalExtraContent,h=a.directPublish,b=a.errors,y=a.loading,A=a.record,E=c.metadata.title;null!==A&&void 0!==A&&A.is_published?(e=g.M.t("Submit to community"),t=g.M.t("Before submitting to community, please read and check the following:"),r=g.M.t("Submit to community")):h?(e=g.M.t("Publish to community"),t=g.M.t("Before publishing to the community, please read and check the following:"),n=g.M.t("Your upload will be <bold>immediately published</bold> in '{{communityTitle}}'. You will no longer be able to change the files in the upload! However, you will still be able to update the record's metadata later.",{communityTitle:E}),r=g.M.t("Publish record to community")):(e=g.M.t("Submit for review"),t=g.M.t("Before requesting review, please read and check the following:"),n=g.M.t("If your upload is accepted by the community curators, it will be <bold>immediately published</bold>. Before that, you will still be able to modify metadata and files of this upload."),r=g.M.t("Submit record for review"));return s.createElement(f.Formik,{initialValues:{acceptAccessToRecord:!1,acceptAfterPublishRecord:!1,reviewComment:o||""},onSubmit:d,validationSchema:function(){if(A)return i.ConfirmSubmitReviewSchema;var e=ge.Ik({acceptAfterPublishRecord:ge.lc().oneOf([!0],g.M.t("You must accept this."))});return i.ConfirmSubmitReviewSchema.concat(e)},validateOnChange:!1,validateOnBlur:!1},(function(i){var a=i.values,o=i.handleSubmit;return s.createElement(ye.A,{open:l,onClose:u,size:"small",closeIcon:!0,closeOnDimmerClick:!1},s.createElement(ye.A.Header,null,e),s.createElement(ye.A.Content,null,b&&s.createElement(m.ErrorMessage,{errors:b}),s.createElement(V.A,{visible:!0,warning:!0},s.createElement("p",null,s.createElement(w.A,{name:"warning sign"}),t)),s.createElement(v.A,null,s.createElement(v.A.Field,{id:"accept-access-checkbox"},s.createElement(m.RadioField,{control:q.A,fieldPath:"acceptAccessToRecord",label:s.createElement(B.x,{defaults:g.M.t("The '{{communityTitle}}' curators will have access to <bold>view</bold> and <bold>edit</bold> your upload's metadata and files.",{communityTitle:E}),values:{communityTitle:E},components:{bold:s.createElement("b",null)},shouldUnescape:!0}),checked:!0===ue()(a,"acceptAccessToRecord"),onChange:function(e){var t=e.data;e.formikProps.form.setFieldValue("acceptAccessToRecord",t.checked)},optimized:!0}),s.createElement(m.ErrorLabel,{role:"alert",fieldPath:"acceptAccessToRecord",className:"mt-0 mb-5"})),!A&&s.createElement(v.A.Field,null,s.createElement(m.RadioField,{control:q.A,fieldPath:"acceptAfterPublishRecord",label:s.createElement(B.x,{defaults:n,values:{communityTitle:E},components:{bold:s.createElement("b",null)}}),checked:!0===ue()(a,"acceptAfterPublishRecord"),onChange:function(e){var t=e.data;e.formikProps.form.setFieldValue("acceptAfterPublishRecord",t.checked)},optimized:!0}),s.createElement(m.ErrorLabel,{role:"alert",fieldPath:"acceptAfterPublishRecord",className:"mt-0 mb-5"})),!h&&s.createElement(m.TextAreaField,{fieldPath:"reviewComment",label:g.M.t("Message to curators (optional)")}),p&&s.createElement("div",{dangerouslySetInnerHTML:{__html:p}}))),s.createElement(ye.A.Actions,null,s.createElement(R.A,{onClick:u,floated:"left",loading:y,disabled:y},g.M.t("Cancel")),s.createElement(R.A,{name:"submitReview",onClick:function(e){o(e)},loading:y,disabled:y,positive:h,primary:!h,content:r})))}))}}])}(s.Component);$i.propTypes={isConfirmModalOpen:p().bool.isRequired,community:p().object.isRequired,onClose:p().func.isRequired,onSubmit:p().func.isRequired,initialReviewComment:p().string,publishModalExtraContent:p().string,directPublish:p().bool,errors:p().node,loading:p().bool,record:p().object.isRequired},$i.defaultProps={initialReviewComment:"",publishModalExtraContent:void 0,directPublish:!1,errors:void 0,loading:!1};var Ji=["actionState","actionStateExtra","community","disableSubmitForReviewButton","directPublish","formik","isRecordSubmittedForReview","publishModalExtraContent","filesState"];function Zi(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Zi=function(){return!!e})()}var ea=function(e){function t(){var e,n,r,a;(0,i.A)(this,t);for(var c=arguments.length,s=new Array(c),u=0;u<c;u++)s[u]=arguments[u];return n=this,r=t,a=[].concat(s),r=(0,l.A)(r),e=(0,o.A)(n,Zi()?Reflect.construct(r,a||[],(0,l.A)(n).constructor):r.apply(n,a)),(0,A.A)(e,"state",{isConfirmModalOpen:!1}),(0,A.A)(e,"openConfirmModal",(function(){return e.setState({isConfirmModalOpen:!0})})),(0,A.A)(e,"closeConfirmModal",(function(){return e.setState({isConfirmModalOpen:!1})})),(0,A.A)(e,"handleSubmitReview",(function(t){var n=t.reviewComment,r=e.props,i=r.formik,a=r.directPublish,o=i.handleSubmit;(0,e.context.setSubmitContext)(Hn,{reviewComment:n,directPublish:a}),o(),e.closeConfirmModal()})),(0,A.A)(e,"isDisabled",(function(t,n){var r,i=e.props,a=i.formik,o=i.userCanManageRecord,l=i.record,c=a.values,s=a.isSubmitting;if(!!l.id&&!o||t||s)return!0;var u=ue()(c,"files.enabled",!1),d=Object.values(null!==(r=n.entries)&&void 0!==r?r:{});return!(!u||0!==d.length)||!d.every((function(e){return"finished"===e.status}))})),e}return(0,c.A)(t,e),(0,a.A)(t,[{key:"render",value:function(){var e=this.props,t=e.actionState,n=e.actionStateExtra,i=e.community,a=e.disableSubmitForReviewButton,o=e.directPublish,l=e.formik,c=e.isRecordSubmittedForReview,u=e.publishModalExtraContent,d=e.filesState,p=(0,J.A)(e,Ji),f=l.isSubmitting,m=Ai()(p,["dispatch"]),h=this.state.isConfirmModalOpen,v=c?g.M.t("Submitted for review"):g.M.t("Submit for review"),b=o?g.M.t("Publish to community"):v;return s.createElement(s.Fragment,null,s.createElement(R.A,(0,r.A)({disabled:this.isDisabled(a,d),name:"SubmitReview",onClick:this.openConfirmModal,positive:o,primary:!o,icon:"upload",loading:f&&"DRAFT_SUBMIT_REVIEW_STARTED"===t,labelPosition:"left",content:b},m,{type:"button"})),h&&s.createElement($i,{isConfirmModalOpen:h,initialReviewComment:n.reviewComment,onSubmit:this.handleSubmitReview,community:i,onClose:this.closeConfirmModal,publishModalExtraContent:u,directPublish:o}))}}])}(s.Component);(0,A.A)(ea,"contextType",Yn),ea.propTypes={actionState:p().string,actionStateExtra:p().object.isRequired,community:p().object.isRequired,disableSubmitForReviewButton:p().bool,isRecordSubmittedForReview:p().bool.isRequired,directPublish:p().bool,formik:p().object.isRequired,publishModalExtraContent:p().string,filesState:p().object,userCanManageRecord:p().bool.isRequired,record:p().object.isRequired},ea.defaultProps={actionState:void 0,disableSubmitForReviewButton:void 0,publishModalExtraContent:void 0,directPublish:!1,filesState:void 0};var ta=(0,u.connect)((function(e){return{actionState:e.deposit.actionState,actionStateExtra:e.deposit.actionStateExtra,community:e.deposit.editorState.selectedCommunity,isRecordSubmittedForReview:e.deposit.record.status===tr.IN_REVIEW,disableSubmitForReviewButton:e.deposit.editorState.ui.disableSubmitForReviewButton,publishModalExtraContent:e.deposit.config.publish_modal_extra,filesState:e.files,userCanManageRecord:e.deposit.permissions.can_manage}}),null)((0,f.connect)(ea)),na=["community","changeSelectedCommunityFn","showChangeCommunityButton","showDirectPublishButton","showSubmitForReviewButton","record"];function ra(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(ra=function(){return!!e})()}var ia=function(e){function t(e){var n,r,a,c;return(0,i.A)(this,t),r=this,a=t,c=[e],a=(0,l.A)(a),(n=(0,o.A)(r,ra()?Reflect.construct(a,c||[],(0,l.A)(r).constructor):a.apply(r,c))).state={modalOpen:!1},n}return(0,c.A)(t,e),(0,a.A)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.community,i=t.changeSelectedCommunityFn,a=t.showChangeCommunityButton,o=t.showDirectPublishButton,l=t.showSubmitForReviewButton,c=t.record,u=(0,J.A)(t,na),d=this.state.modalOpen;return l?s.createElement(ta,(0,r.A)({directPublish:o},u,{fluid:!0,className:"mb-10",record:c})):a?s.createElement(s.Fragment,null,s.createElement(Yi,{onCommunityChange:function(e){i(e)},onModalChange:function(t){return e.setState({modalOpen:t})},modalOpen:d,displaySelected:!0,record:c,chosenCommunity:n,trigger:s.createElement(R.A,{content:g.M.t("Change community"),fluid:!0,className:"mb-10"})}),s.createElement(Ki,(0,r.A)({buttonLabel:g.M.t("Publish without community"),publishWithoutCommunity:!0},u))):s.createElement(Ki,u)}}])}(s.Component);ia.propTypes={community:p().object,changeSelectedCommunityFn:p().func.isRequired,showChangeCommunityButton:p().bool.isRequired,showDirectPublishButton:p().bool.isRequired,showSubmitForReviewButton:p().bool.isRequired,record:p().object.isRequired},ia.defaultProps={community:void 0};var aa=(0,u.connect)((function(e){return{community:e.deposit.editorState.selectedCommunity,showDirectPublishButton:e.deposit.editorState.ui.showDirectPublishButton,showChangeCommunityButton:e.deposit.editorState.ui.showChangeCommunityButton,showSubmitForReviewButton:e.deposit.editorState.ui.showSubmitForReviewButton}}),(function(e){return{changeSelectedCommunityFn:function(t){return e(Jt(t))}}}))(ia),oa=["actionState","formik"];function la(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(la=function(){return!!e})()}var ca=function(e){function t(){var e,n,r,a;(0,i.A)(this,t);for(var c=arguments.length,s=new Array(c),u=0;u<c;u++)s[u]=arguments[u];return n=this,r=t,a=[].concat(s),r=(0,l.A)(r),e=(0,o.A)(n,la()?Reflect.construct(r,a||[],(0,l.A)(n).constructor):r.apply(n,a)),(0,A.A)(e,"handleSave",(function(t){var n=e.props.formik,r=e.context.setSubmitContext,i=n.handleSubmit;r(jn),i(t),re()})),e}return(0,c.A)(t,e),(0,a.A)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.actionState,i=t.formik,a=(0,J.A)(t,oa),o=i.isSubmitting,l=Ai()(a,["dispatch"]);return s.createElement(R.A,(0,r.A)({name:"save",disabled:o,onClick:function(t){return e.handleSave(t)},icon:"save",loading:o&&n===dt,labelPosition:"left",content:g.M.t("Save draft")},l))}}])}(s.Component);(0,A.A)(ca,"contextType",Yn),ca.propTypes={formik:p().object.isRequired,actionState:p().string},ca.defaultProps={actionState:void 0};var sa,ua=(0,u.connect)((function(e){return{actionState:e.deposit.actionState}}),null)((0,f.connect)(ca));function da(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function pa(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?da(Object(n),!0).forEach((function(t){(0,A.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):da(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function fa(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(fa=function(){return!!e})()}var ma=(sa={},(0,A.A)((0,A.A)((0,A.A)((0,A.A)((0,A.A)((0,A.A)((0,A.A)((0,A.A)((0,A.A)((0,A.A)(sa,pt,{feedback:"positive",message:g.M.t("Record successfully saved.")}),ut,{feedback:"warning",message:g.M.t("Record saved with validation feedback in")}),ft,{feedback:"negative",message:g.M.t("The draft was not saved. Please try again. If the problem persists, contact user support.")}),ht,{feedback:"negative",message:g.M.t("The draft was not published. Please try again. If the problem persists, contact user support.")}),vt,{feedback:"negative",message:g.M.t("The draft was not published. Record saved with validation feedback in")}),wt,{feedback:"negative",message:g.M.t("The draft was not submitted for review. Please try again. If the problem persists, contact user support.")}),Rt,{feedback:"negative",message:g.M.t("The draft was not submitted for review. Record saved with validation feedback in")}),At,{feedback:"negative",message:g.M.t("Draft deletion failed. Please try again. If the problem persists, contact user support.")}),yt,{feedback:"negative",message:g.M.t("Draft preview failed. Please try again. If the problem persists, contact user support.")}),St,{feedback:"negative",message:g.M.t("Identifier reservation failed. Please try again. If the problem persists, contact user support.")}),(0,A.A)((0,A.A)((0,A.A)(sa,Dt,{feedback:"negative",message:g.M.t("Identifier could not be discarded. Please try again. If the problem persists, contact user support.")}),qt,{feedback:"negative",message:g.M.t("Draft save failed before file upload. Please try again. If the problem persists, contact user support.")}),zt,{feedback:"negative",message:g.M.t("Files import from the previous version failed. Please try again. If the problem persists, contact user support.")})),ha={positive:{icon:"check",type:"positive"},suggestive:{icon:"info circle",type:"info"},negative:{icon:"times circle",type:"negative"},warning:{icon:"exclamation triangle",type:"warning"}},va=function(e){function t(e){var n,r,a,c;return(0,i.A)(this,t),r=this,a=t,c=[e],a=(0,l.A)(a),(n=(0,o.A)(r,fa()?Reflect.construct(a,c||[],(0,l.A)(r).constructor):a.apply(r,c))).labels=pa({},e.labels),n.sections=pa({},e.sectionsConfig),n}return(0,c.A)(t,e),(0,a.A)(t,[{key:"getErrorSections",value:function(e){var t=this,n=new Map;Object.keys(e).forEach((function(r){for(var i,a=Array.isArray(e[r])?e[r].length:1,o=0,l=Object.entries(t.sections);o<l.length;o++){var c=(0,fe.A)(l[o],2),s=c[0];if(c[1].some((function(e){return r.startsWith(e)}))){var u,d=document.getElementById(s),p=(null===d||void 0===d?void 0:d.getAttribute("label"))||"Unknown section";return void n.set(s,{label:p,count:((null===(u=n.get(s))||void 0===u?void 0:u.count)||0)+a})}}var f=null===(i=document.querySelector('label[for^="'.concat(r.replace(/^(.*?)(\[\d+\].*)?$/,"$1"),'"]')))||void 0===i?void 0:i.closest(".accordion");if(f){var m,h=f.id,v=f.getAttribute("label")||"Unknown section";n.set(h,{label:v,count:((null===(m=n.get(h))||void 0===m?void 0:m.count)||0)+a})}}));var r=Array.from(document.querySelectorAll(".accordion")).map((function(e){return e.id}));return[].concat((0,we.A)(r.filter((function(e){return n.has(e)}))),(0,we.A)((0,we.A)(n.keys()).filter((function(e){return!r.includes(e)})))).map((function(e,t){var r=n.get(e),i=r.label,a=r.count;return s.createElement("a",{key:e,className:"pl-5",href:"#".concat(e)},i," ",s.createElement(ze.A,{circular:!0,size:"tiny"},a))}))}},{key:"render",value:function(){var e=this.props,t=e.errors,n=e.actionState,i=t||{},a=ue()(ma,n,{feedback:void 0,message:void 0}),o=a.feedback,l=a.message;if(!l)return null;var c=(0,m.flattenAndCategorizeErrors)(i),u=c.flattenedErrors,d=c.severityChecks,p=this.getErrorSections(pa(pa({},u),d)),f=Object.values(d).every((function(e){return"error"!==e.severity})),h=p&&x()(u)&&f?"suggestive":o,v=i._schema,b=ha[h]||{},y=b.icon,g=b.type;return s.createElement(V.A,(0,r.A)({visible:!0},(0,A.A)({},g,!0),{className:"flashed top attached"}),s.createElement(X.A,{container:!0},s.createElement(X.A.Column,{width:15,textAlign:"left"},s.createElement("strong",null,s.createElement(w.A,{name:y,middle:!0,aligned:!0})," ",v||l,p.length>0&&s.createElement(s.Fragment,null,p.reduce((function(e,t){return[e,", ",t]})))))))}}])}(s.Component);va.propTypes={errors:p().object,actionState:p().string,labels:p().object,sectionsConfig:p().object},va.defaultProps={errors:void 0,actionState:void 0,labels:void 0,sectionsConfig:void 0};var ba=(0,u.connect)((function(e){return{actionState:e.deposit.actionState,errors:e.deposit.errors}}),null)(va);n(75866);var ya=n(71083);function ga(e,t,n){return t=(0,l.A)(t),(0,o.A)(e,Aa()?Reflect.construct(t,n||[],(0,l.A)(e).constructor):t.apply(e,n))}function Aa(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Aa=function(){return!!e})()}var Ea={json:{"Content-Type":"application/json"},"vnd+json":{"Content-Type":"application/json",Accept:"application/vnd.inveniordm.v1+json"},"octet-stream":{"Content-Type":"application/octet-stream"}},wa=(0,a.A)((function e(t,n){(0,i.A)(this,e),this.data=t,this.errors=n})),Ra=function(){return(0,a.A)((function e(t,n,r){if((0,i.A)(this,e),this.constructor===e)throw new Error("Abstract");var a=ue()(t,"headers");this.apiHeaders=Object.assign({},Ea,a),this.apiConfig={withCredentials:!0,xsrfCookieName:"csrftoken",xsrfHeaderName:"X-CSRFToken",headers:this.apiHeaders["vnd+json"]},this.axiosWithConfig=ya.A.create(this.apiConfig),this.cancelToken=ya.A.CancelToken}),[{key:"createDraft",value:function(){var e=(0,it.A)(ot().mark((function e(t){return ot().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("Not implemented.");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"saveDraft",value:function(){var e=(0,it.A)(ot().mark((function e(t,n){return ot().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("Not implemented.");case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"publishDraft",value:function(){var e=(0,it.A)(ot().mark((function e(t){return ot().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("Not implemented.");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"deleteDraft",value:function(){var e=(0,it.A)(ot().mark((function e(t){return ot().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("Not implemented.");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"reservePID",value:function(){var e=(0,it.A)(ot().mark((function e(t,n){return ot().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("Not implemented.");case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"discardPID",value:function(){var e=(0,it.A)(ot().mark((function e(t,n){return ot().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("Not implemented.");case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"createOrUpdateReview",value:function(){var e=(0,it.A)(ot().mark((function e(t,n){return ot().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("Not implemented.");case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"deleteReview",value:function(){var e=(0,it.A)(ot().mark((function e(t){return ot().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("Not implemented.");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"submitReview",value:function(){var e=(0,it.A)(ot().mark((function e(t){return ot().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("Not implemented.");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}])}(),Ca=function(e){function t(e,n,r){var a;return(0,i.A)(this,t),(a=ga(this,t,[e])).createDraftURL=n,a.recordSerializer=r,a}return(0,c.A)(t,e),(0,a.A)(t,[{key:"_createResponse",value:function(){var e=(0,it.A)(ot().mark((function e(t){var n,r,i,a,o;return ot().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t();case 3:return n=e.sent,r=this.recordSerializer.deserialize(n.data||{}),i=this.recordSerializer.deserializeErrors(n.data.errors||[]),e.abrupt("return",new wa(r,i));case 9:throw e.prev=9,e.t0=e.catch(0),a=e.t0.response.data,(o=this.recordSerializer.deserializeErrors(e.t0.response.data.errors||[]))&&(a=o),new wa({},a);case 15:case"end":return e.stop()}}),e,this,[[0,9]])})));return function(t){return e.apply(this,arguments)}}()},{key:"createDraft",value:function(){var e=(0,it.A)(ot().mark((function e(t){var n,r=this;return ot().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.recordSerializer.serialize(t),e.abrupt("return",this._createResponse((function(){return r.axiosWithConfig.post(r.createDraftURL,n,{params:{expand:1}})})));case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"readDraft",value:function(){var e=(0,it.A)(ot().mark((function e(t){var n=this;return ot().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._createResponse((function(){return n.axiosWithConfig.get(t.self,{params:{expand:1}})})));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"saveDraft",value:function(){var e=(0,it.A)(ot().mark((function e(t,n){var r,i=this;return ot().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.recordSerializer.serialize(t),e.abrupt("return",this._createResponse((function(){return i.axiosWithConfig.put(n.self,r,{params:{expand:1}})})));case 2:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"publishDraft",value:function(){var e=(0,it.A)(ot().mark((function e(t){var n=this;return ot().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._createResponse((function(){return n.axiosWithConfig.post(t.publish,{},{params:{expand:1}})})));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"deleteDraft",value:function(){var e=(0,it.A)(ot().mark((function e(t){var n=this;return ot().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._createResponse((function(){return n.axiosWithConfig.delete(t.self,{})})));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"reservePID",value:function(){var e=(0,it.A)(ot().mark((function e(t,n){var r=this;return ot().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._createResponse((function(){var e="reserve_".concat(n),i=t[e];return r.axiosWithConfig.post(i,{},{params:{expand:1}})})));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"discardPID",value:function(){var e=(0,it.A)(ot().mark((function e(t,n){var r=this;return ot().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._createResponse((function(){var e="reserve_".concat(n),i=t[e];return r.axiosWithConfig.delete(i,{params:{expand:1}})})));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"createOrUpdateReview",value:function(){var e=(0,it.A)(ot().mark((function e(t,n){var r=this;return ot().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._createResponse((function(){return r.axiosWithConfig.put(t.review,{receiver:{community:n},type:"community-submission"})})));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"deleteReview",value:function(){var e=(0,it.A)(ot().mark((function e(t){var n=this;return ot().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._createResponse((function(){return n.axiosWithConfig.delete(t.review,{})})));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"submitReview",value:function(){var e=(0,it.A)(ot().mark((function e(t,n){var r=this;return ot().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._createResponse((function(){var e=n?{payload:{content:n,format:"html"}}:{};return r.axiosWithConfig.post(t["submit-review"],e)})));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"cancelReview",value:function(){var e=(0,it.A)(ot().mark((function e(t,n){return ot().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.axiosWithConfig.post(t.actions.cancel,n?{payload:{content:n,format:"html"}}:{}));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()}])}(Ra),Pa=function(){return(0,a.A)((function e(t){if((0,i.A)(this,e),this.constructor===e)throw new Error("Abstract");var n=ue()(t,"headers",{});this.apiHeaders=Object.assign({},Ea,n);var r={withCredentials:!0,xsrfCookieName:"csrftoken",xsrfHeaderName:"X-CSRFToken",headers:this.apiHeaders["vnd+json"]};this.axiosWithConfig=ya.A.create(r)}),[{key:"isCancelled",value:function(e){return ya.A.isCancel(e)}},{key:"initializeFileUpload",value:function(e,t){throw new Error("Not implemented.")}},{key:"uploadFile",value:function(e,t,n,r){throw new Error("Not implemented.")}},{key:"finalizeFileUpload",value:function(e){throw new Error("Not implemented.")}},{key:"deleteFile",value:function(e){throw new Error("Not implemented.")}}])}(),Sa=function(e){function t(){return(0,i.A)(this,t),ga(this,t,arguments)}return(0,c.A)(t,e),(0,a.A)(t,[{key:"initializeFileUpload",value:function(e,t){var n=[{key:t}];return this.axiosWithConfig.post(e,n,{})}},{key:"uploadFile",value:function(e,t,n,r){return this.axiosWithConfig.put(e,t,{headers:this.apiHeaders["octet-stream"],onUploadProgress:function(e){var t=Math.floor(e.loaded/e.total*100);n&&n(t)},cancelToken:new ya.A.CancelToken(r)})}},{key:"finalizeFileUpload",value:function(e){return this.axiosWithConfig.post(e,{})}},{key:"importParentRecordFiles",value:function(e){var t="".concat(e.self,"/actions/files-import");return this.axiosWithConfig.post(t,{})}},{key:"deleteFile",value:function(e){return this.axiosWithConfig.delete(e.self)}}])}(Pa),ka=n(52230),Oa=["isFileUploadInProgress"];function Da(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ia(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Da(Object(n),!0).forEach((function(t){(0,A.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Da(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ma(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Ma=function(){return!!e})()}var Fa=function(e){function t(){var e,n,r,a;(0,i.A)(this,t);for(var c=arguments.length,s=new Array(c),u=0;u<c;u++)s[u]=arguments[u];return n=this,r=t,a=[].concat(s),r=(0,l.A)(r),e=(0,o.A)(n,Ma()?Reflect.construct(r,a||[],(0,l.A)(n).constructor):r.apply(n,a)),(0,A.A)(e,"submitContext",void 0),(0,A.A)(e,"setSubmitContext",(function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.submitContext={actionName:t,extra:n}})),(0,A.A)(e,"onFormSubmit",function(){var t=(0,it.A)(ot().mark((function t(n,r){var i,a,o,l,c,s,u,d,p,f,m,h,v;return ot().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:i=e.props,a=i.saveAction,o=i.publishAction,l=i.submitReview,c=i.previewAction,s=i.deleteAction,u=i.reservePIDAction,d=i.discardPIDAction,p=e.submitContext,f=p.actionName,m=p.extra,h=void 0,v={},t.t0=f,t.next=t.t0===jn?7:t.t0===zn?9:t.t0===Ln?11:t.t0===Hn?14:t.t0===Nn?18:t.t0===Bn?20:t.t0===Un?23:t.t0===Vn?26:29;break;case 7:return h=a,t.abrupt("break",30);case 9:return h=o,t.abrupt("break",30);case 11:return h=o,v.removeSelectedCommunity=!0,t.abrupt("break",30);case 14:return h=l,v.reviewComment=m.reviewComment,v.directPublish=m.directPublish,t.abrupt("break",30);case 18:return h=c,t.abrupt("break",30);case 20:return h=s,v.isDiscardingVersion=m.isDiscardingVersion,t.abrupt("break",30);case 23:return h=u,v.pidType=m.pidType,t.abrupt("break",30);case 26:return h=d,v.pidType=m.pidType,t.abrupt("break",30);case 29:throw Error("The submit btn must set the form action name.");case 30:return t.prev=30,t.next=33,h(n,v);case 33:t.next=38;break;case 35:t.prev=35,t.t1=t.catch(30),t.t1&&t.t1.errors?r.setErrors(t.t1.errors):re();case 38:return t.prev=38,e.submitContext={},t.finish(38);case 41:case"end":return t.stop()}}),t,null,[[30,35,38,41]])})));return function(e,n){return t.apply(this,arguments)}}()),e}return(0,c.A)(t,e),(0,a.A)(t,[{key:"componentDidMount",value:function(){var e=this;window.addEventListener("beforeunload",(function(t){if(e.props.fileUploadOngoing)return t.returnValue="",""})),window.addEventListener("unload",(0,it.A)(ot().mark((function e(){return ot().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))))}},{key:"render",value:function(){var e=this.props,t=e.errors,n=e.record,r=e.children;return s.createElement(Yn.Provider,{value:{setSubmitContext:this.setSubmitContext}},s.createElement(m.BaseForm,{onSubmit:this.onFormSubmit,formik:Ia({enableReinitialize:!0,initialValues:n},t&&{initialErrors:t})},r))}}])}(s.Component);Fa.propTypes={errors:p().object,record:p().object.isRequired,children:p().node,saveAction:p().func.isRequired,publishAction:p().func.isRequired,submitReview:p().func.isRequired,previewAction:p().func.isRequired,deleteAction:p().func.isRequired,reservePIDAction:p().func.isRequired,discardPIDAction:p().func.isRequired,fileUploadOngoing:p().bool},Fa.defaultProps={errors:void 0,children:void 0,fileUploadOngoing:!1};var xa=(0,u.connect)((function(e){var t=e.files,n=t.isFileUploadInProgress,r=(0,J.A)(t,Oa);return{record:e.deposit.record,errors:e.deposit.errors,formState:e.deposit.formState,fileUploadOngoing:n,files:r}}),(function(e){return{publishAction:function(t,n){var r=n.removeSelectedCommunity;return e(function(e,t){var n=t.removeSelectedCommunity,r=void 0!==n&&n;return function(){var t=(0,it.A)(ot().mark((function t(n,i,a){var o,l,c,s;return ot().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n({type:mt}),!r){t.next=4;break}return t.next=4,n(Jt(null));case 4:return t.next=6,Xt(e,a.service.drafts,{depositState:i().deposit,dispatchFn:n,failType:ht,partialValidationActionType:vt,showOnlyValidationErrorsWithSeverityError:!0});case 6:return o=t.sent,l=o.data,t.prev=8,t.next=11,a.service.drafts.publish(l.links);case 11:c=t.sent,s=c.data.links.self_html,window.location.replace(s),t.next=21;break;case 16:throw t.prev=16,t.t0=t.catch(8),console.error("Error publishing draft",t.t0,e),n({type:ht,payload:{errors:t.t0.errors}}),t.t0;case 21:case"end":return t.stop()}}),t,null,[[8,16]])})));return function(e,n,r){return t.apply(this,arguments)}}()}(t,{removeSelectedCommunity:void 0!==r&&r}))},submitReview:function(t,n){var r=n.reviewComment,i=n.directPublish;return e(function(e,t){var n=t.reviewComment,r=t.directPublish;return function(){var t=(0,it.A)(ot().mark((function t(i,a,o){var l,c,s,u;return ot().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i({type:Et,payload:{reviewComment:n},directPublish:r}),t.next=3,Xt(e,o.service.drafts,{depositState:a().deposit,dispatchFn:i,failType:wt,partialValidationActionType:Rt,showOnlyValidationErrorsWithSeverityError:!0});case 3:return l=t.sent,c=l.data,t.prev=5,t.next=8,o.service.drafts.submitReview(c.links,n);case 8:s=t.sent,u=s.data.links.next_html,window.location.replace(u),t.next=18;break;case 13:throw t.prev=13,t.t0=t.catch(5),console.error("Error submitting review",t.t0,e),i({type:wt,payload:{errors:t.t0.errors}}),t.t0;case 18:case"end":return t.stop()}}),t,null,[[5,13]])})));return function(e,n,r){return t.apply(this,arguments)}}()}(t,{reviewComment:r,directPublish:i}))},saveAction:function(t){return e((n=t,function(){var e=(0,it.A)(ot().mark((function e(t,r,i){var a;return ot().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t({type:dt}),e.next=3,Xt(n,i.service.drafts,{depositState:r().deposit,dispatchFn:t,failType:ft,partialValidationActionType:ut,showOnlyValidationErrorsWithSeverityError:!1});case 3:a=e.sent,t({type:pt,payload:{data:a.data}});case 5:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}()));var n},previewAction:function(t){return e((n=t,function(){var e=(0,it.A)(ot().mark((function e(t,r,i){var a,o;return ot().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t({type:bt}),e.next=3,Xt(n,i.service.drafts,{depositState:r().deposit,dispatchFn:t,failType:yt,partialValidationActionType:ut,showOnlyValidationErrorsWithSeverityError:!0});case 3:a=e.sent,o=a.data.links.record_html,window.location="".concat(o,"?preview=1");case 6:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}()));var n},deleteAction:function(t,n){n.isDiscardingVersion;return e(function(){var e=(0,it.A)(ot().mark((function e(t,n,r){var i,a;return ot().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t({type:gt}),e.prev=1,i=n().deposit.record,e.next=5,r.service.drafts.delete(i.links);case 5:a=r.config.dashboard_routes.uploads,window.location.replace(a),e.next=14;break;case 9:throw e.prev=9,e.t0=e.catch(1),console.error("Error deleting draft",e.t0),t({type:At,payload:{errors:e.t0.errors}}),e.t0;case 14:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t,n,r){return e.apply(this,arguments)}}())},reservePIDAction:function(t,n){var r=n.pidType;return e(function(e,t){var n=t.pidType;return function(){var t=(0,it.A)(ot().mark((function t(r,i,a){var o,l;return ot().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r({type:Ct,payload:{pidType:n}}),t.prev=1,t.next=4,Qt(e,a.service.drafts);case 4:return o=t.sent,l=o.data,t.next=8,a.service.drafts.reservePID(l.links,n);case 8:o=t.sent,r({type:Pt,payload:{data:o.data}}),t.next=17;break;case 12:throw t.prev=12,t.t0=t.catch(1),console.error("Error reserving PID",t.t0,e),r({type:St,payload:{errors:t.t0.errors}}),t.t0;case 17:case"end":return t.stop()}}),t,null,[[1,12]])})));return function(e,n,r){return t.apply(this,arguments)}}()}(t,{pidType:r}))},discardPIDAction:function(t,n){var r=n.pidType;return e(function(e,t){var n=t.pidType;return function(){var t=(0,it.A)(ot().mark((function t(r,i,a){var o,l;return ot().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r({type:kt,payload:{pidType:n}}),t.prev=1,t.next=4,Qt(e,a.service.drafts);case 4:return o=t.sent,l=o.data,t.next=8,a.service.drafts.discardPID(l.links,n);case 8:o=t.sent,r({type:Ot,payload:{data:o.data}}),t.next=17;break;case 12:throw t.prev=12,t.t0=t.catch(1),console.error("Error discarding PID",t.t0,e),r({type:Dt,payload:{errors:t.t0.errors}}),t.t0;case 17:case"end":return t.stop()}}),t,null,[[1,12]])})));return function(e,n,r){return t.apply(this,arguments)}}()}(t,{pidType:r}))}}}))(Fa);function Ta(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Ta=function(){return!!e})()}var qa=function(){return(0,a.A)((function e(t){if((0,i.A)(this,e),this.constructor===e)throw new Error("Abstract")}),[{key:"read",value:function(){var e=(0,it.A)(ot().mark((function e(t){return ot().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("Not implemented.");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"create",value:function(){var e=(0,it.A)(ot().mark((function e(t){return ot().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("Not implemented.");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"save",value:function(){var e=(0,it.A)(ot().mark((function e(t){return ot().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("Not implemented.");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"publish",value:function(){var e=(0,it.A)(ot().mark((function e(t){return ot().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("Not implemented.");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"delete",value:function(){var e=(0,it.A)(ot().mark((function e(t){return ot().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("Not implemented.");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"reservePID",value:function(){var e=(0,it.A)(ot().mark((function e(t,n){return ot().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("Not implemented.");case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"discardPID",value:function(){var e=(0,it.A)(ot().mark((function e(t,n){return ot().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("Not implemented.");case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"createOrUpdateReview",value:function(){var e=(0,it.A)(ot().mark((function e(t,n){return ot().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("Not implemented.");case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"deleteReview",value:function(){var e=(0,it.A)(ot().mark((function e(t){return ot().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("Not implemented.");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"submitReview",value:function(){var e=(0,it.A)(ot().mark((function e(t){return ot().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("Not implemented.");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}])}(),_a=function(e){function t(e){var n,r,a,c;return(0,i.A)(this,t),r=this,a=t,a=(0,l.A)(a),(n=(0,o.A)(r,Ta()?Reflect.construct(a,c||[],(0,l.A)(r).constructor):a.apply(r,c))).apiClient=e,n}return(0,c.A)(t,e),(0,a.A)(t,[{key:"_draftAlreadyCreated",value:function(e){return!!e.id}},{key:"create",value:function(){var e=(0,it.A)(ot().mark((function e(t){return ot().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.apiClient.createDraft(t));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"read",value:function(){var e=(0,it.A)(ot().mark((function e(t){return ot().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.apiClient.readDraft(t));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"save",value:function(){var e=(0,it.A)(ot().mark((function e(t){return ot().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._draftAlreadyCreated(t)?this.apiClient.saveDraft(t,t.links):this.create(t));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"publish",value:function(){var e=(0,it.A)(ot().mark((function e(t){return ot().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.apiClient.publishDraft(t));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"delete",value:function(){var e=(0,it.A)(ot().mark((function e(t){return ot().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.apiClient.deleteDraft(t));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"reservePID",value:function(){var e=(0,it.A)(ot().mark((function e(t,n){return ot().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.apiClient.reservePID(t,n));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"discardPID",value:function(){var e=(0,it.A)(ot().mark((function e(t,n){return ot().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.apiClient.discardPID(t,n));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"createOrUpdateReview",value:function(){var e=(0,it.A)(ot().mark((function e(t,n){return ot().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.apiClient.createOrUpdateReview(t,n));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"deleteReview",value:function(){var e=(0,it.A)(ot().mark((function e(t){return ot().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.apiClient.deleteReview(t));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"submitReview",value:function(){var e=(0,it.A)(ot().mark((function e(t,n){return ot().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.apiClient.submitReview(t,n));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()}])}(qa);function ja(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function za(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ja(Object(n),!0).forEach((function(t){(0,A.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ja(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function La(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(La=function(){return!!e})()}var Na=function(){return(0,a.A)((function e(){(0,i.A)(this,e),(0,A.A)(this,"currents",[]),(0,A.A)(this,"pending",[])}),[{key:"put",value:function(e,t){this.pending.push({initializeUploadURL:e,file:t})}},{key:"totalInProgress",get:function(){return this.currents.length}},{key:"next",get:function(){var e=this.pending.shift();return void 0!==e&&this.currents.push(e.file),e}},{key:"markCompleted",value:function(e){var t=this.currents.indexOf(e);t>=0&&this.currents.splice(t,1)}}])}(),Ba=function(){return(0,a.A)((function e(t){(0,i.A)(this,e),this.dispatcher=t}),[{key:"onUploadAdded",value:function(e){throw new Error("Not implemented.")}},{key:"onUploadStarted",value:function(e,t){throw new Error("Not implemented.")}},{key:"onUploadProgress",value:function(e,t){throw new Error("Not implemented.")}},{key:"onUploadCompleted",value:function(e,t,n,r){throw new Error("Not implemented.")}},{key:"onUploadCancelled",value:function(e){throw new Error("Not implemented.")}},{key:"onUploadFailed",value:function(e){throw new Error("Not implemented.")}}])}(),Ua=function(){return(0,a.A)((function e(t,n){if((0,i.A)(this,e),this.constructor===e)throw new Error("Abstract")}),[{key:"setProgressNotifier",value:function(e){if(!(e instanceof Ba))throw new Error("Progress notifier must be an instance of `UploadProgressNotifier`");this.progressNotifier=e}},{key:"upload",value:function(){var e=(0,it.A)(ot().mark((function e(t,n,r){return ot().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("Not implemented.");case 1:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"delete",value:function(){var e=(0,it.A)(ot().mark((function e(t){return ot().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("Not implemented.");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"importParentRecordFiles",value:function(){var e=(0,it.A)(ot().mark((function e(t){return ot().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("Not implemented.");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}])}(),Va=function(e){function t(e,n){var r,a,c,s;return(0,i.A)(this,t),a=this,c=t,c=(0,l.A)(c),r=(0,o.A)(a,La()?Reflect.construct(c,s||[],(0,l.A)(a).constructor):c.apply(a,s)),(0,A.A)(r,"_initializeUpload",function(){var e=(0,it.A)(ot().mark((function e(t,n){var i,a;return ot().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.fileApiClient.initializeFileUpload(t,n.name);case 2:return i=e.sent,a=i.data.entries.filter((function(e){return e.key.normalize()===n.name.normalize()}))[0],e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),(0,A.A)(r,"_doUpload",function(){var e=(0,it.A)(ot().mark((function e(t,n){return ot().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.fileApiClient.uploadFile(t,n,(function(e){return r.progressNotifier.onUploadProgress(n.name,e)}),(function(e){return r.progressNotifier.onUploadStarted(n.name,e)}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),(0,A.A)(r,"_finalizeUpload",function(){var e=(0,it.A)(ot().mark((function e(t,n){var i;return ot().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.uploaderQueue.markCompleted(n),r._startNextUpload(),e.next=4,r.fileApiClient.finalizeFileUpload(t);case 4:return i=e.sent,e.abrupt("return",i.data);case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),(0,A.A)(r,"_onError",(function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1]?r.progressNotifier.onUploadCancelled(e.name):r.progressNotifier.onUploadFailed(e.name),r.uploaderQueue.markCompleted(e),r._startNextUpload()})),(0,A.A)(r,"_startNewUpload",function(){var e=(0,it.A)(ot().mark((function e(t,n){var i,a,o,l,c;return ot().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,r._initializeUpload(t,n);case 3:i=e.sent,e.next=10;break;case 6:return e.prev=6,e.t0=e.catch(0),r._onError(n),e.abrupt("return");case 10:return a=i.links.content,o=i.links.commit,e.prev=12,e.next=15,r._doUpload(a,n);case 15:return e.next=17,r._finalizeUpload(o,n);case 17:l=e.sent,r.progressNotifier.onUploadCompleted(l.key,l.size,l.checksum,l.links),e.next=26;break;case 21:e.prev=21,e.t1=e.catch(12),console.error(e.t1),c=r.fileApiClient.isCancelled(e.t1),r._onError(n,c);case 26:case"end":return e.stop()}}),e,null,[[0,6],[12,21]])})));return function(t,n){return e.apply(this,arguments)}}()),(0,A.A)(r,"_startNextUpload",(0,it.A)(ot().mark((function e(){var t;return ot().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r.uploaderQueue.totalInProgress<r.maxConcurrentUploads)){e.next=6;break}if(!(t=r.uploaderQueue.next)){e.next=6;break}return e.next=6,r._startNewUpload(t.initializeUploadURL,t.file);case 6:case"end":return e.stop()}}),e)})))),(0,A.A)(r,"upload",function(){var e=(0,it.A)(ot().mark((function e(t,n){return ot().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.uploaderQueue.put(t,n),r.progressNotifier.onUploadAdded(n.name),e.next=4,r._startNextUpload();case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),(0,A.A)(r,"delete",function(){var e=(0,it.A)(ot().mark((function e(t){return ot().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.fileApiClient.deleteFile(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),(0,A.A)(r,"importParentRecordFiles",function(){var e=(0,it.A)(ot().mark((function e(t){var n;return ot().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.fileApiClient.importParentRecordFiles(t);case 2:return n=e.sent,e.abrupt("return",n.data.entries.reduce((function(e,t){return za(za({},e),{},(0,A.A)({},t.key,{status:an.finished,size:t.size,name:t.key,progressPercentage:100,checksum:t.checksum,links:t.links}))}),{}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),r.fileApiClient=e,r.maxConcurrentUploads=n||3,r.uploaderQueue=new Na,r}return(0,c.A)(t,e),(0,a.A)(t)}(Ua),Ha=n(88055),Ya=n.n(Ha),Wa=n(84684),Ga=n.n(Wa),Qa=n(56449),Ka=n.n(Qa),Xa=n(53812),$a=n.n(Xa),Ja=n(5187),Za=n.n(Ja),eo=n(98023),to=n.n(eo),no=n(23805),ro=n.n(no),io=n(73916),ao=n.n(io),oo=n(44383),lo=n.n(oo),co=n(71086),so=n.n(co),uo=n(63560),po=n.n(uo),fo=n(8306),mo=n(80357);function ho(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return vo(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?vo(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){l=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(l)throw a}}}}function vo(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function bo(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function yo(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?bo(Object(n),!0).forEach((function(t){(0,A.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):bo(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function go(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(go=function(){return!!e})()}var Ao=function(){return(0,a.A)((function e(t){if((0,i.A)(this,e),this.constructor===e)throw new Error("Abstract")}),[{key:"deserialize",value:function(e){throw new Error("Not implemented.")}},{key:"deserializeErrors",value:function(e){throw new Error("Not implemented.")}},{key:"serialize",value:function(e){throw new Error("Not implemented.")}}])}(),Eo=function(e){function t(e){var n,r,a,c,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return(0,i.A)(this,t),r=this,a=t,a=(0,l.A)(a),(n=(0,o.A)(r,go()?Reflect.construct(a,c||[],(0,l.A)(r).constructor):a.apply(r,c))).defaultLocale=e,n.customFieldVocabularies=s,n}return(0,c.A)(t,e),(0,a.A)(t,[{key:"depositRecordSchema",get:function(){return{files:new fo.D0({fieldpath:"files"}),media_files:new fo.D0({fieldpath:"media_files"}),links:new fo.D0({fieldpath:"links"}),expanded:new fo.D0({fieldpath:"expanded",deserializedDefault:{}}),pids:new fo.D0({fieldpath:"pids",deserializedDefault:{},serializedDefault:{}}),title:new fo.D0({fieldpath:"metadata.title",deserializedDefault:""}),additional_titles:new fo.yv({fieldpath:"metadata.additional_titles",schema:{title:new fo.D0({fieldpath:"title"}),type:new fo.vE({fieldpath:"type",deserializedDefault:"",serializedDefault:""}),lang:new fo.vE({fieldpath:"lang",deserializedDefault:"",serializedDefault:""})}}),additional_descriptions:new fo.yv({fieldpath:"metadata.additional_descriptions",schema:{description:new fo.D0({fieldpath:"description"}),type:new fo.vE({fieldpath:"type",deserializedDefault:"",serializedDefault:""}),lang:new fo.vE({fieldpath:"lang",deserializedDefault:"",serializedDefault:""})}}),creators:new fo.yv({fieldpath:"metadata.creators",schema:{person_or_org:new fo.D0({fieldpath:"person_or_org"}),role:new fo.vE({fieldpath:"role",deserializedDefault:"",serializedDefault:""}),affiliations:new fo.TV({fieldpath:"affiliations",deserializedDefault:[],serializedDefault:[],labelField:"name"})}}),contributors:new fo.yv({fieldpath:"metadata.contributors",schema:{person_or_org:new fo.D0({fieldpath:"person_or_org"}),role:new fo.vE({fieldpath:"role",deserializedDefault:"",serializedDefault:""}),affiliations:new fo.TV({fieldpath:"affiliations",deserializedDefault:[],serializedDefault:[],labelField:"name"})}}),resource_type:new fo.vE({fieldpath:"metadata.resource_type",deserializedDefault:"",serializedDefault:""}),access:new fo.D0({fieldpath:"access",deserializedDefault:{record:"public",files:"public"}}),publication_date:new fo.D0({fieldpath:"metadata.publication_date",deserializedDefault:""}),dates:new fo.yv({fieldpath:"metadata.dates",schema:{date:new fo.D0({fieldpath:"date"}),type:new fo.vE({fieldpath:"type",deserializedDefault:"",serializedDefault:""}),description:new fo.D0({fieldpath:"description"})},deserializedDefault:[]}),languages:new fo.vE({fieldpath:"metadata.languages",deserializedDefault:[],serializedDefault:[]}),identifiers:new fo.yv({fieldpath:"metadata.identifiers",schema:{scheme:new fo.D0({fieldpath:"scheme"}),identifier:new fo.D0({fieldpath:"identifier"})},deserializedDefault:[]}),related_identifiers:new fo.yv({fieldpath:"metadata.related_identifiers",schema:{scheme:new fo.D0({fieldpath:"scheme"}),identifier:new fo.D0({fieldpath:"identifier"}),relation_type:new fo.vE({fieldpath:"relation_type",deserializedDefault:"",serializedDefault:""}),resource_type:new fo.vE({fieldpath:"resource_type",deserializedDefault:"",serializedDefault:""})},deserializedDefault:[]}),references:new fo.yv({fieldpath:"metadata.references",schema:{reference:new fo.D0({fieldpath:"reference"})},deserializedDefault:[]}),subjects:new fo.TV({fieldpath:"metadata.subjects",deserializedDefault:[],serializedDefault:[],labelField:"subject"}),funding:new fo.yv({fieldpath:"metadata.funding",schema:{award:new fo.qB({fieldpath:"award",deserializedDefault:{}}),funder:new fo.qB({fieldpath:"funder",deserializedDefault:{}})}}),version:new fo.D0({fieldpath:"metadata.version",deserializedDefault:""}),rights:new fo.MQ({fieldpath:"metadata.rights",deserializedDefault:[],serializedDefault:[],localeFields:["title","description"]}),custom_fields:new mo.CustomField({fieldpath:"custom_fields",deserializedDefault:{},serializedDefault:{},vocabularyFields:this.customFieldVocabularies})}}},{key:"_removeEmptyValues",value:function(e){var t=this;if(Ka()(e))return e.map((function(e){return t._removeEmptyValues(e)})).filter((function(e){return $a()(e)||to()(e)?e:!x()(e)}));if(ro()(e)){var n=ao()(e,(function(e){return t._removeEmptyValues(e)}));return so()(n,(function(e){return Ka()(e)||ro()(e)?!x()(e):!Za()(e)}))}return to()(e)||$a()(e)||e?e:null}},{key:"deserialize",value:function(e){var t=lo()(Ya()(e),["access","expanded","metadata","id","links","files","media_files","is_published","versions","parent","status","pids","ui","custom_fields","created","updated","revision_id"]),n=t.pids||{},r=this._removeEmptyValues(t);for(var i in r=yo(yo({},r),x()(n)?{}:{pids:n}),this.depositRecordSchema)r=this.depositRecordSchema[i].deserialize(r,this.defaultLocale);return r}},{key:"deserializeErrors",value:function(e){var t,n={},r=ho(e);try{for(r.s();!(t=r.n()).done;){var i=t.value;"severity"in i&&"severity"in i?po()(n,i.field,{message:i.messages.join(" "),severity:i.severity,description:i.description}):po()(n,i.field,i.messages.join(" "))}}catch(a){r.e(a)}finally{r.f()}return n}},{key:"serialize",value:function(e){var t=lo()(Ya()(e),["access","metadata","id","links","files","media_files","pids","parent","custom_fields"]),n=t.pids||{},r=t;for(var i in this.depositRecordSchema)r=this.depositRecordSchema[i].serialize(r,this.defaultLocale);return r=yo(yo({},r=this._removeEmptyValues(r)),{pids:x()(n)?{}:n}),Ga()(r,{metadata:{},custom_fields:{}}),r}}])}(Ao),wo=function(){return(0,a.A)((function e(t,n){(0,i.A)(this,e),this.draftsService=t,this.filesService=n}),[{key:"drafts",get:function(){return this.draftsService}},{key:"files",get:function(){return this.filesService}}])}(),Ro=n(68238),Co=n(1265);const Po=(0,Ro.combineReducers)({deposit:ir,files:ln});var So=["record","preselectedCommunity","files","config","permissions"];function ko(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Oo(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ko(Object(n),!0).forEach((function(t){(0,A.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ko(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Do=function(e){var t=Ya()(e);return{links:e.links||{},entries:ue()(t,"entries",[]).map((function(e){var t=e.size>=0,n={name:e.key,size:e.size||0,checksum:e.checksum||"",links:e.links||{}};return Oo(t?{status:an.finished,progressPercentage:100}:{status:an.pending},n)})).reduce((function(e,t){return e[t.name]=Oo({},t),e}),{})}};function Io(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Io=function(){return!!e})()}var Mo=function(e){function t(){return(0,i.A)(this,t),e=this,n=t,r=arguments,n=(0,l.A)(n),(0,o.A)(e,Io()?Reflect.construct(n,r||[],(0,l.A)(e).constructor):n.apply(e,r));var e,n,r}return(0,c.A)(t,e),(0,a.A)(t,[{key:"onUploadAdded",value:function(e){this.dispatcher&&this.dispatcher({type:Mt,payload:{filename:e}})}},{key:"onUploadStarted",value:function(e,t){this.dispatcher&&this.dispatcher({type:Bt,payload:{filename:e,cancelUploadFn:t}})}},{key:"onUploadProgress",value:function(e,t){this.dispatcher&&this.dispatcher({type:Ft,payload:{filename:e,percent:t}})}},{key:"onUploadCompleted",value:function(e,t,n,r){this.dispatcher&&this.dispatcher({type:xt,payload:{filename:e,size:t,checksum:n,links:r}})}},{key:"onUploadCancelled",value:function(e){this.dispatcher&&this.dispatcher({type:Ut,payload:{filename:e}})}},{key:"onUploadFailed",value:function(e){this.dispatcher&&this.dispatcher({type:Tt,payload:{filename:e}})}}])}(Ba);function Fo(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Fo=function(){return!!e})()}var xo=function(e){function t(e){var n,r,a,c;(0,i.A)(this,t),r=this,a=t,c=[e],a=(0,l.A)(a),n=(0,o.A)(r,Fo()?Reflect.construct(a,c||[],(0,l.A)(r).constructor):a.apply(r,c));var s=e.recordSerializer?e.recordSerializer:new Eo(e.config.default_locale,e.config.custom_fields.vocabularies),u={headers:e.config.apiHeaders?e.config.apiHeaders:null},d=e.apiClient?e.apiClient:new Ca(u,e.config.createUrl,s),p=e.fileApiClient?e.fileApiClient:new Sa(u),f=e.draftsService?e.draftsService:new _a(d),m=e.filesService?e.filesService:new Va(p,e.config.fileUploadConcurrency),h=new wo(f,m),v={config:e.config,record:s.deserialize(e.record),preselectedCommunity:e.preselectedCommunity,files:e.files,apiClient:d,fileApiClient:p,service:h,permissions:e.permissions,recordSerializer:s};n.store=function(e){var t=e.record,n=e.preselectedCommunity,r=e.files,i=e.config,a=e.permissions,o=(0,J.A)(e,So),l={deposit:{record:t,editorState:rr(t,n||void 0),config:i,permissions:a,actionState:null,actionStateExtra:{}},files:Do(r||{})},c=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||Ro.compose;return(0,Ro.createStore)(Po,l,c((0,Ro.applyMiddleware)(Co.default.withExtraArgument(Oo({config:i},o)))))}(v);var b=new Mo(n.store.dispatch);return m.setProgressNotifier(b),n}return(0,c.A)(t,e),(0,a.A)(t,[{key:"render",value:function(){var e=this.props.children;return s.createElement(u.Provider,{store:this.store},s.createElement(ka.x,{i18n:g.M},s.createElement(xa,null,e)))}}])}(s.Component);xo.propTypes={config:p().object.isRequired,record:p().object.isRequired,preselectedCommunity:p().object,files:p().object,permissions:p().object,apiClient:p().instanceOf(Ra),fileApiClient:p().instanceOf(Pa),draftsService:p().instanceOf(qa),filesService:p().instanceOf(Ua),recordSerializer:p().instanceOf(Ao),children:p().node},xo.defaultProps={preselectedCommunity:void 0,permissions:void 0,apiClient:void 0,fileApiClient:void 0,draftsService:void 0,filesService:void 0,recordSerializer:void 0,files:void 0,children:void 0};var To=(0,A.A)((0,A.A)((0,A.A)((0,A.A)((0,A.A)((0,A.A)((0,A.A)({},tr.IN_REVIEW,{color:"warning",title:g.M.t("In review"),message:g.M.t("Community curators will review your upload. Once accepted, it will be published.")}),tr.DECLINED,{color:"negative",title:g.M.t("Declined"),message:g.M.t("The request to submit this upload to the community was declined.")}),tr.EXPIRED,{color:"expired",title:g.M.t("Expired"),message:g.M.t("The request to submit this upload to the community has expired.")}),tr.PUBLISHED,{color:"positive",title:g.M.t("Published"),message:g.M.t("Your upload is published.")}),tr.DRAFT_WITH_REVIEW,{color:"neutral",title:g.M.t("Draft"),message:g.M.t("Once your upload is complete, you can submit it for review to the community curators.")}),tr.DRAFT,{color:"neutral",title:g.M.t("Draft"),message:g.M.t("Once your upload is complete, you can publish or submit it for review to the community curators.")}),tr.NEW_VERSION_DRAFT,{color:"neutral",title:g.M.t("New version draft"),message:g.M.t("Once your upload is complete, you can publish it.")}),qo=function(e){var t=e.depositReview,n=e.depositStatus,r=To[n];if(!r)throw new Error("Status is undefined");var i=n===tr.IN_REVIEW;return s.createElement(X.A,{verticalAlign:"middle"},s.createElement(X.A.Row,{centered:!0,className:"pt-5 pb-5 ".concat(r.color)},s.createElement(X.A.Column,{width:i?8:16,textAlign:i?"left":"center"},s.createElement("span",null,r.title),s.createElement(E.A,{trigger:s.createElement(w.A,{className:"ml-10",name:"info circle"}),content:r.message})),i&&s.createElement(X.A.Column,{width:8,textAlign:"right"},s.createElement(R.A,{href:"/me/requests/".concat(t.id),target:"_blank",icon:"external alternate",content:g.M.t("View request"),size:"mini",className:"transparent",title:g.M.t("Opens in new tab")}))))};qo.propTypes={depositReview:p().bool,depositStatus:p().string.isRequired},qo.defaultProps={depositReview:void 0};var _o=(0,u.connect)((function(e){return{depositStatus:e.deposit.record.status,depositReview:e.deposit.record.status!==tr.DRAFT&&e.deposit.record.parent.review}}),null)(qo);function jo(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(jo=function(){return!!e})()}var zo=function(e){function t(e){var n,r,a,c;return(0,i.A)(this,t),r=this,a=t,c=[e],a=(0,l.A)(a),(n=(0,o.A)(r,jo()?Reflect.construct(a,c||[],(0,l.A)(r).constructor):a.apply(r,c))).state={modalOpen:!1},n}return(0,c.A)(t,e),(0,a.A)(t,[{key:"render",value:function(){var e,t=this,n=this.props,r=n.changeSelectedCommunity,i=n.community,a=n.imagePlaceholderLink,o=n.showCommunitySelectionButton,l=n.disableCommunitySelectionButton,c=n.userCanManageRecord,u=n.record,d=n.showCommunityHeader,p=this.state.modalOpen,f=!!u.id&&!c||l;return d&&s.createElement(gr.A,{className:"page-subheader-outer compact ml-0-mobile mr-0-mobile",fluid:!0},s.createElement(gr.A,{className:"page-subheader"},i?s.createElement(s.Fragment,null,s.createElement("div",{className:"page-subheader-element"},s.createElement(m.Image,{rounded:!0,className:"community-header-logo",src:(null===(e=i.links)||void 0===e?void 0:e.logo)||a,fallbackSrc:a})),s.createElement("div",{className:"page-subheader-element flex align-items-center"},i.metadata.title)):s.createElement("div",{className:"page-subheader-element"},g.M.t("Select the community where you want to submit your record.")),s.createElement("div",{className:"community-header-element flex align-items-center rel-ml-1"},o&&s.createElement(O.default,{id:"InvenioRdmRecords.CommunityHeader.CommunityHeaderElement.Container"},s.createElement(s.Fragment,null,s.createElement(Yi,{onCommunityChange:function(e){r(e),t.setState({modalOpen:!1})},onModalChange:function(e){return t.setState({modalOpen:e})},modalOpen:p,chosenCommunity:i,displaySelected:!0,record:u,trigger:s.createElement(O.default,{id:"InvenioRdmRecords.CommunityHeader.CommunitySelectionButton.Container"},s.createElement(R.A,{className:"community-header-button",disabled:f,onClick:function(){return t.setState({modalOpen:!0})},primary:!0,size:"mini",name:"setting",type:"button",content:i?g.M.t("Change"):g.M.t("Select a community")}))}),s.createElement(O.default,{id:"InvenioRdmRecords.CommunityHeader.RemoveCommunityButton.Container",community:i},i&&s.createElement(R.A,{basic:!0,size:"mini",labelPosition:"left",className:"community-header-button ml-5",onClick:function(){return r(null)},content:g.M.t("Remove"),icon:"close",disabled:f})))))))}}])}(s.Component);zo.propTypes={imagePlaceholderLink:p().string.isRequired,community:p().object,disableCommunitySelectionButton:p().bool.isRequired,showCommunitySelectionButton:p().bool.isRequired,showCommunityHeader:p().bool.isRequired,changeSelectedCommunity:p().func.isRequired,record:p().object.isRequired,userCanManageRecord:p().bool.isRequired},zo.defaultProps={community:void 0};var Lo=(0,u.connect)((function(e){return{community:e.deposit.editorState.selectedCommunity,disableCommunitySelectionButton:e.deposit.editorState.ui.disableCommunitySelectionButton,showCommunitySelectionButton:e.deposit.editorState.ui.showCommunitySelectionButton,showCommunityHeader:e.deposit.editorState.ui.showCommunityHeader,userCanManageRecord:e.deposit.permissions.can_manage}}),(function(e){return{changeSelectedCommunity:function(t){return e(Jt(t))}}}))(zo);var No=function(e){var t=document.getElementsByName(e);return t.length>0&&t[0].hasAttribute("value")?JSON.parse(t[0].value):null}},80357:(e,t,n)=>{n.r(t),n.d(t,{CustomField:()=>P,Imprint:()=>T,Journal:()=>_,Meeting:()=>z,Thesis:()=>N});var r=n(80296),i=n(82284),a=n(23029),o=n(92901),l=n(56822),c=n(53954),s=n(85501),u=n(58156),d=n.n(u),p=n(63560),f=n.n(p),m=n(88055),h=n.n(m),v=n(56449),b=n.n(v),y=n(23805),g=n.n(y),A=n(8306);function E(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(E=function(){return!!e})()}function w(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function R(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var C=new WeakSet,P=function(e){function t(e){var n,r,i,o,s=e.fieldpath,u=e.deserializedDefault,d=void 0===u?null:u,p=e.serializedDefault,f=void 0===p?null:p,m=e.allowEmpty,h=void 0!==m&&m,v=e.vocabularyFields,b=void 0===v?[]:v;return(0,a.A)(this,t),r=this,i=t,o=[{fieldpath:s,deserializedDefault:d,serializedDefault:f,allowEmpty:h}],i=(0,c.A)(i),w(n=(0,l.A)(r,E()?Reflect.construct(i,o||[],(0,c.A)(r).constructor):i.apply(r,o)),C),n.vocabularyFields=b,n}return(0,s.A)(t,e),(0,o.A)(t,[{key:"recursiveMapping",value:function(e,t,n){var r=null;if(b()(e))r=e.map((function(e,r){return n(e,r,t)}));else if(g()(e)&&!t){for(var i in e)e[i]=this.recursiveMapping(e[i],t,n);r=e}else r=n(e,null,t);return r}},{key:"deserialize",value:function(e){var t=h()(e),n=d()(e,this.fieldpath,this.deserializedDefault);return R(C,this,S).call(this,t,n,(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;return arguments.length>2&&void 0!==arguments[2]&&arguments[2]&&null!==e&&void 0!==e&&e.id?e.id:(t&&"object"===(0,i.A)(e)&&null!==e&&(e.__key=t),e)})),t}},{key:"serialize",value:function(e){var t=h()(e),n=d()(e,this.fieldpath,this.serializedDefault);return R(C,this,S).call(this,t,n,(function(e){return arguments.length>2&&void 0!==arguments[2]&&arguments[2]&&"string"===typeof e?{id:e}:(delete e.__key,e)})),t}}])}(A.D0);function S(e,t,n){if(null!==t)for(var i=0,a=Object.entries(t);i<a.length;i++){var o=(0,r.A)(a[i],2),l=o[0],c=o[1],s=this.vocabularyFields.includes(l),u=this.recursiveMapping(c,s,n);e=f()(e,"custom_fields.".concat(l),u)}}var k=n(96540),O=n(81057),D=n(36713),I=n(1489),M=n(5556),F=n.n(M);function x(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(x=function(){return!!e})()}var T=function(e){function t(){return(0,a.A)(this,t),e=this,n=t,r=arguments,n=(0,c.A)(n),(0,l.A)(e,x()?Reflect.construct(n,r||[],(0,c.A)(e).constructor):n.apply(e,r));var e,n,r}return(0,s.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this.props,t=e.fieldPath,n=e.title,r=e.place,i=e.isbn,a=e.pages,o=e.edition,l=e.label,c=e.icon;return k.createElement(k.Fragment,null,l&&k.createElement(k.Fragment,null,k.createElement(O.FieldLabel,{htmlFor:t,icon:c,label:l}),k.createElement(D.A,{fitted:!0})),k.createElement(I.A,{padded:!0},k.createElement(I.A.Column,{width:"12"},k.createElement(O.Input,{fieldPath:"".concat(t,".title"),label:n.label,placeholder:n.placeholder}),n.description&&k.createElement("label",{className:"helptext mb-0"},n.description)),k.createElement(I.A.Column,{width:"4"},k.createElement(O.Input,{fieldPath:"".concat(t,".isbn"),label:i.label,placeholder:i.placeholder}),i.description&&k.createElement("label",{className:"helptext mb-0"},i.description)),k.createElement(I.A.Column,{width:"6"},k.createElement(O.Input,{fieldPath:"".concat(t,".place"),label:r.label,placeholder:r.placeholder}),r.description&&k.createElement("label",{className:"helptext mb-0"},r.description)),k.createElement(I.A.Column,{width:"6"},k.createElement(O.Input,{fieldPath:"".concat(t,".pages"),label:a.label,placeholder:a.placeholder}),a.description&&k.createElement("label",{className:"helptext mb-0"},a.description)),k.createElement(I.A.Column,{width:"4"},k.createElement(O.Input,{fieldPath:"".concat(t,".edition"),label:o.label,placeholder:o.placeholder}),o.description&&k.createElement("label",{className:"helptext mb-0"},o.description))))}}])}(k.Component);function q(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(q=function(){return!!e})()}T.propTypes={fieldPath:F().string.isRequired,title:F().object.isRequired,place:F().object.isRequired,isbn:F().object.isRequired,pages:F().object.isRequired,edition:F().object.isRequired,icon:F().string,label:F().string},T.defaultProps={icon:void 0,label:void 0};var _=function(e){function t(){return(0,a.A)(this,t),e=this,n=t,r=arguments,n=(0,c.A)(n),(0,l.A)(e,q()?Reflect.construct(n,r||[],(0,c.A)(e).constructor):n.apply(e,r));var e,n,r}return(0,s.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this.props,t=e.fieldPath,n=e.title,r=e.volume,i=e.issue,a=e.pages,o=e.issn,l=e.icon,c=e.label;return k.createElement(k.Fragment,null,c&&k.createElement(k.Fragment,null,k.createElement(O.FieldLabel,{htmlFor:t,icon:l,label:c}),k.createElement(D.A,{fitted:!0})),k.createElement(I.A,{padded:!0},k.createElement(I.A.Column,{width:"12"},k.createElement(O.Input,{fieldPath:"".concat(t,".title"),label:n.label,placeholder:n.placeholder}),n.description&&k.createElement("label",{className:"helptext mb-0"},n.description)),k.createElement(I.A.Column,{width:"4"},k.createElement(O.Input,{fieldPath:"".concat(t,".issn"),label:o.label,placeholder:o.placeholder}),o.description&&k.createElement("label",{className:"helptext mb-0"},o.description)),k.createElement(I.A.Column,{width:"6"},k.createElement(O.Input,{fieldPath:"".concat(t,".volume"),label:r.label,placeholder:r.placeholder}),r.description&&k.createElement("label",{className:"helptext mb-0"},r.description)),k.createElement(I.A.Column,{width:"6"},k.createElement(O.Input,{fieldPath:"".concat(t,".issue"),label:i.label,placeholder:i.placeholder}),i.description&&k.createElement("label",{className:"helptext mb-0"},i.description)),k.createElement(I.A.Column,{width:"4"},k.createElement(O.Input,{fieldPath:"".concat(t,".pages"),label:a.label,placeholder:a.placeholder}),a.description&&k.createElement("label",{className:"helptext mb-0"},a.description))))}}])}(k.Component);function j(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(j=function(){return!!e})()}_.propTypes={fieldPath:F().string.isRequired,title:F().object.isRequired,volume:F().object.isRequired,issue:F().object.isRequired,pages:F().object.isRequired,issn:F().object.isRequired,icon:F().string,label:F().string},_.defaultProps={icon:void 0,label:void 0};var z=function(e){function t(){return(0,a.A)(this,t),e=this,n=t,r=arguments,n=(0,c.A)(n),(0,l.A)(e,j()?Reflect.construct(n,r||[],(0,c.A)(e).constructor):n.apply(e,r));var e,n,r}return(0,s.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this.props,t=e.fieldPath,n=e.title,r=e.acronym,i=e.dates,a=e.place,o=e.url,l=e.session,c=e.session_part,s=e.icon,u=e.label;return k.createElement(k.Fragment,null,u&&k.createElement(k.Fragment,null,k.createElement(O.FieldLabel,{htmlFor:t,icon:s,label:u}),k.createElement(D.A,{fitted:!0})),k.createElement(I.A,{padded:!0},k.createElement(I.A.Column,{width:"12"},k.createElement(O.Input,{fieldPath:"".concat(t,".title"),label:n.label,placeholder:n.placeholder}),n.description&&k.createElement("label",{className:"helptext mb-0"},n.description)),k.createElement(I.A.Column,{width:"4"},k.createElement(O.Input,{fieldPath:"".concat(t,".acronym"),label:r.label,placeholder:r.placeholder}),r.description&&k.createElement("label",{className:"helptext mb-0"},r.description)),k.createElement(I.A.Column,{width:"12"},k.createElement(O.Input,{fieldPath:"".concat(t,".place"),label:a.label,placeholder:a.placeholder}),a.description&&k.createElement("label",{className:"helptext mb-0"},a.description)),k.createElement(I.A.Column,{width:"4"},k.createElement(O.Input,{fieldPath:"".concat(t,".dates"),label:i.label,placeholder:i.placeholder}),i.description&&k.createElement("label",{className:"helptext mb-0"},i.description)),k.createElement(I.A.Column,{width:"6"},k.createElement(O.Input,{fieldPath:"".concat(t,".session"),label:l.label,placeholder:l.placeholder}),l.description&&k.createElement("label",{className:"helptext mb-0"},l.description)),k.createElement(I.A.Column,{width:"6"},k.createElement(O.Input,{fieldPath:"".concat(t,".session_part"),label:c.label,placeholder:c.placeholder}),c.description&&k.createElement("label",{className:"helptext mb-0"},c.description)),o&&k.createElement(I.A.Column,{width:"12"},k.createElement(O.Input,{fieldPath:"".concat(t,".url"),label:o.label,placeholder:o.placeholder}),o.description&&k.createElement("label",{className:"helptext mb-0"},o.description))))}}])}(k.Component);function L(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(L=function(){return!!e})()}z.propTypes={fieldPath:F().string.isRequired,title:F().object.isRequired,acronym:F().object.isRequired,session_part:F().object.isRequired,session:F().object.isRequired,dates:F().object.isRequired,place:F().object.isRequired,icon:F().string,label:F().string,url:F().object.isRequired},z.defaultProps={icon:void 0,label:void 0};var N=function(e){function t(){return(0,a.A)(this,t),e=this,n=t,r=arguments,n=(0,c.A)(n),(0,l.A)(e,L()?Reflect.construct(n,r||[],(0,c.A)(e).constructor):n.apply(e,r));var e,n,r}return(0,s.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this.props,t=e.fieldPath,n=e.university,r=e.department,i=e.type,a=e.date_submitted,o=e.date_defended,l=e.icon,c=e.label,s=r&&i?6:16;return k.createElement(k.Fragment,null,c&&k.createElement(k.Fragment,null,k.createElement(O.FieldLabel,{htmlFor:t,icon:l,label:c}),k.createElement(D.A,{fitted:!0})),k.createElement(I.A,{padded:!0},n&&k.createElement(I.A.Column,{width:s},k.createElement(O.Input,{fieldPath:"".concat(t,".university"),label:n.label,placeholder:n.placeholder}),n.description&&k.createElement("label",{className:"helptext mb-0"},n.description)),r&&k.createElement(I.A.Column,{width:6},k.createElement(O.Input,{fieldPath:"".concat(t,".department"),label:r.label,placeholder:r.placeholder}),r.description&&k.createElement("label",{className:"helptext mb-0"},r.description)),i&&k.createElement(I.A.Column,{width:4},k.createElement(O.Input,{fieldPath:"".concat(t,".type"),label:i.label,placeholder:i.placeholder}),i.description&&k.createElement("label",{className:"helptext mb-0"},i.description)),k.createElement(I.A.Column,{width:"8"},k.createElement(O.Input,{fieldPath:"".concat(t,".date_submitted"),label:a.label,placeholder:a.placeholder}),a.description&&k.createElement("label",{className:"helptext mb-0"},a.description)),k.createElement(I.A.Column,{width:"8"},k.createElement(O.Input,{fieldPath:"".concat(t,".date_defended"),label:o.label,placeholder:o.placeholder}),o.description&&k.createElement("label",{className:"helptext mb-0"},o.description))))}}])}(k.Component);N.propTypes={fieldPath:F().string.isRequired,university:F().object.isRequired,department:F().object.isRequired,type:F().object.isRequired,date_submitted:F().object.isRequired,date_defended:F().object.isRequired,icon:F().string,label:F().string},N.defaultProps={icon:void 0,label:void 0}}}]);
//# sourceMappingURL=8092.ddee682e7012bf7c444a.js.map